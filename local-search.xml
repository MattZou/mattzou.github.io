<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æµ·é‡æ•°æ®ç©ºé—´è¿æ¥è¿ç®—</title>
    <link href="/2021/11/19/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%A9%BA%E9%97%B4%E8%BF%9E%E6%8E%A5/"/>
    <url>/2021/11/19/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%A9%BA%E9%97%B4%E8%BF%9E%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><p>ç°æœ‰ä»¥csvæ ¼å¼å­˜å‚¨çš„åƒä¸‡çº§åˆ«ç‚¹ä½ä¿¡æ¯ï¼Œæ¯ä¸ªç‚¹åŒ…å«æ•°å€¼ç±»å±æ€§å€¼ï¼Œéœ€å°†è¿™äº›ç‚¹æŒ‰ä¸€å®šç½‘æ ¼è§„æ ¼è¿›è¡Œç»Ÿè®¡ï¼Œè®¡ç®—å„ç½‘æ ¼å†…ç‚¹çš„ç»Ÿè®¡ç»“æœã€‚</p><h1 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h1><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ç©ºé—´ç»Ÿè®¡é—®é¢˜ï¼Œä¸»è¦æ€è·¯æ˜¯é€šè¿‡ç©ºé—´è¿æ¥å»ºç«‹ç‚¹å’Œç½‘æ ¼çš„ä¸€å¯¹ä¸€è¿æ¥ï¼Œç„¶åæŒ‰ç…§ç½‘æ ¼è¿›è¡Œåˆ†ç»„ç»Ÿè®¡è®¡ç®—å³å¯ã€‚å¯¹äºå°æ•°æ®é‡çš„è¾“å…¥ï¼Œå¯åœ¨ArcGISä¸­é€šè¿‡Identity-Spatial joinå·¥å…·è¿ç”¨è§£å†³ï¼Œä½†å¯¹äºæµ·é‡æ•°æ®ï¼Œåœ¨ArcMapä¸­å¤„ç†çš„æ•ˆç‡å°±è¾ƒä½äº†ã€‚</p><p>ç”±äºç‚¹ã€é¢å…³è”çš„ç©ºé—´è®¡ç®—ç›¸å¯¹ç®€å•ï¼Œå› æ­¤å¯¹äºå¤§é‡æ•°æ®ï¼Œè€ƒè™‘é‡‡ç”¨GeoPandasæˆ–PostGISå†…ç½®å‡½æ•°è§£å†³ï¼Œæœ¬æ–‡ç®€å•é˜è¿°ä»¥ä¸Šä¸¤ç§æ–¹æ³•çš„æ€è·¯åŠå®ç°ã€‚</p><h1 id="å®ç°æ–¹æ¡ˆ"><a href="#å®ç°æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ–¹æ¡ˆ"></a>å®ç°æ–¹æ¡ˆ</h1><h2 id="GeoPandas"><a href="#GeoPandas" class="headerlink" title="GeoPandas"></a>GeoPandas</h2><h3 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h3><ol><li>ç‚¹ä½æ•°æ®ï¼Œæ ¼å¼ï¼šcsv</li><li>åº”ç”¨ArcMapçš„Fishnetå·¥å…·ç”Ÿæˆçš„ç½‘æ ¼ï¼Œæ ¼å¼ï¼špolygonç±»shpï¼Œå¯<a href="https://mattzou.com/2016/02/28/ArcGIS-Fishnet/">å‚è€ƒ</a>ä¹‹å‰æ–‡ç« ã€‚</li></ol><p>ç‚¹ä½æ•°æ®çº¦1000wæ¡ï¼Œç½‘æ ¼æ•°ä¸º23wã€‚</p><h3 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h3><p>åœ¨Pythonç¯å¢ƒä¸­å®‰è£…GeoPandasåŒ…ï¼Œé‡‡ç”¨å®˜æ–¹æ¨èçš„<code>conda install --channel conda-forge geopandas</code>æ–¹å¼å®¹æ˜“å‡ºç°å„ç§é—®é¢˜ï¼Œå› æ­¤ç”¨pipè¿›è¡Œå®‰è£…ã€‚<br>å®‰è£…è¿‡ç¨‹å¦‚ä¸‹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="geopandaså®‰è£…è¸©å‘">[1]</span></a></sup></p><ul><li>æ ¹æ®Pythonç¯å¢ƒç‰ˆæœ¬ï¼Œåœ¨<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">ç½‘ç«™</a>ä¸‹è½½GeoPandasçš„å››ä¸ªä¾èµ–åŒ…gdalã€Shapelyã€Fionaã€pyprojçš„whlæ–‡ä»¶ã€‚</li><li>åˆ‡æ¢åˆ°ä»¥ä¸Šæ–‡ä»¶çš„ä¸‹è½½ç›®å½•ï¼Œé€šè¿‡<code>pip install xxx.whl</code>æ–¹å¼ä¾ç…§gdalã€Shapelyã€Fionaã€pyprojçš„é¡ºåºè¿›è¡Œå®‰è£…ï¼Œå®‰è£…å®Œæˆå<code>pip install geopandas</code>å³å¯</li></ul><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><ul><li>é¦–å…ˆé€šè¿‡GeoPandasæä¾›çš„points_from_xyå‡½æ•°æ„é€ geometryå¹¶ç”Ÿæˆç‚¹è¦ç´ çš„GeoDataFrame</li><li>è¯»å–ç½‘æ ¼è¦ç´ è½½å…¥GeoDataFrame</li><li>é€šè¿‡sjoin<a href="https://geopandas.org/en/stable/docs/reference/api/geopandas.sjoin.html">å‡½æ•°</a>å®ç°ç©ºé—´è¿æ¥<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="åŸºäºgeopandasçš„ç©ºé—´æ•°æ®åˆ†æâ€”â€”ç©ºé—´è®¡ç®—ç¯‡(ä¸‹)">[2]</span></a></sup>ï¼Œç©ºé—´æ‹“æ‰‘å…³ç³»<a href="https://stackoverflow.com/questions/68504942/how-do-geopandas-sjoin-op-within-and-intersects-differ">å‚è€ƒ</a></li><li>é€šè¿‡groupbyè¿›è¡Œå±æ€§ç»Ÿè®¡è®¡ç®—</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd<span class="token keyword">import</span> pyproj<span class="token keyword">import</span> time<span class="token keyword">import</span> os<span class="token comment"># define dir</span>root_dir <span class="token operator">=</span> <span class="token string">r'./Dir/'</span>file_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>root_dir<span class="token punctuation">)</span><span class="token comment"># Month Iterator</span><span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>    <span class="token comment"># get filename </span>    filename <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    time_start<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># load point data</span>    raw_point<span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>root_dir <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token comment"># numeric format </span>    raw_point<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> raw_point<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span><span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>to_numeric<span class="token punctuation">)</span>    <span class="token comment"># subset</span>    raw_point <span class="token operator">=</span> raw_point<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span> <span class="token string">'latitude'</span><span class="token punctuation">,</span><span class="token string">'SOx_emission'</span><span class="token punctuation">,</span> <span class="token string">'NOx_emission'</span><span class="token punctuation">,</span> <span class="token string">'PM10_emission'</span><span class="token punctuation">,</span><span class="token string">'PM2P5_emission'</span><span class="token punctuation">,</span> <span class="token string">'hc_emission'</span><span class="token punctuation">,</span> <span class="token string">'CO_emission'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'load data done'</span><span class="token punctuation">)</span>        <span class="token comment"># é€šè¿‡points_from_xyå°†ç»çº¬åº¦ä¿¡æ¯ç”Ÿæˆç‚¹è¦ç´ </span>    vessel_point <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>raw_point<span class="token punctuation">,</span> geometry<span class="token operator">=</span>gpd<span class="token punctuation">.</span>points_from_xy<span class="token punctuation">(</span>raw_point<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> raw_point<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># define projection</span>    vessel_point<span class="token punctuation">.</span>crs <span class="token operator">=</span> pyproj<span class="token punctuation">.</span>CRS<span class="token punctuation">.</span>from_user_input<span class="token punctuation">(</span><span class="token string">'EPSG:4326'</span><span class="token punctuation">)</span>     <span class="token comment"># å¯¼å‡ºç‚¹shpæ–‡ä»¶</span>    <span class="token comment"># vessel_point.to_file(root_dir +  filename + '.shp', driver='ESRI Shapefile',encoding='utf-8')</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'make gdf done'</span><span class="token punctuation">)</span>        <span class="token comment"># load grid data</span>    vessel_grid <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">r'./result/grid.shp'</span><span class="token punctuation">)</span>    vessel_grid<span class="token punctuation">.</span>crs <span class="token operator">=</span> pyproj<span class="token punctuation">.</span>CRS<span class="token punctuation">.</span>from_user_input<span class="token punctuation">(</span><span class="token string">'EPSG:4326'</span><span class="token punctuation">)</span>    <span class="token comment"># ç©ºé—´è¿æ¥</span>    vessel_merged <span class="token operator">=</span> gpd<span class="token punctuation">.</span>sjoin<span class="token punctuation">(</span>vessel_grid<span class="token punctuation">,</span> vessel_point<span class="token punctuation">,</span> predicate<span class="token operator">=</span><span class="token string">'contains'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'merge done'</span><span class="token punctuation">)</span>        <span class="token comment"># subset</span>    vessel_merged2 <span class="token operator">=</span> vessel_merged<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Id'</span><span class="token punctuation">,</span> <span class="token string">'SOx_emission'</span><span class="token punctuation">,</span> <span class="token string">'NOx_emission'</span><span class="token punctuation">,</span> <span class="token string">'PM10_emission'</span><span class="token punctuation">,</span> <span class="token string">'PM2P5_emission'</span><span class="token punctuation">,</span>           <span class="token string">'hc_emission'</span><span class="token punctuation">,</span> <span class="token string">'CO_emission'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>    <span class="token comment"># æŒ‰ç½‘æ ¼æ±‚å’Œ</span>    vessel_grid_merged <span class="token operator">=</span> vessel_merged2<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token string">'sum'</span><span class="token punctuation">)</span>    <span class="token comment"># å°†è®¡ç®—ç»“æœä¸geometryç½‘æ ¼è¿›è¡Œå…³è”ï¼Œç”¨äºè¾“å‡º</span>    vessel_grid_shp <span class="token operator">=</span> vessel_grid<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>vessel_grid_merged<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Id'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'stat done'</span><span class="token punctuation">)</span>        <span class="token comment"># output shp file</span>    vessel_grid_shp<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span>root_dir <span class="token operator">+</span>  filename <span class="token operator">+</span> <span class="token string">'.shp'</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">'ESRI Shapefile'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    vessel_grid_merged<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>root_dir <span class="token operator">+</span>  filename <span class="token operator">+</span> <span class="token string">'grid.csv'</span><span class="token punctuation">)</span>        <span class="token comment"># calculate running time</span>    time_end<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'totally cost'</span><span class="token punctuation">,</span>time_end<span class="token operator">-</span>time_start<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/geopandas_sjoin.jpg/pic"></p><h2 id="PostGIS"><a href="#PostGIS" class="headerlink" title="PostGIS"></a>PostGIS</h2><h3 id="æ•°æ®å‡†å¤‡-1"><a href="#æ•°æ®å‡†å¤‡-1" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h3><ol><li>ç‚¹ä½æ•°æ®ï¼Œæ ¼å¼ï¼šcsv</li></ol><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>é‡‡ç”¨Dockeréƒ¨ç½²PostGISåŠPgAdminç¯å¢ƒ</p><h3 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h3><p>ä½¿ç”¨PostGISæ—¶ï¼Œä¸éœ€è¦å®é™…ç”Ÿæˆç½‘æ ¼å¹¶å­˜å‚¨ï¼Œè€Œæ˜¯é€šè¿‡ç”Ÿæˆå™¨åŠ¨æ€åˆ›å»ºç½‘æ ¼ç„¶åä¸å…¶ä»–ç©ºé—´æ•°æ®åšå åŠ ç»Ÿè®¡åˆ†æ<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="åŸºäºPostGIS3.1 ç”Ÿæˆæ ¼ç½‘æ•°æ®">[3]</span></a></sup>ã€‚</p><ul><li>å°†ç‚¹ä½shpå¯¼å…¥Pgæ•°æ®åº“</li><li>æ ¹æ®vessel_pointèŒƒå›´ä½¿ç”¨ST_SquareGridç”ŸæˆåŠ¨æ€ç½‘æ ¼</li><li>INNER JOINè¿›è¡Œç©ºé—´è¿æ¥æ±‡æ€»</li></ul><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token function">sum</span><span class="token punctuation">(</span>NOx_emission<span class="token punctuation">)</span> <span class="token keyword">as</span> NOx_emission<span class="token punctuation">,</span> squares<span class="token punctuation">.</span>geom<span class="token keyword">FROM</span>    ST_SquareGrid<span class="token punctuation">(</span>        ST_SetSRID<span class="token punctuation">(</span>ST_EstimatedExtent<span class="token punctuation">(</span><span class="token string">'vessel_point'</span><span class="token punctuation">,</span> <span class="token string">'geom'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span> <span class="token keyword">AS</span> squares    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>    vessel_point <span class="token keyword">AS</span> p    <span class="token keyword">ON</span> ST_Contains<span class="token punctuation">(</span>p<span class="token punctuation">.</span>geom<span class="token punctuation">,</span> squares<span class="token punctuation">.</span>geom<span class="token punctuation">)</span><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> squares<span class="token punctuation">.</span>geom<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>GeoPandasæˆ–PostGISçš„å†…ç½®å‡½æ•°ç›®å‰å·²èƒ½å®ç°å¤§å¤šæ•°ç©ºé—´è®¡ç®—ï¼Œå¹¶ä¸”è®¡ç®—æ•ˆç‡æ›´é«˜ï¼Œè®¡ç®—ç»“æœä¹Ÿæ›´åŠ ä¾¿äºä¼ æ’­äº¤äº’ã€‚å¦‚æœä¹ æƒ¯ArcGISï¼Œåº”ç”¨arcpyå®ç°ä¸€äº›ç©ºé—´æ“ä½œä¹Ÿèƒ½è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/wkfvawl/p/14294709.html">geopandaså®‰è£…è¸©å‘</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/fengdu78/article/details/107054250/">åŸºäºgeopandasçš„ç©ºé—´æ•°æ®åˆ†æâ€”â€”ç©ºé—´è®¡ç®—ç¯‡(ä¸‹)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/352630879">åŸºäºPostGIS3.1 ç”Ÿæˆæ ¼ç½‘æ•°æ®</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GeoPandas</tag>
      
      <tag>ç©ºé—´åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®¶ç”¨å¹³å°ä¸»æœºæ­å»ºè™šæ‹ŸåŒ–é›†ç¾¤</title>
    <link href="/2021/08/27/VM-%E6%8E%A2%E7%B4%A2%E5%AE%B6%E7%94%A8%E5%B9%B3%E5%8F%B0%E4%B8%BB%E6%9C%BA%E6%90%AD%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%8C%96%E9%9B%86%E7%BE%A4/"/>
    <url>/2021/08/27/VM-%E6%8E%A2%E7%B4%A2%E5%AE%B6%E7%94%A8%E5%B9%B3%E5%8F%B0%E4%B8%BB%E6%9C%BA%E6%90%AD%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%8C%96%E9%9B%86%E7%BE%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¢å‘"><a href="#æ¢å‘" class="headerlink" title="æ¢å‘"></a>æ¢å‘</h1><p>æœ€è¿‘è´­ç½®äº†ä¸‰å°åŠå…¬ç”¨ä¸»æœºï¼Œæ—¢è¦å…¼é¡¾<code>Windows</code>å¹³å°ä¸‹åŠå…¬éœ€æ±‚ï¼Œåˆè¦è€ƒè™‘å¼€å‘<code>Linux</code>é›†ç¾¤éƒ¨ç½²ï¼Œç‰©ç†æœº-&gt;è™šæ‹ŸåŒ–-&gt;å®¹å™¨è¿™æ ·çš„æ¶æ„ä»ç»´æŠ¤å’Œæ‹“å±•æ€§ä¸Šéƒ½æ˜¯æœ€ä½³çš„é€‰æ‹©ï¼Œè™šæ‹ŸåŒ–æ˜¯ä¸€åˆ‡æœåŠ¡çš„åŸºç¡€ï¼Œå› æ­¤éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„è™šæ‹ŸåŒ–æ–¹æ¡ˆã€‚</p><p>æ‰¾äº†ä¸€åœˆï¼Œå¼€æºï¼Œä¸»æµï¼Œæ˜“ä¸Šæ‰‹çš„è™šæ‹ŸåŒ–æ–¹æ¡ˆä¸»è¦æœ‰ä¸¤ç§ï¼šç‰©ç†æœº<code>Win</code>ç¯å¢ƒï¼Œç”¨<code>wsl</code>æˆ–è€…<code>VirtualBox</code>è·‘<code>CentOS</code>ï¼›å¦ä¸€ç§æ˜¯ç‰©ç†æœº<code>CentOS</code>ï¼Œç”¨<code>KVM</code>è™šæ‹Ÿ<code>Win</code>ä»¥åŠ<code>Linux</code>ã€‚å‰ä¸€ç§æ–¹æ¡ˆï¼Œåœ¨å•æœºä¸Šå°è¯•è¿‡ï¼Œ<code>wsl/wsl2</code>å„æœ‰ä¼˜åŠ£ï¼Œä¸€åˆ‡çœ‹å¾®è½¯å¤§çˆ·çœ¼è‰²è¡Œäº‹ï¼Œæ›´åŠ é€‚ç”¨äºä¸ªäººæˆ–å°ç»„ç ”ç©¶ï¼Œæ‰©å±•æ€§ä¸Šä¼°è®¡ä¸€å †å‘ï¼Œæ‰€ä»¥ç»•è¿‡ï¼Œè€ƒè™‘åœ¨<code>Linux</code>ä¸‹ç”¨<code>KVM</code>çš„<a href="https://www.redhat.com/zh/topics/virtualization/what-is-KVM">è§£å†³æ–¹æ¡ˆ</a>ã€‚</p><p>å•æœºä¸Šæ¶è®¾å¤šä¸ªVMï¼Œä½¿ç”¨<code>virt-manager</code>å¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡Œç®¡ç†ï¼Œå¯¹äºé›†ç¾¤<code>KVM</code>ç®¡ç†ï¼Œå¸¸ç”¨çš„æ˜¯<code>Proxmox</code>å’Œ<code>WebVirtMgr</code>ï¼Œéƒ½æ¯”è¾ƒå®¹æ˜“ä¸Šæ‰‹ã€‚ä½†çœ‹ç€<code>Proxmox</code>å®˜ç½‘æ›´åŠ ç‚«é…·ï¼Œå®‰è£…æ–¹ä¾¿ï¼Œé›†ç¾¤ç»´æŠ¤ã€VMè¿ç§»ç­‰åŠŸèƒ½é½å¤‡ï¼Œè€Œä¸”ç½‘ä¸Šä¿å§†æ•™ç¨‹ä¸€å¤§å †ï¼Œç”¨<code>Ventory</code>è¿˜èƒ½è‡ªåŠ¨éƒ¨ç½²ï¼Œå°±é€‰å®ƒäº†ã€‚</p><hr><blockquote><p>ä»¥ä¸Šéƒ½æ˜¯åŠ¨æ‰‹å‰çš„ç¾å¥½è®¾æƒ³ã€‚</p></blockquote><h1 id="æ‰å‘"><a href="#æ‰å‘" class="headerlink" title="æ‰å‘"></a>æ‰å‘</h1><h2 id="ç¡¬ä»¶é…ç½®"><a href="#ç¡¬ä»¶é…ç½®" class="headerlink" title="ç¡¬ä»¶é…ç½®"></a>ç¡¬ä»¶é…ç½®</h2><p>ä¸‰å°é…ç½®ç›¸åŒï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th align="center">Part</th><th align="center">Model</th></tr></thead><tbody><tr><td align="center">CPU</td><td align="center">Tiger Lake i7-11700 8c16t 2.5-4.9GHz</td></tr><tr><td align="center">GPU</td><td align="center">IntelÂ® UHD Graphics 750</td></tr><tr><td align="center">Memory</td><td align="center">16*2 3600MHz</td></tr><tr><td align="center">Motherboard</td><td align="center">B560m</td></tr><tr><td align="center">Ethernet</td><td align="center">RTL8125B</td></tr><tr><td align="center">SSD</td><td align="center">M.2 500g</td></tr><tr><td align="center">HDD</td><td align="center">5400RPM 2T</td></tr></tbody></table><p>è£…æœºå°±å¼€å§‹å‘äº†ï¼ŒCPUé£æ‰‡æ–¹å‘è£…åï¼Œæ‹†äº†è£…è£…äº†æ‹†===å¥½æ­¹æ˜¯å¼€æœºäº®ç¯æ²¡é—®é¢˜ã€‚å…ˆè£…äº†ä¸ªWinåšç¨³å®šæ€§æµ‹è¯•ï¼ŒFS140é£å†·å‹ä¸å¸¦kçš„i7è¿˜æ˜¯æ²¡é—®é¢˜ï¼Œä¸è¿‡åå¤æ‹†è£…å¯èƒ½å¯¼è‡´ä¸€ä¸ªç¡…è„‚æ²¡æ¶‚å¥½ï¼Œä¸¤å°åŒçƒ¤å·®äº†5â„ƒï¼Œæˆ‘éƒ½æ€•æ²¡æ’•è†œç›´æ¥æ€¼ä¸Šäº†ã€‚B560ä¸»æ¿æ”¯æŒå†…å­˜è¶…é¢‘ï¼Œé•å…‰C9BJZé¢—ç²’XMPä¸Š3600<a href="https://zhuanlan.zhihu.com/p/369653535">è½»æ¾å®¹æ˜“</a>ï¼Œå°±æ˜¯3600å†å¾€ä¸Šï¼Œ<a href="https://www.bilibili.com/video/BV1AM4y157ut">å†…å­˜åˆ†é¢‘</a>ä»£ä»·å¤ªå¤§ï¼Œå°±ä¸æŠ˜è…¾äº†ã€‚</p><h2 id="Proxmoxå®‰è£…"><a href="#Proxmoxå®‰è£…" class="headerlink" title="Proxmoxå®‰è£…"></a>Proxmoxå®‰è£…</h2><p>Proxmox VEæœ€æ–°7.0ç‰ˆæœ¬æ˜¯åŸºäºDebian 11ï¼Œå®‰è£…æ–¹å¼æä¾›isoç›´è£…ï¼Œæ‰¹é‡éƒ¨ç½²æ¨èä½¿ç”¨Ventoryï¼ˆçœŸæ˜¯è£…æœºç¥å™¨ï¼Œisoä¸€æ”¾ï¼Œè„šæœ¬ä¸€é…ç½®å°±å¯ä»¥å–èŒ¶å»äº†ï¼‰ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨è¿™ä¸ªå®¶ç”¨æœºå¹³å°ï¼Œå®‰è£…å‡ºé—®é¢˜äº†ğŸ˜­ã€‚</p><p>7.0é•œåƒå¯åŠ¨ï¼Œè¿›å…¥Booté€‰æ‹©ï¼Œè‡ªæ£€è¿‡åï¼Œåœ¨Debianä¸­èµ°åˆ°<br><code>starting a root shell on tty3</code>æ—¶å€™ç›´æ¥å¡ä½ï¼Œä¸¤çœ¼ä¸€æŠ¹é»‘ï¼Œè¿å·¦ä¸Šè§’å¡ä½å…‰æ ‡çš„æœºä¼šéƒ½æ²¡æœ‰===</p><p>æ‰¾å„ç§èµ„æ–™åï¼Œå‘ç°ä¹Ÿæœ‰è¿™ä¸ªæ–°å¹³å°ï¼ˆz590 + 11700ï¼‰å‡º<a href="https://forum.proxmox.com/threads/stuck-on-root-shell-on-tty3.86956/">é—®é¢˜</a>ï¼Œå°è¯•é‡Œé¢çš„è§£å†³æ–¹æ³•</p><h3 id="ä¿®æ”¹xorgé…ç½®"><a href="#ä¿®æ”¹xorgé…ç½®" class="headerlink" title="ä¿®æ”¹xorgé…ç½®"></a>ä¿®æ”¹xorgé…ç½®</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">$ chmod 1777 &#x2F;tmp  $ apt update$ apt upgrade$ Xorg -configure  $ mv &#x2F;xorg.conf.new &#x2F;etc&#x2F;X11&#x2F;xorg.conf$ vim &#x2F;etc&#x2F;X11&#x2F;xorg.conf # update Driver &quot;amdgpu&quot;-&gt; &quot;fbdev&quot; &lt;-be sure to get all instances in the case of a multi-head card which tripped me up initially.$ startx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä¸€ç•ªæŠ˜è…¾åæ€»ç®—çœ‹åˆ°å®‰è£…ç•Œé¢ï¼Œä½†æ˜¯ä¸Šé¢åªæœ‰å‡ ä¸ªå¤§å­—<br><strong><code>No Network Interface Found</code></strong><br>äº‹æƒ…å˜å¾—å¾®å¦™èµ·æ¥ï¼Œæ–°å¹³å°å‡ºé—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯é©±åŠ¨è·Ÿä¸ä¸Šã€‚æ—¢ç„¶æ˜¯ç½‘ç»œé—®é¢˜ï¼Œäºæ˜¯å¸¦ä¸Šç½‘å¡å…³é”®è¯<a href="https://forum.proxmox.com/threads/no-network-interface-found-for-rtl8125b.72378/">No Network Interface Found for RTL8125B</a>ï¼Œæ€è·¯è±ç„¶å¼€æœ—ã€‚<br>å…¶ä¸­æœ‰äººé€šè¿‡ä¸€ä¸ªå¤æ‚çš„ç½‘å¡é©±åŠ¨å®‰è£…è§£å†³äº†ã€‚</p><h3 id="å®‰è£…ç½‘å¡é©±åŠ¨"><a href="#å®‰è£…ç½‘å¡é©±åŠ¨" class="headerlink" title="å®‰è£…ç½‘å¡é©±åŠ¨"></a>å®‰è£…ç½‘å¡é©±åŠ¨</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">1) 1 usb with proxmox, 1 usb with driver package2) Boot into proxmox installer and Select debug mode installation3) Press ctrl+d once for it to proceed4) plug in android phone after enabling usb tether on the phone5) type in â€˜ ip addr show â€˜ And note down the interface name for the usb tether, mine was enp0s something something6) type in â€˜ ip link set enp0s upâ€™ #replace enp0s with your own interface name7) type in dhclient enp0s #replace enp0s with your own interface name8) test connectivity by using ping, â€˜ping 1.1.1.1â€™9) &#39;apt update&#39;10)install pve-header apt install pve-headers-$(uname -r)11) cd into a directory to make the second usb mount&#x3D; &#39;cd &#x2F;media&#39;12) â€˜mkdir usbâ€™13) use blkid to find the correct &#x2F;dev&#x2F;sd** name for your usb, (mine was sda1)14) â€˜mount &#x2F;dev&#x2F;sda1 &#x2F;media&#x2F;usb&#x2F;â€˜15) cd &#x2F;media&#x2F;usb16)â€™lsâ€™ #to find names17) my tmp folder was restricted and apt couldn&#39;t use it, i had to &#39;chmod 1777 &#x2F;tmp&#39; to make it open again18) &#39;apt install build-essential&#39;19) extract r8125-9.003.05.tar if not already done so, &#39;tar -xvf r8125-9.003.05.tar&#39;20) cd into r8125-9.003.05 folder and execute the script autorun.sh&#x3D; &#39;chmod +x autorun.sh&#39; and &#39;.&#x2F;autorun.sh&#39;21) now you can unplug the usb tether, repeat steps 5-8 to check if your Ethernet connection works.22) now you can do what they ask the ctrl+D again(?) to go back into normal mode and it&#39;ll find your network interface and you can proceed normally.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å…¶å®é©±åŠ¨é—®é¢˜å¤§éƒ¨åˆ†è¿˜æ˜¯kernelé—®é¢˜ï¼ŒæŸ¥é˜…å‘ç°<code>Linux kernel</code>å¯¹<code>RTL8125B</code>ç½‘å¡æ”¯æŒåœ¨<a href="https://linuxreviews.org/Realtek_RTL_8125">5.9</a>å°±å·²ç»å®ç°äº†å•Šã€‚Debian 11å’‹ä¹Ÿæ˜¯è¿™ä¹‹ä¸Šäº†ï¼Œæ— è§£ã€‚</p><p>å¯èƒ½ç‚¹èƒŒï¼Œä¸Šé¢é‚£ä¸€ä¸²æ­¥éª¤æ‰§è¡Œäº†ï¼Œè¿˜æ˜¯æ²¡ååº”ã€‚ï¼ˆè¿™ä¸ªåé¢å†è¯•è¯•ï¼Œä¼°è®¡æ˜¯é‚£å¤©å¤ªç´¯äº†ğŸ¤£ï¼‰</p><p>ç„¶åå‘ç°ä¸€å †äººç”¨ç€è¿™ä¸ªç½‘å¡ï¼ŒProxmoxè¿˜æ˜¯6.4çš„éƒ½æå®šäº†ï¼Œä»–ä»¬åšçš„å°±æ˜¯å‡çº§å†…æ ¸åˆ°5.11ã€‚<a href="https://forum.proxmox.com/threads/realtek-rtl-8125b.86747/">[SOLVED] Realtek RTL 8125B</a></p><p>å½“ç„¶ï¼Œç»ˆæå¤§æ€å™¨å°±æ˜¯<a href="https://pve.proxmox.com/wiki/Install_Proxmox_VE_on_Debian_Buster">Install Proxmox VE on Debian Buster</a></p><h3 id="å…ˆå®‰è£…Debianå†è£…Proxmox"><a href="#å…ˆå®‰è£…Debianå†è£…Proxmox" class="headerlink" title="å…ˆå®‰è£…Debianå†è£…Proxmox"></a>å…ˆå®‰è£…Debianå†è£…Proxmox</h3><p>è¿™ä¸ªåé¢æœ‰ç©ºå†æŠ˜è…¾ï¼Œä¼°è®¡åˆæ˜¯ä¸€å †å†…æ ¸ï¼Œé©±åŠ¨å‡çº§ã€‚<br>å¥½åœ¨GitHubä¸Šæœ‰äººæ”¾å‡ºæ¥äº†åŸºäºDebianå‘è¡Œç‰ˆçš„<a href="https://github.com/tubaxiaosiji/RTL8125-Driver-for-Proxmox-VE5-6-and-debian">è§£å†³æ–¹æ¡ˆ</a>ï¼Œåé¢æœ‰æœºä¼šæŠ„ä½œä¸šã€‚</p><h1 id="çˆ¬å‘"><a href="#çˆ¬å‘" class="headerlink" title="çˆ¬å‘"></a>çˆ¬å‘</h1><p>æŠ˜è…¾äº†å¥½ä¹…è¿˜æ²¡æˆæ•ˆï¼Œæœ¬ç€é€€ä¸€æ­¥æµ·é˜”å¤©ç©ºğŸŒçš„æƒ³æ³•ï¼Œæš‚æ—¶æ”¾å¼ƒProxmoxğŸ¤·â€â™‚ï¸ï¼Œå°±å…ˆè£…CentOSç”¨ç€ï¼Œåé¢ProxmoxæŠ˜è…¾æ˜ç™½äº†å†åšå•æœºVMå‘é›†ç¾¤è¿ç§»ä¹Ÿè¡Œã€‚</p><p>åœ¨å›¢é˜Ÿå¤§ä½¬çš„ç‚¹é†’ä¸‹ï¼Œé€€åŒ–åˆ°ä¸­çº§ç©æ³•ï¼ˆå®šä¹‰æ¥è‡ª<a href="https://zhuanlan.zhihu.com/p/49118355">æ­¤æ–‡</a>ï¼‰è¯•è¯•ğŸ‘¨â€ğŸš€ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">é‚£ä¹ˆ KVM + Libvirtd æœ‰å‡ ç§ä¸åŒå±‚æ¬¡çš„ç©æ³•ï¼šåˆçº§ï¼šåœ¨ &#x2F;etc&#x2F;libvirtd&#x2F;qemu ä¸‹é¢ç”¨ xml æè¿°æ¯ä¸€å°è™šæ‹Ÿæœºçš„é…ç½®ï¼Œ    ç„¶åç”¨ virsh åœ¨å‘½ä»¤è¡Œç®¡ç†è™šæ‹Ÿæœºï¼Œ    æœ€åç”¨ VNC&#x2F;SPICE æŒ‰ç…§é…ç½®å¥½çš„ç«¯å£é“¾æ¥è¿‡å»ï¼Œæ¨¡æ‹Ÿç»ˆç«¯æ“ä½œã€‚ä¸­çº§ï¼šä½¿ç”¨å„ç§ libvirtd çš„å‰ç«¯ï¼Œæ¯”å¦‚åŸºäºæ¡Œé¢ GUI çš„ Virt Manager ç»™ä½ ç•Œé¢ä¸Šç›´æ¥ç¼–è¾‘å’Œç®¡ç†è™šæ‹Ÿæœºï¼Œ    æ¡Œé¢ç‰ˆæœ¬çš„ VNC&#x2F;SPICE ä¼šè‡ªåŠ¨å¼¹å‡ºæ¥ï¼Œåƒ VmWare ä¸€æ ·æ“ä½œã€‚é«˜çº§ï¼šä½¿ç”¨åŸºäº Web çš„å„ç§ virt manager è¿›è¡Œé›†ç¾¤ç®¡ç†ï¼Œ    æ¯”å¦‚è½»é‡çº§çš„ WebVirtMgr &#x2F; Kimchiï¼Œ    é€‚åˆå°ç™½çš„ Proxmox VEã€‚åŸºæœ¬æ˜¯ç”¨ WebVnc&#x2F;Webè¶…çº§ï¼šä¸Šé‡é‡çº§çš„ OpenStackï¼Œ    æ­é…è‡ªå·±åŸºäº libvirt ï¼ˆlibvirtd çš„å®¢æˆ·ç«¯åº“ï¼Œæ¯”å¦‚æœ‰ python-libvirt çš„å°è£…ï¼‰å†™çš„å„ç§è‡ªåŠ¨åŒ–è„šæœ¬ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="CentOS-KVMé…ç½®"><a href="#CentOS-KVMé…ç½®" class="headerlink" title="CentOS KVMé…ç½®"></a>CentOS KVMé…ç½®</h2><p>å®éªŒåœ¨CentOSä¸­é…ç½®ä¸€å°WinServerè™šæ‹Ÿæœºã€‚<br>é¦–å…ˆåœ¨BIOSä¸­æ‰“å¼€è™šæ‹ŸåŒ–ã€‚</p><h3 id="å®‰è£…å¿…è¦åŒ…"><a href="#å®‰è£…å¿…è¦åŒ…" class="headerlink" title="å®‰è£…å¿…è¦åŒ…"></a>å®‰è£…å¿…è¦åŒ…</h3><p>CentOS8ä¸­è‡ªå¸¦äº†QEMU/KVMæ”¯æŒ<br>å‚è€ƒ<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="How to Install KVM on CentOS 8">[1]</span></a></sup><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="How to Install KVM on CentOS/RHEL 8">[2]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">yum groupinstall &quot;Virtualization Host&quot;sudo systemctl enable --now libvirtdsudo yum -y install virt-top libguestfs-tools<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>å¯ä»¥é€‰æ‹©ä»¥ä¸¤ç§ç›´è§‚çš„å¯è§†åŒ–ç•Œé¢è¿›è¡Œé…ç½®ã€‚</p><p>GUIç®¡ç†å·¥å…·</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">sudo yum -y install virt-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>Cockpit Web Consoleç®¡ç†å·¥å…·</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">dnf install cockpit cockpit-machinessystemctl start cockpit.socketsystemctl enable cockpit.socketsystemctl status cockpit.socketfirewall-cmd --add-service&#x3D;cockpit --permanentfirewall-cmd --reload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="é…ç½®æ¡¥æ¥ç½‘ç»œ"><a href="#é…ç½®æ¡¥æ¥ç½‘ç»œ" class="headerlink" title="é…ç½®æ¡¥æ¥ç½‘ç»œ"></a>é…ç½®æ¡¥æ¥ç½‘ç»œ</h3><p>ä¸ºäº†æ–¹ä¾¿è™šæ‹Ÿæœºå¤–ç½‘è¿é€šè®¿é—®ï¼Œéœ€è¦æ¶è®¾ç½‘æ¡¥ã€‚æ­¤å¤„éœ€è¦ç‰©ç†ç½‘å£æ”¯æŒï¼ŒWifiç½‘å¡é…ç½®å­˜åœ¨é—®é¢˜ã€‚<br>å…³äºBridgeå’ŒNATæ¨¡å¼åŒºåˆ«ï¼Œå¯å‚è€ƒ<a href="https://www.virtualbox.org/manual/ch06.html#networkingmodes">Virtual Networking</a>å’Œ<a href="https://www.jianshu.com/p/ed0ce43374e6">ç½‘ç»œé…ç½®Bridgeæ–¹å¼ã€NATæ–¹å¼</a></p><p>CentOS8 ä½¿ç”¨nmcliå‘½ä»¤è¿›è¡Œç½‘ç»œé…ç½®</p><ol><li><p>æŸ¥çœ‹å½“å‰è¿æ¥</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli connection<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>è®°å½•ethernetçš„device æ ‡è¯†</p></li><li><p>æ–°å»ºåä¸ºbr0çš„ç½‘æ¡¥</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli connection add type bridge con-name br0 ifname br0 autoconnect yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>ç¼–è¾‘ç½‘æ¡¥ï¼Œè®¾ç½®é™æ€IPåŠç½‘å…³</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli conn modify br0 ipv4.addresses &#39;192.168.0.x&#x2F;24&#39;nmcli conn modify br0 ipv4.gateway &#39;192.168.0.1&#39;nmcli conn modify br0 ipv4.dns &#39;192.168.0.1&#39;nmcli conn modify br0 ipv4.method manual<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>æˆ–è€…ç¼–è¾‘æ–‡ä»¶</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-br0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ä¿®æ”¹</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">IPADDR&#x3D;192.168.0.xPREFIX&#x3D;24GATEWAY&#x3D;192.168.0.1DNS1&#x3D;192.168.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>ç½‘æ¡¥è¿æ¥è‡³ç‰©ç†ç½‘å¡<br>å‡è®¾ç‰©ç†ç½‘å¡ device æ ‡è¯†ä¸º enp3s0</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli connection add type bridge-slave ifname enp3s0 master br0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯åŠ¨ç½‘æ¡¥</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli connection up br0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å…³é—­ç‰©ç†ç½‘å¡</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">nmcli connection down enp3s0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>å†æ¬¡æŸ¥çœ‹è¿æ¥çŠ¶æ€ï¼Œæˆ–è€…pingä¸€ä¸‹ç™¾åº¦ğŸ«“ï¼Œç¡®è®¤è”ç½‘æˆåŠŸã€‚</p></li></ol><h3 id="Windowsé•œåƒå®‰è£…"><a href="#Windowsé•œåƒå®‰è£…" class="headerlink" title="Windowsé•œåƒå®‰è£…"></a>Windowsé•œåƒå®‰è£…</h3><p>åˆç†åˆæ³•è·å–ISOæ–‡ä»¶ğŸ‘®ğŸš”ã€‚</p><p>ä½¿ç”¨ä¹‹å‰å®‰è£…çš„<code>virt-manager</code>å·¥å…·<br><img src="https://phoenixnap.com/kb/wp-content/uploads/2021/04/2020-11-03_13-19-09.png"><br>æˆ–è€…é€šè¿‡<code>Cockpit</code>å®‰è£…ã€‚<br><img src="https://www.tecmint.com/wp-content/uploads/2020/03/Create-New-Virtual-Machine.png"></p><p>è¯¦ç»†é…ç½®å‚è€ƒ<a href="https://getlabsdone.com/install-windows-server-on-kvm/">10 Easy Steps To Install Windows Server in Linux KVM</a>ï¼Œæ–‡ç« æ­¥éª¤æä¸ºæ¸…æ™°ã€‚è¦æ³¨æ„çš„åœ°æ–¹æœ‰ä¸‰ä¸ªï¼š</p><ol><li><p>CPUè®¾ç½®ï¼Œä¸€å®šè¦æŒ‡å®šæ‹“æ‰‘ç»“æ„ï¼Œè®¾ç½®ä¸å½“ä¼šå½±å“æ€§èƒ½<a href="https://getlabsdone.com/install-windows-server-on-kvm/#Configure-the-CPU-for-the-KVM-windows-guest">Configure the CPU for the KVM windows guest properly.</a>ã€‚å…³äºè¿™äº›å‚æ•°å¦‚ä½•è®¾ç½®ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.cnblogs.com/GyForever1004/p/13600183.html">ã€è¿›ç¨‹è°ƒåº¦ã€‘å…³äºCPUçš„socketsã€diesã€coresã€threadså«ä¹‰ç†è§£</a>ã€‚</p></li><li><p>ç¡¬ç›˜ä¸€å®šé€‰æ‹©VirtIOå½¢å¼ï¼Œæ¯”SATAæ€§èƒ½æ›´å¥½ï¼Œç”šè‡³æ¥è¿‘ç‰©ç†æœºæ°´å¹³<a href="https://getlabsdone.com/install-windows-server-on-kvm/#No-windows-harddisk-in-kvm">No windows harddisk in KVM ?, fix that now.</a>ï¼›æ­¤å¤„æ³¨æ„çš„åŸå› æ˜¯ï¼Œä¸€æ—¦ç”¨SATAæ¨¡å¼å®‰è£…åï¼Œå†åˆ‡æ¢å›VirtIOæ¨¡å¼ï¼ŒWindowsä¼šæ˜¾ç¤º<code>INACCESSIBLE_BOOT_DEVICE</code>å¹¶BSODï¼Œåç»­åˆ‡æ¢ä¼šå¾ˆè´¹åŠ²ã€‚</p></li><li><p>VirtIOé©±åŠ¨å¾ˆé‡è¦ï¼Œä¸èƒ½é—æ¼ä¸‹è½½ã€‚</p></li></ol><h3 id="ç‰©ç†æœºè¿ç§»åˆ°KVM"><a href="#ç‰©ç†æœºè¿ç§»åˆ°KVM" class="headerlink" title="ç‰©ç†æœºè¿ç§»åˆ°KVM"></a>ç‰©ç†æœºè¿ç§»åˆ°KVM</h3><p>å®‰è£…å¥½è™šæ‹Ÿæœºä¹‹åï¼Œéœ€è¦æŠŠåŸå…ˆç‰©ç†æœºä¸Šçš„ç³»ç»ŸåŸå°æ¬è¿‡æ¥ã€‚æˆ‘ä½¿ç”¨<a href="https://www.disktool.cn/backup/backup-software.html">å‚²æ¢…è½»æ¾å¤‡ä»½</a>å·¥å…·</p><ol><li>åœ¨åŸæœºå™¨ä¸Šè¿›è¡Œç³»ç»Ÿå¤‡ä»½ï¼Œå°†å¤‡ä»½å¯¼å…¥ç§»åŠ¨ç¡¬ç›˜</li><li>åœ¨å·¥å…·é‡Œåˆ›å»ºPEï¼Œé€‰æ‹©Windowsç‰ˆï¼Œåˆ›å»ºè¿‡ç¨‹è¿™ä¼šæ‰“åŒ…VirtIOé©±åŠ¨ï¼Œç”Ÿæˆçš„ampe.isoé€šè¿‡scpä¼ è¾“åˆ°å®¿ä¸»æœºä¸Š</li><li>å…³é—­è™šæ‹Ÿæœºï¼Œæ·»åŠ ç¡¬ä»¶ï¼ŒæŒ‚è½½å¤‡ä»½ç¡¬ç›˜ï¼Œampe.isoï¼ŒVirtIOé©±åŠ¨isoã€‚è®¾ç½®ampe.isoä¸ºå¯åŠ¨é¡¹</li><li>è¿›å…¥æ¢å¤ç¨‹åºï¼Œé€‰æ‹©å¤‡ä»½ï¼Œè¿›è¡Œå…¨ç›˜æ¢å¤</li><li>é‡å¯è™šæ‹Ÿæœºï¼Œå¸é™¤æŒ‚è½½ï¼Œè®¾ç½®ä¸»ç¡¬ç›˜ä¸ºå¼•å¯¼é¡¹</li><li>è®¾ç½®å®¿ä¸»æœºå¼•å¯¼æ—¶ï¼Œè™šæ‹ŸæœºåŒæ­¥å¯åŠ¨</li></ol><h3 id="VMè¿ç§»"><a href="#VMè¿ç§»" class="headerlink" title="VMè¿ç§»"></a>VMè¿ç§»</h3><p>å°†ç‰©ç†æœºè¿ç§»åˆ°KVMä¸Šä¹‹åï¼ŒKVMä¹Ÿæä¾›ä¸åŒç‰©ç†æœºä¹‹é—´çš„VMè¿ç§»ï¼Œç›¸å½“äºé›†ç¾¤é—´è™šæ‹Ÿæœºç§»åŠ¨ï¼ŒKVMè¿ç§»æœ‰å†·çƒ­ä¸¤ç§ã€‚ç”±äºçƒ­è¿ç§»éœ€è¦è®¾ç½®NFSå…±äº«ç›˜ï¼Œè¿˜æ²¡åšæµ‹è¯•ï¼Œç›®å‰é€šè¿‡å†·è¿ç§»å®Œæˆäº†ä¸€ä¸ªè™šæ‹Ÿæœºçš„ç§»åŠ¨ã€‚<br>é¦–å…ˆç¡®ä¿ç›®æ ‡å®¿ä¸»æœºé…ç½®å¥½äº†KVMç¯å¢ƒå’Œç½‘ç»œã€‚</p><h4 id="å†·è¿ç§»"><a href="#å†·è¿ç§»" class="headerlink" title="å†·è¿ç§»"></a>å†·è¿ç§»</h4><p>å…³æœº</p><ol><li>é€šè¿‡scpæŠŠè™šæ‹Ÿæœºæ‰€æœ‰qcow2é•œåƒæ–‡ä»¶ä¼ è¾“åˆ°ç›®æ ‡å®¿ä¸»æœº</li><li>æŠŠæ­¤æœºå™¨é…ç½®xmlæ–‡ä»¶ä¼ è¾“åˆ°ç›®æ ‡ï¼Œæ–‡ä»¶ä½ç½®åœ¨<code>/etc/libvirt/qemu/</code><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">scp -rp &#x2F;data&#x2F;win01.qcow2 root@172.168.0.x:&#x2F;datascp -rp &#x2F;etc&#x2F;libvirt&#x2F;qemu&#x2F;cwin01.xml root@172.168.0.x:&#x2F;etc&#x2F;libvirt&#x2F;qemu&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li>ç›®æ ‡å®¿ä¸»æœºåˆ‡æ¢åˆ°xmlé…ç½®ç›®å½•<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">virsh define win01.xml virsh list --all<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div>å¯ä»¥çœ‹åˆ°è™šæ‹Ÿæœºå·²ç»æ³¨å†Œ<br>æ­¤æ—¶å¯åŠ¨è™šæ‹Ÿæœºï¼Œå¯èƒ½ä¼šé‡åˆ°<a href="https://www.pianshen.com/article/65991564217/">KVMä¸Šåˆ›å»ºè™šæ‹Ÿæœºå’Œæƒé™æœ‰å…³çš„æ•…éšœ</a>ã€‚<br>å»ºè®®åœ¨å¯åŠ¨å‰ï¼Œé…ç½®qcow2å­˜æ”¾ç›®å½•æƒé™<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">chown qemu:qemu &#x2F;data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="çƒ­è¿ç§»"><a href="#çƒ­è¿ç§»" class="headerlink" title="çƒ­è¿ç§»"></a>çƒ­è¿ç§»</h4>æš‚æœªåšæµ‹è¯•ï¼Œç•™å‘ã€‚å‚è€ƒ<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="KVMè™šæ‹Ÿæœºè¿ç§»ï¼ˆå†·è¿ç§»ã€çƒ­è¿ç§»ï¼‰">[3]</span></a></sup></li></ol><h3 id="KVMæ€§èƒ½ä¼˜åŒ–"><a href="#KVMæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="KVMæ€§èƒ½ä¼˜åŒ–"></a>KVMæ€§èƒ½ä¼˜åŒ–</h3><ol><li>å­˜å‚¨ä¸»è¦æ˜¯ç£ç›˜æ¨¡å¼ï¼ˆVirtIOï¼‰</li><li>CPUï¼šCPUè¾ƒæ–°çš„å‹å·KVMé‡Œæ²¡æœ‰æä¾›å¯¹åº”æ¨¡æ¿ï¼Œå› æ­¤åœ¨cpuå‹å·è®¾ç½®ä¸­æ‰‹åŠ¨è¾“å…¥<code>host-passthrough</code>å¯ä»¥å‘VMå…¬å¼€ä¸»æœºCPUçš„å…¨éƒ¨åŠŸèƒ½ï¼Œé»˜è®¤è®¾ç½®ä¸‹11700å¤„ç†åœ¨è™šæ‹Ÿæœºä¸­<code>cpuz</code>è‡ªåŠ¨è¯†åˆ«ä¸º10ä»£æœåŠ¡å™¨å¤„ç†å™¨ï¼Œä¸”é”å®šé¢‘ç‡ä¸ºåŸºé¢‘ã€‚è®¾ç½®ç›´é€šåï¼Œå¯ä»¥è¯†åˆ«ä¸ºæ­£ç¡®å‹å·ï¼Œä¸”ç¿é¢‘ç”Ÿæ•ˆ<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="åœ¨virt-managerä¸­ä½¿ç”¨CPUå‹å·ä¸»æœºç›´é€š">[4]</span></a></sup>ã€‚</li><li>æ˜¾ç¤ºæ€§èƒ½ï¼Œç”±äº11ä»£å¤„ç†å™¨é›†æˆæ˜¾å¡æœ‰è¾ƒå¤§å‡çº§ï¼ŒåæœŸå‡†å¤‡ç ”ç©¶ä¸€ä¸‹<code>Intel GVT-g</code>æ˜¾å¡ç›´é€šæŠ€æœ¯ï¼Œæå‡è™šæ‹Ÿæœºæ˜¾ç¤ºæ€§èƒ½ï¼Œè§†é¢‘å¯ä»¥çœ‹èµ·æ¥äº†ğŸ“º</li><li>æ˜¾ç¤ºæ¨¡å¼ï¼šç›®å‰é‡‡ç”¨QXLæ¨¡å¼ï¼Œé»˜è®¤16Mæ˜¾å­˜ï¼Œåœ¨é…ç½®xmlä¸­æ”¹é€ ä¸º128Mï¼Œé‡è½½é…ç½®ç”Ÿæ•ˆï¼Œç”±äºæ‰‹å¤´éƒ½æ˜¯1080pæ˜¾ç¤ºå™¨ï¼Œä¸çŸ¥é“æ˜¯å¦çœŸèƒ½æ”¯æŒ4K<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="qemu+spiceçš„QXLé…ç½®">[5]</span></a></sup>ã€‚</li></ol><h2 id="KVMç®¡ç†WebVirtCloud"><a href="#KVMç®¡ç†WebVirtCloud" class="headerlink" title="KVMç®¡ç†WebVirtCloud"></a>KVMç®¡ç†WebVirtCloud</h2><p><a href="http://retspen.github.io/">WebVirtMgr</a>æ˜¯ä¹‹å‰å¾ˆå¾ˆç«çš„çš„KVMè™šæ‹ŸåŒ–Webç®¡ç†å·¥å…·ï¼Œä½†GitHubä¸Šå¹´ä¹…å¤±ä¿®ï¼Œå¹¶ä¸”é€æ¸è¿ç§»åˆ°WebVirtCloudï¼Œå› æ­¤è€ƒè™‘éƒ¨ç½²WebVirtCloudç®¡ç†æœåŠ¡å™¨ç”¨æ¥å¯¹é›†ç¾¤è™šæ‹Ÿæœºè¿›è¡Œé›†ä¸­ç®¡ç†ã€‚</p><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><a href="https://github.com/retspen/webvirtcloud">WebVirtCloud</a>åŸºäºPython 3.x &amp; Django 3.2 LTSæ„å»ºã€‚</p><p>ç‰¹æ€§åŒ…æ‹¬ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">QEMU&#x2F;KVM Hypervisor ManagementQEMU&#x2F;KVM Instance Management - Create, Delete, UpdateHypervisor &amp; Instance web based statsManage Multiple QEMU&#x2F;KVM HypervisorManage Hypervisor Datastore poolsManage Hypervisor NetworksInstance Console Access with BrowsersLibvirt API based web management UIUser Based Authorization and AuthenticationUser can add SSH public key to root in Instance (Tested only Ubuntu)User can change root password in Instance (Tested only Ubuntu)Supports cloud-init datasource interface<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><h4 id="åˆ›å»ºWebVirtCloudæœåŠ¡å™¨"><a href="#åˆ›å»ºWebVirtCloudæœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºWebVirtCloudæœåŠ¡å™¨"></a>åˆ›å»ºWebVirtCloudæœåŠ¡å™¨</h4><p>ç”±äºWebVirtCloudéœ€è¦é…ç½®é»˜è®¤Nginxé…ç½®ï¼Œä¸”æ²¡æœ‰æä¾›Dockeréƒ¨ç½²æ–¹å¼ï¼Œå› æ­¤è€ƒè™‘å•å¼€ä¸€å°è™šæ‹Ÿæœºä½œä¸ºç®¡ç†æœåŠ¡å™¨ã€‚åˆ›å»ºCentOS8-GUIè™šæ‹Ÿæœºä¸€å°ã€‚é€‰æ‹©GUIç‰ˆï¼Œå¹¶é™„åŠ å®‰è£…è™šæ‹Ÿæœºç»„ä»¶ï¼Œä¸€äº›WebVirtCloudçš„ä¾èµ–åŒ…é™„å¸¦å®‰è£…äº†ï¼Œé…ç½®çš„æ—¶å€™æ¯”è¾ƒçœäº‹ã€‚</p><h4 id="WebVirtCloudå¿«é€Ÿå®‰è£…æ¨¡å¼"><a href="#WebVirtCloudå¿«é€Ÿå®‰è£…æ¨¡å¼" class="headerlink" title="WebVirtCloudå¿«é€Ÿå®‰è£…æ¨¡å¼"></a>WebVirtCloudå¿«é€Ÿå®‰è£…æ¨¡å¼</h4><ol><li>è¿›å…¥å¿«é€Ÿå®‰è£…<br>ç½‘å¥½<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;retspen&#x2F;webvirtcloud&#x2F;master&#x2F;install.shchmod 744 install.sh# run with sudo or root user.&#x2F;install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div>ç½‘ä¸å¥½ï¼Œ<a href="https://github.com/retspen/webvirtcloud/archive/refs/heads/master.zip">ä¸‹è½½</a>åŒ…ï¼Œè§£å‹ï¼Œç„¶å<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">chmod 744 install.sh# run with sudo or root user.&#x2F;install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li><li>å¿«é€Ÿå®‰è£…æ¨¡å¼é‡Œé…ç½®ç«¯å£ï¼Œå»ºè®®é»˜è®¤ï¼ŒåæœŸå¯ä»¥é…ç½®ç«¯å£è½¬å‘<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="Install WebVirtCloud KVM Management on CentOS 8 / Stream 8">[6]</span></a></sup>ã€‚<br>ä»¥ä¸‹æ˜¯é»˜è®¤é…ç½®å’Œéœ€è¦ç¡®è®¤çš„éƒ¨åˆ†<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">WEBVIRTCLOUD  Welcome to Webvirtcloud Installer for CentOS, Fedora, Debian and Ubuntu!  The installer has detected centos version 8.  Q. Do you want to configure fqdn for Nginx? (y&#x2F;n) y  Q. What is the FQDN of your server? (&#123;serverip_or_hostname&#125;):     Setting to &#123;serverip_or_hostname&#125;  Q. Do you want to change NOVNC service port number?(Default: 6080)     Setting novnc service port 6080  Q. Do you want to change NOVNC public port number for reverse proxy(e.g: 80 or 443)?(Default: 6080)      Setting novnc public port 6080  Q. Do you want to change NOVNC host listen ip?(Default: 0.0.0.0)      Setting novnc host ip 0.0.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>ç¡®è®¤åä¼šè‡ªåŠ¨æ‰§è¡Œå®‰è£…ï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œä¼šå‡ºç°<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">***Open http:&#x2F;&#x2F;&#123;hostname&#125; to login to webvirtcloud.**** Cleaning up...* Finished!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li></ol><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><h4 id="æ·»åŠ WebvirtcloudæœåŠ¡å™¨å¯¹KVMå®¿ä¸»æœºçš„sshè®¿é—®"><a href="#æ·»åŠ WebvirtcloudæœåŠ¡å™¨å¯¹KVMå®¿ä¸»æœºçš„sshè®¿é—®" class="headerlink" title="æ·»åŠ WebvirtcloudæœåŠ¡å™¨å¯¹KVMå®¿ä¸»æœºçš„sshè®¿é—®"></a>æ·»åŠ WebvirtcloudæœåŠ¡å™¨å¯¹KVMå®¿ä¸»æœºçš„sshè®¿é—®</h4><ol><li>åœ¨WebvirtcloudæœåŠ¡å™¨ç«¯ï¼Œç”Ÿæˆssh key<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">su - nginx -s &#x2F;bin&#x2F;bashssh-keygen -t rsa -P &#39;&#39;ls -lh &#x2F;var&#x2F;lib&#x2F;nginx&#x2F;.ssh&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li><li>ä¼ è¾“åˆ°KVMå®¿ä¸»æœº<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">ssh-copy-id root@compute1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li>æµ‹è¯•nginxç”¨æˆ·å¯¹KVMå®¿ä¸»æœºçš„è®¿é—®è¿æ¥<div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">virsh --connect qemu+ssh:&#x2F;&#x2F;root@compute1&#x2F;system list --all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div>å¦‚æœå¯ä»¥çœ‹åˆ°è™šæ‹Ÿæœºåˆ—è¡¨ï¼Œåˆ™è¡¨æ˜é…ç½®æˆåŠŸã€‚<br>æ¯æ¬¡æ–°å¢KVMå®¿ä¸»æœºèŠ‚ç‚¹ï¼ŒæŒ‰ä»¥ä¸Šæ­¥éª¤å®ç°ä¸€éå³å¯ã€‚</li></ol><h4 id="è®¿é—®Web-Dashboard"><a href="#è®¿é—®Web-Dashboard" class="headerlink" title="è®¿é—®Web Dashboard"></a>è®¿é—®Web Dashboard</h4><p>åœ¨http://{serverip_or_hostname}å¯è¿›å…¥ç®¡ç†ç™»å½•é¡µé¢ï¼Œé»˜è®¤admin/adminã€‚è¿›å…¥åå¯ä»¥ä¿®æ”¹å¯†ç ç­‰é…ç½®ã€‚</p><p>åœ¨è®¡ç®—èŠ‚ç‚¹ï¼ˆComputerï¼‰é¢æ¿ï¼Œæ·»åŠ sshè¿æ¥åˆ°å®¿ä¸»æœºã€‚FQDN/IP,Loginç­‰é¡¹ç›®æŒ‰ç…§åˆšæ‰é…ç½®çš„sshè®¿é—®é¡¹ç›®å¡«å†™å³å¯ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/IT/KVM/hosts.png"><br>æ·»åŠ åçŠ¶æ€æ˜¾ç¤ºæˆåŠŸå³å¯ï¼Œè¿”å›å®ä¾‹ï¼ˆInstanceï¼‰é¢æ¿å¯¹å®¿ä¸»æœºä¸‹æŒ‚è™šæ‹Ÿæœºè¿›è¡Œç®¡ç†ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/IT/KVM/grouped.png"><br>å®ä¾‹è¯¦æƒ…<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/IT/KVM/instance.png"></p><h2 id="å†…ç½‘ç©¿é€Frp"><a href="#å†…ç½‘ç©¿é€Frp" class="headerlink" title="å†…ç½‘ç©¿é€Frp"></a>å†…ç½‘ç©¿é€Frp</h2><p>æœåŠ¡å™¨é…ç½®å¥½ï¼Œå¤–ç½‘å¦‚æœè¦è®¿é—®ï¼Œä¸”æ²¡æœ‰å›ºå®šIPï¼ˆå…¶å®æ˜¯ğŸ’´ä¸å¤Ÿï¼‰ï¼Œéœ€è¦å†…ç½‘ç©¿é€æ–¹æ¡ˆã€‚åº”æ€¥å¯ä»¥ä½¿ç”¨èŠ±ç”Ÿå£³çš„å…è´¹ç‰ˆï¼Œä½†æµé‡é€Ÿåº¦æœ‰é™ã€‚åˆšå¥½æœ‰å°é˜¿é‡Œäº‘ECSï¼Œå¯ä»¥ä½œä¸ºè·³æ¿ï¼Œè¿›è¡Œå†…ç½‘ç©¿é€ã€‚<br>é€‰ç”¨Frpæ–¹æ¡ˆè¿›è¡Œé…ç½®ã€‚</p><h3 id="Serverç«¯"><a href="#Serverç«¯" class="headerlink" title="Serverç«¯"></a>Serverç«¯</h3><p>é˜¿é‡Œäº‘æœåŠ¡å™¨ä½œä¸ºServer</p><ol><li><p>è·å–Frp</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">wget https:&#x2F;&#x2F;github.com&#x2F;fatedier&#x2F;frp&#x2F;releases&#x2F;download&#x2F;v0.32.1&#x2F;frp_0.32.1_linux_amd64.tar.gztar -zxvf  frp_0.32.1_linux_amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li><p>ç¼–è¾‘<code>frps.ini</code>æ–‡ä»¶<br>é…ç½®serverå’Œclienté€šè®¯ç«¯å£ï¼Œè¿™é‡Œè®¾ç½®ä¸º7000<br>é…ç½®frpæ§åˆ¶é¢æ¿ï¼Œå¯ä»¥ç›‘æ§ç«¯å£çŠ¶æ€</p><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token selector">[common]</span><span class="token constant">bind_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7000</span><span class="token comment">#frp æ§åˆ¶é¢æ¿</span><span class="token constant">dashboard_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7500</span><span class="token comment"># dashboard ç”¨æˆ·åå¯†ç å¯é€‰ï¼Œé»˜è®¤éƒ½ä¸º admin</span><span class="token constant">dashboard_user</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span><span class="token constant">dashboard_pwd</span> <span class="token attr-value"><span class="token punctuation">=</span> admin</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>é…ç½®æœåŠ¡è‡ªå¯åŠ¨</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;frps.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>å†…å®¹ä¸º</p><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token selector">[Unit]</span><span class="token constant">Description</span><span class="token attr-value"><span class="token punctuation">=</span>frps</span><span class="token constant">After</span><span class="token attr-value"><span class="token punctuation">=</span>network.target</span><span class="token selector">[Service]</span><span class="token constant">ExecStart</span><span class="token attr-value"><span class="token punctuation">=</span>/root/frp_0.32.1_linux_amd64/frps -c /root/frp_0.32.1_linux_amd64/frps.ini </span><span class="token selector">[Install]</span><span class="token constant">WantedBy</span><span class="token attr-value"><span class="token punctuation">=</span>multi-user.target</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none"># å¯åŠ¨æµ‹è¯•systemctl start frps.service# æŸ¥çœ‹å¯åŠ¨çŠ¶æ€systemctl status frps.service# å¼€æœºè‡ªå¯systemctl enable frps.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>é…ç½®ä¹‹åï¼Œéœ€è¦åœ¨ECSæ§åˆ¶å°è§„åˆ™é‡Œæ”¾è¡Œé€šè®¯ç«¯å£ä»¥åŠéœ€è¦æ˜ å°„å‡ºå»çš„ç«¯å£ã€‚</p></li></ol><h3 id="Clientç«¯"><a href="#Clientç«¯" class="headerlink" title="Clientç«¯"></a>Clientç«¯</h3><p>åœ¨éœ€è¦ä½¿ç”¨Frpçš„æœºå™¨ä¸Šè¿›è¡Œé…ç½®</p><ol><li>ä¸‹è½½Frp</li><li>ç¼–è¾‘<code>frpc.ini</code><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token selector">[common]</span><span class="token constant">server_addr</span> <span class="token attr-value"><span class="token punctuation">=</span> X.X.X.X # å¡«è‡ªå·±æœåŠ¡å™¨ç«¯çš„IPåœ°å€æˆ–è€…åŸŸå</span><span class="token constant">server_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 7000 # æœåŠ¡å™¨ç«¯å£ï¼Œè·Ÿserverç«¯å¯¹åº”</span><span class="token selector">[ssh]</span>  #åœ¨ä¸€ä¸ªserverä½“ç³»ä¸‹ï¼Œæ­¤å¤„åç§°ä¸èƒ½å†²çª<span class="token constant">type</span> <span class="token attr-value"><span class="token punctuation">=</span> tcp</span><span class="token constant">local_ip</span> <span class="token attr-value"><span class="token punctuation">=</span> 127.0.0.1 </span><span class="token constant">local_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 22</span><span class="token constant">remote_port</span> <span class="token attr-value"><span class="token punctuation">=</span> 6000 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>windowsä¸‹è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼Œä¿è¯è‡ªå¯åŠ¨<br>ç”¨winswå°†frpæ³¨å†Œä¸ºç³»ç»ŸæœåŠ¡<br>ä¸‹è½½ï¼š<a href="https://github.com/kohsuke/winsw/releases">https://github.com/kohsuke/winsw/releases</a><br>æ”¹åä¸ºwinsw.exeï¼Œæ”¾å…¥frpç›®å½•<br>åœ¨æ­¤ç›®å½•ä¸‹ï¼Œæ–°å»º<code>utf8</code>ç¼–ç çš„xmlï¼Œå‘½å<code>winsw.xml</code>,å†…å®¹ä¸º<div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>frp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>frpè¿™é‡Œæ˜¯æœåŠ¡çš„åç§°<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span>è¿™é‡Œæ˜¯æœåŠ¡çš„ä»‹ç»<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">></span></span>frpc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>arguments</span><span class="token punctuation">></span></span>-c frpc.ini<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>arguments</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onfailure</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>restart<span class="token punctuation">"</span></span> <span class="token attr-name">delay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>60 sec<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onfailure</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>restart<span class="token punctuation">"</span></span> <span class="token attr-name">delay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>120 sec<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logmode</span><span class="token punctuation">></span></span>reset<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logmode</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>åœ¨ç›®å½•é‡Œcmdè¿è¡Œ<div class="code-wrapper"><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">winsw installwinsw start# winsw stop# winsw uninstall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>åœ¨ç³»ç»ŸæœåŠ¡ä¸­å°±å¯ä»¥çœ‹åˆ°frpæœåŠ¡äº†</li></ol><h3 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h3><p>æ›´å¤šé«˜çº§è®¾ç½®å¯å‚è€ƒ<a href="https://gofrp.org/docs/">æ–‡æ¡£</a>ã€‚å…¶å®ä¸»è¦å°±æ˜¯åœ¨ä¸¤ç«¯é…ç½®frpså’Œfrpcé…ç½®æ–‡ä»¶ã€‚</p><h1 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h1><p>æŠ˜è…¾ä¸€è·¯ä¸‹æ¥ï¼Œæœ€æ·±åˆ»çš„æ„Ÿå—å°±æ˜¯ï¼šé‡äº‹ä¸å†³å°±é‡å¯ã€‚<br>kill-&gt;restart-&gt;reboot-&gt;ğŸ¤¡</p><p>å®¶ç”¨å¹³å°æŠ˜è…¾äº†ä¸€åœˆï¼Œå‘ç°è™šæ‹ŸåŒ–æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼šèŠ±é’±è®©ä¸“ä¸šçš„äººä¹°ä¸“ä¸šçš„æœåŠ¡å™¨ç»™ä½ å¼„ğŸ’´ğŸ’´ğŸ’´</p><p>å½“ç„¶ï¼Œè‡ªå·±æŠ˜è…¾ä¹å‘µä¹å‘µå°±è¡Œï¼Œè¦ä¸å®¹æ˜“ä¸Šå¤´ğŸ‘¨â€ğŸ¦²</p><h1 id="Acknowledgements"><a href="#Acknowledgements" class="headerlink" title="Acknowledgements"></a>Acknowledgements</h1>   <a href="https://gitee.com/hejiang" class="card-body hover-with-bg" target="_blank" rel="noopener">     <div class="card-content">      <div class="link-avatar my-auto">        <img src="https://portrait.gitee.com/uploads/avatars/user/180/541417_hejiang_1579424599.png!avatar200" alt=""             onerror="this.onerror=null; this.srcset=null; this.src=''"/>      </div>       <div class="link-text">         <div class="link-title">hejiang</div>         <div class="link-intro"></div>       </div>     </div>   </a><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://phoenixnap.com/kb/install-kvm-centos">How to Install KVM on CentOS 8</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.tecmint.com/install-kvm-in-centos-8/">How to Install KVM on CentOS/RHEL 8</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.wanhebin.com/devops/kvm/893.html">KVMè™šæ‹Ÿæœºè¿ç§»ï¼ˆå†·è¿ç§»ã€çƒ­è¿ç§»ï¼‰</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.csdn.net/allway2/article/details/102940533">åœ¨virt-managerä¸­ä½¿ç”¨CPUå‹å·ä¸»æœºç›´é€š</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.icode9.com/content-4-960089.html">qemu+spiceçš„QXLé…ç½®</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://computingforgeeks.com/install-webvirtcloud-kvm-management-on-centos/">Install WebVirtCloud KVM Management on CentOS 8 / Stream 8</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è™šæ‹ŸåŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>KVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç©ºé—´åˆ†æ-å›½ç•Œçœç•Œè·å–</title>
    <link href="/2021/07/23/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E5%9B%BD%E7%95%8C%E7%9C%81%E7%95%8C%E8%8E%B7%E5%8F%96/"/>
    <url>/2021/07/23/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E5%9B%BD%E7%95%8C%E7%9C%81%E7%95%8C%E8%8E%B7%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<p>å›½ç•ŒåŠçœå¸‚è¾¹ç•Œæ˜¯æ—¥å¸¸ä½¿ç”¨è¾ƒä¸ºé¢‘ç¹çš„åŸºç¡€æ•°æ®ã€‚å¯¹äºå±•ç¤ºç”¨é€”ï¼Œå„å¤§å›¾å•†çš„å¼€å‘å¹³å°ä¸€èˆ¬éƒ½æä¾›APIä½¿ç”¨ï¼Œå¦‚æœè¦åœ¨æœ¬åœ°è¿›è¡Œæ•°æ®åˆ†æï¼Œå°±éœ€è¦é€šè¿‡ä¸€äº›é€”å¾„è·å–è¿™äº›æ•°æ®ã€‚</p><ol><li><p>å›½å®¶åŸºç¡€åœ°ç†ä¿¡æ¯ä¸­å¿ƒ<br>è¿™æ˜¯ç›®å‰å…¬å¼€æœ€ä¸ºæƒå¨çš„æ•°æ®æ¥æºï¼Œä¸­å¿ƒæä¾›æ•°æ®<a href="https://www.webmap.cn/mapDataAction.do?method=forw&resType=5&storeId=2&storeName=%E5%9B%BD%E5%AE%B6%E5%9F%BA%E7%A1%80%E5%9C%B0%E7%90%86%E4%BF%A1%E6%81%AF%E4%B8%AD%E5%BF%83">ä¸‹è½½æ–¹å¼</a>ï¼Œå…³äºè¿™ç±»æ•°æ®çš„ä¸‹è½½åŠå¤„ç†æ–¹å¼ï¼Œå„å¤§è®ºå›å‡æœ‰è¯¦ç»†æè¿°ï¼Œå¯å‚ç…§è¿›è¡Œå¤„ç†<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Arcgis(ä¸€) åˆ¶ä½œå…¨å›½è¡Œæ”¿åŒºshpæ–‡ä»¶(ç²¾ç¡®åˆ°å¿çº§)">[1]</span></a></sup>ã€‚</p></li><li><p>åŒ—äº¬å¤§å­¦åœ°ç†ä¿¡æ¯å¹³å°ä¸‹è½½ï¼Œéœ€è¦ç™»å½•æ³¨å†Œè´¦å·æ‰èƒ½ä¸‹è½½ä½¿ç”¨ã€‚<a href="https://geodata.pku.edu.cn/index.php?c=content&a=show&id=171#">ä¸‹è½½åœ°å€</a></p></li><li><p>é˜¿é‡ŒDataV<br>é˜¿é‡ŒDataVæä¾›åœ¨çº¿è¾¹ç•Œæ•°æ®æ¥å£ï¼Œå¯ä»¥è·å¾—é«˜å¾·åæ ‡ç³»ä¸‹çš„è¾¹ç•ŒGeojsonæ ¼å¼æ•°æ®ï¼Œé€šè¿‡åæ ‡è½¬æ¢å¤„ç†ï¼Œå¯è·å¾—84åæ ‡ç³»ä¸‹çš„shpæ–‡ä»¶ä½¿ç”¨ã€‚</p><ul><li>é¦–å…ˆ<a href="http://datav.aliyun.com/tools/atlas/index.html#&lat=39.53793974517628&lng=94.9658203125&zoom=4">åœ¨æ­¤</a>è·å–JSON APIåœ°å€ã€‚</li><li>è·å–å…¨å›½å›½ç•Œã€çœç•Œæ•°æ®<div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd<span class="token keyword">import</span> json<span class="token comment"># API è·å–æ•°æ®</span>re_china <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json'</span><span class="token punctuation">)</span><span class="token comment"># ä¿å­˜ä¸ºjsonæ–‡ä»¶</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'china_100000_full.json'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>re_china<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token comment"># é€šè¿‡geopandaså°†geojsonæ•°æ®è½¬åŒ–ä¸ºshpæ–‡ä»¶å­˜å‚¨</span>gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'china_100000_full.json'</span><span class="token punctuation">)</span>gdf<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">'china'</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">'ESRI Shapefile'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>åŸºäºå…¨å›½çœç•Œæ•°æ®ä¸­çš„adcodeï¼Œç»§ç»­éå†è·å–å¸‚å¿è¾¹ç•Œæ•°æ®<div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># è·å–çœä»½åˆ—è¡¨</span>re_json <span class="token operator">=</span> re_china<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>features_list <span class="token operator">=</span> re_json<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span><span class="token comment"># éå†çœä»½æ•°æ®ä¿å­˜ä¸ºjson å’Œ shpæ–‡ä»¶</span><span class="token keyword">for</span> province <span class="token keyword">in</span> features_list<span class="token punctuation">:</span>    <span class="token comment"># åœ°åŒºä»£ç åŠä¸­æ–‡åç§°</span>    adcode <span class="token operator">=</span> province<span class="token punctuation">[</span><span class="token string">'properties'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'adcode'</span><span class="token punctuation">]</span>    name <span class="token operator">=</span> province<span class="token punctuation">[</span><span class="token string">'properties'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>    re_province <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://geo.datav.aliyun.com/areas_v3/bound/'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>adcode<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_full.json'</span><span class="token punctuation">)</span>    <span class="token comment"># è½¬åŒ–ä¸ºjsonå¯¹è±¡</span>    re_province_json <span class="token operator">=</span> re_province<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># é€šè¿‡é€ç‚¹éå†è¿›è¡Œåæ ‡å‡†æ¢</span>    i <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> feature <span class="token keyword">in</span> re_province_json<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># å¸‚ã€å¿çº§åˆ«éå†</span>        j <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> coordinate <span class="token keyword">in</span> feature<span class="token punctuation">[</span><span class="token string">'geometry'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coordinates'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment">#æœ‰äº›åœ°åŒºå­˜åœ¨é£åœ°ï¼Œå› æ­¤å­˜åœ¨å¤šä¸ªpolygon</span>            k <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> point_gcj02 <span class="token keyword">in</span> coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># é€ç‚¹å‡†æ¢</span>                point_wgs84 <span class="token operator">=</span> gcj02towgs84<span class="token punctuation">(</span>point_gcj02<span class="token punctuation">)</span>                coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> point_wgs84                k <span class="token operator">+=</span> <span class="token number">1</span>            re_province_json<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'geometry'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coordinates'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> coordinate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            j <span class="token operator">+=</span> <span class="token number">1</span>        i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token comment"># ä¿å­˜gcj02åæ ‡ç³»ä¸‹çš„jsonæ•°æ®</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'china_'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'_full_gcj02.json'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>re_province<span class="token punctuation">.</span>content<span class="token punctuation">)</span>    <span class="token comment"># ä¿å­˜wgs84åæ ‡ç³»ä¸‹çš„jsonæ•°æ®</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'china_'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'_full_wgs84.json'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>re_province_json<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># è½¬æ¢ä¸ºshp æ–‡ä»¶</span>    gdf_province <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'china_'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'_full_wgs84.json'</span><span class="token punctuation">)</span>    gdf_province<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">'./china/'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'_full_wgs84.shp'</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">'ESRI Shapefile'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>gcj02towgs84è½¬æ¢æ–¹å¼<a href="https://mattzou.com/2019/03/25/Python-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/">è¯¦è§</a></li></ul></li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/shine4869/article/details/104683147/">Arcgis(ä¸€) åˆ¶ä½œå…¨å›½è¡Œæ”¿åŒºshpæ–‡ä»¶(ç²¾ç¡®åˆ°å¿çº§)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>äº¤é€š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DataV</tag>
      
      <tag>ç©ºé—´æ•°æ®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŠ æ²¹ç«™æ•°æ®è·å–</title>
    <link href="/2021/05/31/Traffic-%E5%8A%A0%E6%B2%B9%E7%AB%99%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/"/>
    <url>/2021/05/31/Traffic-%E5%8A%A0%E6%B2%B9%E7%AB%99%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<p>åŸºäºé«˜å¾·<strong>æœç´¢POI 2.0</strong> Web APIï¼Œè·å–æŒ‡å®šåŒºåŸŸçš„POIä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨foliumè¿›è¡Œå¯è§†åŒ–ã€‚</p><h2 id="é«˜å¾·API"><a href="#é«˜å¾·API" class="headerlink" title="é«˜å¾·API"></a>é«˜å¾·API</h2><p>å‚ç…§<a href="https://lbs.amap.com/api/webservice/guide/api/newpoisearch">æ–‡æ¡£</a>è¯´æ˜ï¼Œè¿›è¡ŒæœåŠ¡keyç”³è¯·ã€‚</p><h2 id="é€šè¿‡å…³é”®è¯æ£€ç´¢POI"><a href="#é€šè¿‡å…³é”®è¯æ£€ç´¢POI" class="headerlink" title="é€šè¿‡å…³é”®è¯æ£€ç´¢POI"></a>é€šè¿‡å…³é”®è¯æ£€ç´¢POI</h2><h3 id="è½½å…¥ä¾èµ–åŒ…"><a href="#è½½å…¥ä¾èµ–åŒ…" class="headerlink" title="è½½å…¥ä¾èµ–åŒ…"></a>è½½å…¥ä¾èµ–åŒ…</h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote<span class="token keyword">from</span> urllib <span class="token keyword">import</span> request<span class="token keyword">import</span> json<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> math<span class="token keyword">import</span> folium<span class="token keyword">from</span> folium<span class="token punctuation">.</span>plugins <span class="token keyword">import</span> MarkerCluster<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å…³é”®å‡½æ•°"><a href="#å…³é”®å‡½æ•°" class="headerlink" title="å…³é”®å‡½æ•°"></a>å…³é”®å‡½æ•°</h3><p>é€šè¿‡åˆ†é¡µéå†å½¢å¼è·å–å…¨éƒ¨POIã€‚</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># å•é¡µè·å–pois</span><span class="token keyword">def</span> <span class="token function">getpoi</span><span class="token punctuation">(</span>region<span class="token punctuation">,</span> keywords<span class="token punctuation">,</span> pagenum<span class="token punctuation">)</span><span class="token punctuation">:</span>    req_url <span class="token operator">=</span> poi_search_url <span class="token operator">+</span> <span class="token string">"?key="</span> <span class="token operator">+</span> amap_web_key <span class="token operator">+</span> <span class="token string">'&amp;keywords='</span> <span class="token operator">+</span> quote<span class="token punctuation">(</span>        keywords<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&amp;region='</span> <span class="token operator">+</span> region <span class="token operator">+</span> <span class="token string">'&amp;citylimit=true'</span> <span class="token operator">+</span> <span class="token string">'&amp;page_size=25'</span> <span class="token operator">+</span> <span class="token string">'&amp;page_num='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>        pagenum<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&amp;output=json'</span>    <span class="token keyword">with</span> request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>req_url<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        re <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        re <span class="token operator">=</span> re<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> re<span class="token comment"># æ ¹æ®åŸå¸‚åç§°å’Œåˆ†ç±»å…³é”®å­—è·å–poiæ•°æ®</span><span class="token keyword">def</span> <span class="token function">getpois</span><span class="token punctuation">(</span>region<span class="token punctuation">,</span> types<span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token number">1</span>    poi_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        re <span class="token operator">=</span> getpoi<span class="token punctuation">(</span>region<span class="token punctuation">,</span> types<span class="token punctuation">,</span> i<span class="token punctuation">)</span>        re <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>re<span class="token punctuation">)</span>        <span class="token keyword">if</span> re<span class="token punctuation">[</span><span class="token string">'count'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">for</span> poi <span class="token keyword">in</span> re<span class="token punctuation">[</span><span class="token string">'pois'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            poi_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>poi<span class="token punctuation">)</span>        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">return</span> poi_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="æ‰§è¡Œ"><a href="#æ‰§è¡Œ" class="headerlink" title="æ‰§è¡Œ"></a>æ‰§è¡Œ</h3><p>åŒºåŸŸç¼–ç <a href="https://lbs.amap.com/api/webservice/download">ä»æ­¤</a>è·å–ã€‚<br>åæ ‡è½¬æ¢(gcj02towgs84)å®ç°æ–¹å¼<a href="https://mattzou.com/2019/03/25/Python-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/">å‚è§</a>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># åˆå§‹å‚æ•°</span>amap_web_key <span class="token operator">=</span> <span class="token string">''</span>poi_search_url <span class="token operator">=</span> <span class="token string">"http://restapi.amap.com/v5/place/text"</span><span class="token comment"># æŒ‡å®šåŒºåŸŸç¼–ç ä¸å…³é”®å­—</span>pois_area <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>getpois<span class="token punctuation">(</span><span class="token string">'120116'</span><span class="token punctuation">,</span> <span class="token string">'åŠ æ²¹ç«™'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># æå–ç»çº¬åº¦</span>pois_area<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span> <span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> pois_area<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token comment"># ç»çº¬åº¦è½¬æ¢</span>pois_area<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude_wgs84'</span><span class="token punctuation">,</span> <span class="token string">'latitude_wgs84'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> pois_area<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>gcj02towgs84<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>                                                                     args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'longitude'</span><span class="token punctuation">,</span> <span class="token string">'latitude'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                                                     result_type<span class="token operator">=</span><span class="token string">"expand"</span><span class="token punctuation">)</span><span class="token comment"># foliumåœ°å›¾å¯è§†åŒ–</span>m <span class="token operator">=</span> folium<span class="token punctuation">.</span>Map<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">38.97</span><span class="token punctuation">,</span> <span class="token number">117.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>               zoom_start<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>marker_cluster <span class="token operator">=</span> MarkerCluster<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># éå†å†…å®¹æ·»åŠ è¿›å…¥MarkerCluster</span><span class="token keyword">for</span> _<span class="token punctuation">,</span> r <span class="token keyword">in</span> pois_area1<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    folium<span class="token punctuation">.</span>Marker<span class="token punctuation">(</span><span class="token punctuation">[</span>r<span class="token punctuation">[</span><span class="token string">'latitude_wgs84'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token string">'longitude_wgs84'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> popup<span class="token operator">=</span>folium<span class="token punctuation">.</span>Popup<span class="token punctuation">(</span>        html<span class="token operator">=</span>folium<span class="token punctuation">.</span>Html<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""&#123;&#125;&lt;/br>&#123;&#125;&lt;/br>"""</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token string">'address'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> script<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        parse_html<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        max_width<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>marker_cluster<span class="token punctuation">)</span><span class="token comment"># ä¿å­˜äº¤äº’åœ°å›¾</span>output_file <span class="token operator">=</span> <span class="token string">"map_fuel.html"</span>m<span class="token punctuation">.</span>save<span class="token punctuation">(</span>output_file<span class="token punctuation">)</span><span class="token comment"># æµè§ˆå™¨æ‰“å¼€</span>webbrowser<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> new<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Traffic/fuelstationmap.jpg/pic"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/qq_34464926/article/details/85084577">æ ¹æ®åŸå¸‚åå’Œåˆ†ç±»åçˆ¬å–å¯¹åº”çš„POIæ•°æ®ï¼ˆåŸºäºé«˜å¾·åœ°å›¾ï¼‰</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/weixin_42540271/article/details/95206598">Pythonçˆ¬è™«é«˜å¾·åœ°å›¾å…¨å›½å„ä¸ªåŸå¸‚POIå¹¶å¯¼å‡ºè¡¨æ ¼</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>äº¤é€š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é«˜å¾·API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸå¸‚å…¬äº¤çº¿è·¯è·å–</title>
    <link href="/2021/05/06/Traffic-%E5%9F%8E%E5%B8%82%E5%85%AC%E4%BA%A4%E5%9C%B0%E9%93%81%E7%BA%BF%E8%B7%AF%E8%8E%B7%E5%8F%96/"/>
    <url>/2021/05/06/Traffic-%E5%9F%8E%E5%B8%82%E5%85%AC%E4%BA%A4%E5%9C%B0%E9%93%81%E7%BA%BF%E8%B7%AF%E8%8E%B7%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<p>åœ¨åŸå¸‚äº¤é€šç ”ç©¶ä¸­ï¼Œå…¬å…±äº¤é€šç³»ç»Ÿæ˜¯é‡è¦ç ”ç©¶å¯¹è±¡ï¼Œå…¶ä¸­å…¬äº¤åœ°é“çº¿è·¯æ•°æ®æ˜¯ç ”ç©¶çš„åŸºç¡€ã€‚ç”±äºå…¬äº¤çº¿è·¯ä¼šå®šæœŸè°ƒæ•´ï¼Œå› æ­¤é€šè¿‡æœåŠ¡å•†APIåŠ¨æ€è·å–çº¿è·¯ä¿¡æ¯æ˜¯è¿™ç±»æ•°æ®å¯é çš„è·å–æ–¹å¼ã€‚</p><h2 id="å…¬äº¤çº¿è·¯åç§°"><a href="#å…¬äº¤çº¿è·¯åç§°" class="headerlink" title="å…¬äº¤çº¿è·¯åç§°"></a>å…¬äº¤çº¿è·¯åç§°</h2><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å…¬äº¤çº¿è·¯åç§°è·å–é€šè¿‡<a href="https://www.8684.cn/">8684ç½‘ç«™</a>æŸ¥è¯¢è§£æè·å–<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Pythonï¼šåˆ©ç”¨é«˜å¾·APIè·å–å…¬äº¤è·¯çº¿å¹¶å¯è§†åŒ–">[1]</span></a></sup>ï¼Œç½‘ç«™çº¿è·¯æ¶µç›–å…¨ï¼Œè§£ææ–¹ä¾¿ã€‚</p><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><p>è§£æå·¥å…·é‡‡ç”¨<code>BeautifulSoup</code>ï¼Œ<code>BeautifulSoup</code>è§£æå™¨åŒºåˆ«å¦‚ä¸‹<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="çˆ¬è™«ï¼špythonä¹‹BeautifulSoup(lxml)">[2]</span></a></sup>ï¼š</p><table><thead><tr><th>è§£æå™¨</th><th>ä½¿ç”¨æ–¹æ³•</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td>pythonæ ‡å‡†åº“</td><td>BeautifulSoup(markup,â€html.parserâ€)</td><td>pythonå†…ç½®æ ‡å‡†åº“<br>æ‰§è¡Œé€Ÿåº¦é€‚ä¸­<br>æ–‡æ¡£çº é”™èƒ½åŠ›å¼º</td><td>python2.7.3ä»¥å‰çš„ç‰ˆæœ¬å®¹é”™èƒ½åŠ›å·®</td></tr><tr><td>lxml HTMLè§£æå™¨</td><td>BeautifulSoup(markup,â€lxmlâ€)</td><td>é€Ÿåº¦å¿«<br>æ–‡æ¡£çº é”™èƒ½åŠ›å¼º</td><td>éœ€è¦å®‰è£…Cè¯­è¨€åº“</td></tr><tr><td>lxml xmlè§£æå™¨</td><td>BeautifulSoup(markup,[â€œlxmlâ€,â€xmlâ€])</td><td>é€Ÿåº¦å¿«<br>å”¯ä¸€çš„æ”¯æŒè§£æçš„xmlçš„è§£æå™¨</td><td>éœ€è¦å®‰è£…Cè¯­è¨€åº“</td></tr><tr><td>html5lib</td><td>BeautifulSoup(markup,â€html5libâ€)</td><td>æœ€å¥½çš„å®¹é”™æ€§<br>ä»¥æµè§ˆå™¨çš„æ–¹å¼è§£ææ–‡æ¡£<br>ç”Ÿæˆhtml5æ ¼å¼çš„æ–‡æ¡£</td><td>é€Ÿåº¦æ…¢<br>ä¸å®œæ‡’å¤–éƒ¨åº“</td></tr></tbody></table><p>è¿™é‡Œè§£æå™¨é‡‡ç”¨<code>lxml</code>ï¼Œéœ€å…ˆå®‰è£…</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">conda install lxml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>çº¿è·¯åç§°è·å–æ–¹å¼å¦‚ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment"># @Author  : MattZou</span><span class="token comment"># @File    : BusLineName.py</span><span class="token comment"># @Software: PyCharm</span><span class="token comment"># -*-----------------*-</span><span class="token comment"># Packages</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> time<span class="token comment"># åˆ—è¡¨è§£æ</span><span class="token keyword">def</span> <span class="token function">list_parse</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># è¯·æ±‚é¡µé¢</span>    home_html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    <span class="token comment"># bsè§£æï¼Œä½¿ç”¨lxmlè§£æå™¨</span>    Soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>home_html<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>    <span class="token comment"># åˆ†ç±»åˆ—è¡¨æå–</span>    list_div <span class="token operator">=</span> Soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'list'</span><span class="token punctuation">)</span>    <span class="token comment"># ä»¥æ•°å­—å¼€å¤´</span>    num_div <span class="token operator">=</span> list_div<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>    <span class="token comment"># ä»¥æ±‰å­—/å­—æ¯å¼€å¤´</span>    char_div <span class="token operator">=</span> list_div<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num_div<span class="token punctuation">,</span> char_div<span class="token comment"># è§£æçº¿è·¯</span><span class="token keyword">def</span> <span class="token function">html_parse</span><span class="token punctuation">(</span>div_list<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    parsed_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> div_list<span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token comment"># é“¾æ¥æå–</span>            href <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>            html <span class="token operator">=</span> url <span class="token operator">+</span> href            temp_html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>html<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>            <span class="token comment"># è§£æå™¨</span>            Soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>temp_html<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>            <span class="token comment"># ä¸‹ä¸€çº§div</span>            cc <span class="token operator">=</span> Soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'cc-content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            cc_a <span class="token operator">=</span> cc<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>            <span class="token comment"># éå†æ·»åŠ </span>            <span class="token keyword">for</span> sub_a <span class="token keyword">in</span> cc_a<span class="token punctuation">:</span>                title <span class="token operator">=</span> sub_a<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>                parsed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>title<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Network Error:'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>            <span class="token keyword">continue</span>        <span class="token keyword">return</span> parsed_list<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># åŸå¸‚åç§°æ‹¼éŸ³</span>    city_name <span class="token operator">=</span> <span class="token string">"zhengzhou"</span>    <span class="token comment"># æŸ¥è¯¢åŸå¸‚ç½‘ç«™åœ°å€</span>    home_page <span class="token operator">=</span> <span class="token string">'https://&#123;&#125;.8684.cn/'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span>    <span class="token comment"># å®šä¹‰è¯·æ±‚å¤´ä¿¡æ¯</span>    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) '</span>                      <span class="token string">'Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51'</span><span class="token punctuation">&#125;</span>    <span class="token comment"># åˆå§‹åŒ–åç§°åˆ—è¡¨</span>    name_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment"># ä»¥æ•°å­—å¼€å¤´</span>    name_list <span class="token operator">+=</span> html_parse<span class="token punctuation">(</span>list_parse<span class="token punctuation">(</span>home_page<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> home_page<span class="token punctuation">)</span>    <span class="token comment"># ä»¥æ±‰å­—/å­—æ¯å¼€å¤´</span>    name_list <span class="token operator">+=</span> html_parse<span class="token punctuation">(</span>list_parse<span class="token punctuation">(</span>home_page<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> home_page<span class="token punctuation">)</span>    <span class="token comment"># è¾“å‡ºæ–‡ä»¶ä¸ºcsv</span>    name_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>name_list<span class="token punctuation">)</span>    name_pd<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_name.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œç”¨æ—¶ï¼š%.2fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="çº¿è·¯è½¨è¿¹åŠç«™ç‚¹"><a href="#çº¿è·¯è½¨è¿¹åŠç«™ç‚¹" class="headerlink" title="çº¿è·¯è½¨è¿¹åŠç«™ç‚¹"></a>çº¿è·¯è½¨è¿¹åŠç«™ç‚¹</h2><h3 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>åŸºäºé‡‡é›†åˆ°çš„å…¬äº¤åç§°ï¼Œåº”ç”¨é«˜å¾·APIæå–æ¯è·¯å…¬äº¤åœç«™ç‚¹åŠçº¿è·¯è½¨è¿¹ã€‚</p><h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">get_line</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> city_name_pinyin<span class="token punctuation">,</span> line_name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># ç”Ÿäº§è¯·æ±‚åœ°å€</span>    url <span class="token operator">=</span> <span class="token string">'https://restapi.amap.com/v3/bus/linename?s=rsv3&amp;extensions=all&amp;key=&#123;&#125;&amp;output'</span> \          <span class="token string">'=json&amp;city=&#123;&#125;&amp;offset=1&amp;keywords=&#123;&#125;&amp;platform=JS'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> city_name_pinyin<span class="token punctuation">,</span> line_name<span class="token punctuation">)</span>    <span class="token comment"># è·å–æ•°æ®</span>    re_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    re_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>re_text<span class="token punctuation">)</span>    <span class="token comment"># noinspection PyBroadException</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># è§£æå…¬äº¤çº¿è·¯éƒ¨åˆ†ä¿¡æ¯</span>        line_info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'line_name_short'</span><span class="token punctuation">:</span> line_name<span class="token punctuation">,</span>                     <span class="token string">'line_name'</span><span class="token punctuation">:</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     <span class="token string">'start_stop'</span><span class="token punctuation">:</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'start_stop'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     <span class="token string">'end_stop'</span><span class="token punctuation">:</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'end_stop'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     <span class="token string">'distance'</span><span class="token punctuation">:</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'distance'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     <span class="token string">'station'</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'busstops'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'sequence'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>        <span class="token comment"># è·å–æ²¿é€”ç«™ç‚¹ç«™åå’Œå¯¹åº”åæ ‡</span>        station_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        station_coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> st <span class="token keyword">in</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'busstops'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            station_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>st<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            station_coords<span class="token punctuation">.</span>append<span class="token punctuation">(</span>st<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        line_info<span class="token punctuation">[</span><span class="token string">'station_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> station_name        line_info<span class="token punctuation">[</span><span class="token string">'station_coords'</span><span class="token punctuation">]</span> <span class="token operator">=</span> station_coords        line_info_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>line_info<span class="token punctuation">)</span>        line_info_pd<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span> <span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> line_info_pd<span class="token punctuation">[</span><span class="token string">'station_coords'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment"># è·å–çº¿è·¯è½¨è¿¹</span>        polyline <span class="token operator">=</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'polyline'</span><span class="token punctuation">]</span>        line_info_route <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'line_name_short'</span><span class="token punctuation">:</span> line_name<span class="token punctuation">,</span> <span class="token string">'station_coords'</span><span class="token punctuation">:</span> polyline<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'line_name'</span><span class="token punctuation">:</span> re_json<span class="token punctuation">[</span><span class="token string">'buslines'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>        route <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>line_info_route<span class="token punctuation">)</span>        route<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">,</span> <span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> route<span class="token punctuation">[</span><span class="token string">'station_coords'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> line_info_pd<span class="token punctuation">,</span> route    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Lineï¼š&#123;&#125; Not Find'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>line_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># åŸå¸‚åç§°æ‹¼éŸ³</span>    city_name <span class="token operator">=</span> <span class="token string">"zhengzhou"</span>    <span class="token comment"># è¯»å–çº¿è·¯åç§°æ–‡ä»¶</span>    name_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_name.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># AppKey</span>    app_key <span class="token operator">=</span> <span class="token string">''</span>    <span class="token comment"># åˆå§‹åŒ–ç»“æœé›†</span>    line_info_pd_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    route_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment"># é€æ¡éå†</span>    <span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> name_pd<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            line_info_pd_temp<span class="token punctuation">,</span> route_temp <span class="token operator">=</span> get_line<span class="token punctuation">(</span>app_key<span class="token punctuation">,</span> city_name<span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            line_info_pd_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line_info_pd_temp<span class="token punctuation">)</span>            route_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>route_temp<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token comment"># ç»“æœåˆå¹¶</span>    line_info_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>line_info_pd_list<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    route_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>route_list<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token comment"># ç»“æœè¾“å‡º</span>    line_info_pd<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_info.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    route_pd<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_route.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿è¡Œç”¨æ—¶ï¼š%.2fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h2><p>ä¾èµ–<code>Geopandas</code>å’Œ<code>shapely</code>åŒ…å®ç°Pointå’ŒLineå¯¹è±¡æ„å»ºï¼Œåˆ›å»ºGeoDataFrame<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Creating a GeoDataFrame from a DataFrame with coordinates">[3]</span></a></sup>ï¼Œå¹¶ä½¿ç”¨<code>folium</code>åˆ›å»ºäº¤äº’åœ°å›¾ã€‚åŒæ—¶å¯¼å‡ºshpæ–‡ä»¶ç”¨ä»¥åç»­åˆ†æã€‚</p><h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>geometry <span class="token keyword">import</span> Point<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>geometry <span class="token keyword">import</span> LineString<span class="token keyword">import</span> folium<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> webbrowsercity_name <span class="token operator">=</span> <span class="token string">'zhengzhou'</span><span class="token comment"># ç”ŸæˆPointå›¾å±‚</span><span class="token keyword">def</span> <span class="token function">csv_to_points</span><span class="token punctuation">(</span>to_shp <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_info.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>df<span class="token punctuation">,</span> crs<span class="token operator">=</span><span class="token string">"EPSG:4326"</span><span class="token punctuation">,</span> geometry<span class="token operator">=</span>gpd<span class="token punctuation">.</span>points_from_xy<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> to_shp<span class="token punctuation">:</span>        gdf_shp <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>df<span class="token punctuation">,</span> crs<span class="token operator">=</span><span class="token string">"EPSG:4326"</span><span class="token punctuation">,</span> geometry<span class="token operator">=</span>gpd<span class="token punctuation">.</span>points_from_xy<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        gdf_shp<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_info.shp'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> gdf<span class="token comment"># ç”ŸæˆLineå›¾å±‚</span><span class="token keyword">def</span> <span class="token function">csv_to_lines</span><span class="token punctuation">(</span>to_shp <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_route.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># æŒ‰çº¿è·¯åç§°èšåˆ</span>    dataGroup <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'line_name_short'</span><span class="token punctuation">)</span>    <span class="token comment"># æ„é€ æ•°æ®</span>    attribute_table <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    geometry <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> name<span class="token punctuation">,</span> group <span class="token keyword">in</span> dataGroup<span class="token punctuation">:</span>        <span class="token comment"># åˆ†ç¦»å‡ºå±æ€§ä¿¡æ¯ï¼Œå–æ¯ç»„çš„ç¬¬1è¡Œå‰5åˆ—ä½œä¸ºæ•°æ®å±æ€§</span>        attribute_table<span class="token punctuation">.</span>append<span class="token punctuation">(</span>group<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># æŠŠåŒä¸€ç»„çš„ç‚¹æ‰“åŒ…åˆ°ä¸€ä¸ªlistä¸­</span>        line <span class="token operator">=</span> LineString<span class="token punctuation">(</span><span class="token punctuation">[</span>xy <span class="token keyword">for</span> xy <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>group<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> group<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        geometry<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">)</span>    <span class="token comment"># ç‚¹è½¬çº¿</span>    gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>attribute_table<span class="token punctuation">,</span> crs<span class="token operator">=</span><span class="token string">"EPSG:4326"</span><span class="token punctuation">,</span> geometry<span class="token operator">=</span>geometry<span class="token punctuation">)</span>    <span class="token keyword">if</span> to_shp<span class="token punctuation">:</span>        gdf<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">'./&#123;&#125;_bus_line_route.shp'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> gdf<span class="token comment"># æ˜¾ç¤ºåœ°å›¾</span>points <span class="token operator">=</span> csv_to_points<span class="token punctuation">(</span><span class="token punctuation">)</span>lines <span class="token operator">=</span> csv_to_lines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># åº•å›¾</span>m <span class="token operator">=</span> folium<span class="token punctuation">.</span>Map<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">34.8</span><span class="token punctuation">,</span> <span class="token number">113.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zoom_start<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>  tiles<span class="token operator">=</span><span class="token string">'CartoDB positron'</span><span class="token punctuation">)</span><span class="token comment"># çº¿å›¾å±‚</span>folium<span class="token punctuation">.</span>Choropleth<span class="token punctuation">(</span>    lines<span class="token punctuation">[</span>lines<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0.001</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    line_weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>    line_color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># ç‚¹å›¾å±‚</span>marker_cluster <span class="token operator">=</span> MarkerCluster<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">for</span> _<span class="token punctuation">,</span> r <span class="token keyword">in</span> points<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    folium<span class="token punctuation">.</span>Marker<span class="token punctuation">(</span><span class="token punctuation">[</span>r<span class="token punctuation">[</span><span class="token string">'latitude'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token string">'longitude'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> popup<span class="token operator">=</span>r<span class="token punctuation">[</span><span class="token string">'line_name_short'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_to<span class="token punctuation">(</span>marker_cluster<span class="token punctuation">)</span>output_file <span class="token operator">=</span> <span class="token string">"map.html"</span>m<span class="token punctuation">.</span>save<span class="token punctuation">(</span>output_file<span class="token punctuation">)</span><span class="token comment"># open in new tab</span>webbrowser<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> new<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Traffic/folium_bus.jpg/pic"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/sinat_36226553/article/details/104948734">Pythonï¼šåˆ©ç”¨é«˜å¾·APIè·å–å…¬äº¤è·¯çº¿å¹¶å¯è§†åŒ–</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/zhangzejia/article/details/79658221">çˆ¬è™«ï¼špythonä¹‹BeautifulSoup(lxml)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://geopandas.readthedocs.io/en/latest/gallery/create_geopandas_from_pandas.html">Creating a GeoDataFrame from a DataFrame with coordinates</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>äº¤é€š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é«˜å¾·API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¥æ„Ÿäº‘å¹³å°</title>
    <link href="/2021/04/20/%E9%81%A5%E6%84%9F%E4%BA%91%E5%B9%B3%E5%8F%B0/"/>
    <url>/2021/04/20/%E9%81%A5%E6%84%9F%E4%BA%91%E5%B9%B3%E5%8F%B0/</url>
    
    <content type="html"><![CDATA[<p>åœ¨GoogleæˆåŠŸæ¨å¹¿GEEä¹‹åï¼Œå¾®è½¯ä¹Ÿæ¨å‡ºäº†<strong>Planetary Computer</strong>ï¼ˆæ‰€ä»¥çœŸæ˜¯åšPCç³»ç»Ÿèµ·å®¶çš„ğŸ¤¡ï¼‰ï¼Œä¸¤å¤§å·¨å¤´éƒ½ç„å‡†äº†ç©ºé—´äº‘è®¡ç®—æœåŠ¡ï¼ˆå¾®è½¯ä¼°è®¡æ˜¯ç›–èŒ¨å»ºè®®çš„ğŸ˜<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="How to Avoid a Climate Disaster">[1]</span></a></sup>ï¼‰è¿™å—å¸‚åœºï¼ŒåŸºäºè‡ªèº«å¼ºå¤§çš„äº‘å­˜å‚¨èƒ½åŠ›ï¼Œä¸ºå…¨çƒç¯å¢ƒæ•°æ®æ‰¾äº†ä¸ªå¥½çš„å»å¤„ï¼ŒåŒæ—¶ä¹Ÿèƒ½è®©å¤§å®¶ç™½å«–<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="å¾®è½¯å®˜æ–¹å•†åŸ">[2]</span></a></sup>ä¸€ä¸‹ç®—åŠ›ï¼ˆæ¯•ç«Ÿæ˜¾å¡é‚£ä¹ˆè´µäº†ğŸ’´ğŸ’´ï¼‰===</p><p>è¿™æ˜¯ä¸ªå¯¼èˆªï¼Œä¼šæŒç»­æ›´æ–°è¿™ä¸¤ä¸ªäº§å“çš„ä½¿ç”¨ç¬”è®°åŠæ„Ÿæ‚Ÿã€‚</p><h2 id="Google-Earth-Engine"><a href="#Google-Earth-Engine" class="headerlink" title="Google Earth Engine"></a>Google Earth Engine</h2><blockquote><ol><li> <a href="https://mattzou.com/2019/11/30/GEE%E7%AC%94%E8%AE%B0/">å…¥é—¨ç¬”è®°</a> <strong>GEE</strong> åŸºç¡€ç¬”è®°</li><li> <a href="https://mattzou.com/2019/11/30/GEE%E7%AC%94%E8%AE%B0-%E4%BA%A7%E5%93%81%E6%98%BE%E7%A4%BA/">äº§å“æ˜¾ç¤º</a> <strong>GEE</strong> <code>code editor</code> åº”ç”¨</li></ol></blockquote><h2 id="Planetary-Computer"><a href="#Planetary-Computer" class="headerlink" title="Planetary Computer"></a>Planetary Computer</h2><p>é‚€è¯·æµ‹è¯•é˜¶æ®µï¼Œ<a href="https://planetarycomputer.microsoft.com/">ç”³è¯·åœ°å€</a></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.gatesnotes.com/Energy/My-new-climate-book-is-finally-here">How to Avoid a Climate Disaster</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.microsoftstore.com.cn/">å¾®è½¯å®˜æ–¹å•†åŸ</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç›®å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äº‘æœåŠ¡</tag>
      
      <tag>é¥æ„Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 æ€»ç»“</title>
    <link href="/2021/04/15/R-ggplot2/"/>
    <url>/2021/04/15/R-ggplot2/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ggplot2ä½¿ç”¨æ€»ç»“ï¼Œå„ç§å‘å’ŒæŠ€å·§</p></blockquote><span id="more"></span><h2 id="What-is-ggplot2"><a href="#What-is-ggplot2" class="headerlink" title="What is ggplot2"></a>What is ggplot2</h2><p><a href="https://ggplot2.tidyverse.org/index.html"><strong>ggplot2</strong></a>æ˜¯<a href="https://www.tidyverse.org/">tidyverse</a>å®¶æ—ä¸­è¿›è¡Œæ•°æ®å¯è§†åŒ–çš„æ ¸å¿ƒpackage<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/tidyverse.jpg/pic"><br>gg:  <strong>Grammar of Graphics</strong></p><h2 id="How-to-use-ggplot2"><a href="#How-to-use-ggplot2" class="headerlink" title="How to use ggplot2"></a>How to use ggplot2</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">install.packages<span class="token punctuation">(</span><span class="token string">"tidyverse"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æ­é…<a href="https://www.rstudio.com/products/rstudio/">RStudio</a>é£Ÿç”¨æ›´ä½³ã€‚</p><h3 id="åŠŸèƒ½é€Ÿè§ˆ"><a href="#åŠŸèƒ½é€Ÿè§ˆ" class="headerlink" title="åŠŸèƒ½é€Ÿè§ˆ"></a>åŠŸèƒ½é€Ÿè§ˆ</h3><ol><li>Rstudioæä¾›ä¸€ç³»åˆ—çš„<a href="https://www.rstudio.com/resources/cheatsheets/">Cheatsheets</a>ç”¨äºå¿«é€Ÿå…¥é—¨åŠæ ¸å¿ƒåŠŸèƒ½é€ŸæŸ¥ï¼Œggplot2éƒ¨åˆ†å¯<a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">ä¸‹è½½</a>ã€‚</li><li>å„å‡½æ•°è¯¦ç»†å‚æ•°åŠç¤ºä¾‹å‚è§<a href="https://ggplot2.tidyverse.org/reference/index.html">Reference</a>ã€‚</li><li>ggplot2è¿˜æ”¯æŒ<a href="https://exts.ggplot2.tidyverse.org/gallery/">æ‹“å±•åŒ…</a>ï¼Œé’ˆå¯¹ç‰¹æ®ŠåŠŸèƒ½ï¼Œå¦‚<a href="https://gganimate.com/">åŠ¨æ€å›¾ç‰‡</a>ã€<a href="https://github.com/jrnold/ggthemes">ä¸»é¢˜è®¾å®š</a>ã€<a href="https://github.com/aphalo/ggpmisc/">å›¾è¡¨æ³¨é‡Š</a>ã€<a href="%5Bggstatsplot%5D(https://github.com/IndrajeetPatil/ggstatsplot)">å¢å¼ºå‹ç»Ÿè®¡å›¾è¡¨</a>ç­‰ï¼Œæ‹“å±•åŒ…æä¾›äº†æ›´å¥½çš„å°è£…ï¼Œç®€åŒ–ä½¿ç”¨ã€‚</li></ol><h3 id="å¯è§†åŒ–ç†å¿µ"><a href="#å¯è§†åŒ–ç†å¿µ" class="headerlink" title="å¯è§†åŒ–ç†å¿µ"></a>å¯è§†åŒ–ç†å¿µ</h3><ul><li><p><strong>ä½œè€…æ„å›¾</strong></p><blockquote><p>All plots are composed of the <strong>data</strong>, the information you want to visualise, and a <strong>mapping</strong>, the description of how the dataâ€™s variables are mapped to aesthetic attributes.<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggplot2: elegant graphics for data analysis">[1]</span></a></sup><br><a href="http://hadley.nz/">Hadley Wickham</a></p></blockquote></li><li><p><strong>æˆ‘çš„ç†è§£</strong><br>ggplot2ï¼ŒæŠŠå›¾åˆ†ä¸ºæ•°æ®ï¼Œå‡ ä½•å›¾å½¢ï¼Œå›¾å½¢å±æ€§ç­‰å‡ ä¸ªéƒ¨åˆ†ï¼Œå›¾çš„å„ä¸ªéƒ¨åˆ†è¢«å®šä¹‰ä¸ºç»„ä»¶å½¢å¼ï¼Œç»„ä»¶å®ç°æ•°æ®ä¸å‡ ä½•å¯¹è±¡çš„æ˜ å°„ï¼Œé€šè¿‡å›¾å½¢å±æ€§å®šä¹‰ç»„ä»¶ä¹‹é—´çš„ç»„åˆå½¢å¼è¿›è¡Œç»˜å›¾ã€‚</p><p>ä¼ ç»Ÿç»˜å›¾æŒ‰ç±»ç»˜å›¾ï¼ŒæŠ½è±¡ç¨‹åº¦è¿‡é«˜ï¼Œå¯¼è‡´ç»˜åˆ¶å¤æ‚å¯¹è±¡ï¼ˆå½¢æ€å’Œæ•°é‡ï¼‰æ—¶ä¸å¤Ÿçµæ´»ï¼Œggplot2 é™ä½äº†å›¾çš„è€¦åˆåº¦ï¼Œå°†å¯¹è±¡å±‚çº§ç”±ç±»å‹å›¾é™ä½åˆ°å›¾ç»„ä»¶ï¼Œè™½ç„¶ggplot2 å®ç°æ–¹å¼åå‘äºå‡½æ•°å¼ç¼–ç¨‹ï¼Œä½†æ¯ä¸ªå‡½æ•°æ“ä½œçš„ä»æ˜¯å•ä¸ªå›¾ç»„ä»¶å¯¹è±¡ï¼Œè¿™ä¾¿äºå·¥ç¨‹åŒ–æ—¶è¿›è¡Œç§»æ¤ä¸å¤ç”¨ã€‚</p><p>å¦‚ä»Šä¸»æµå¯è§†åŒ–æ–¹æ¡ˆä¸­éƒ½é‡‡ç”¨æ•°æ®ä¸å‡ ä½•å¯¹è±¡æ˜ å°„çš„æ€æƒ³ï¼Œè¿™æ ·åˆå°†å›¾ä¸æ•°æ®è¿›è¡Œäº†è§£è€¦åˆï¼Œå¯¹äºå®šä¹‰å¥½çš„æ˜ å°„å…³ç³»ï¼Œåªè¦è¾“å…¥æ•°æ®æ ¼å¼ä¸€å®šï¼Œå›¾å°±å¯ä»¥è‡ªåŠ¨åŒ¹é…ã€‚å› æ­¤å°†æ•°æ®å¤„ç†æ­¥éª¤ä¸ç»˜å›¾è¿›è¡Œéš”ç¦»ã€‚</p></li></ul><h2 id="Tricks-and-Bugs"><a href="#Tricks-and-Bugs" class="headerlink" title="Tricks and Bugs"></a>Tricks and Bugs</h2><h3 id="Framework"><a href="#Framework" class="headerlink" title="Framework"></a>Framework</h3><p>ä¸ªäººä¹ æƒ¯æŒ‰ä»¥ä¸‹æ ¸å¿ƒæ¡†æ¶ç»˜å›¾ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">&lt;-</span>  <span class="token comment"># åˆ›å»ºç©ºç™½ggplotå¯¹è±¡</span> ggplot<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token comment"># æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå‡ ä½•å¯¹è±¡</span> <span class="token comment"># ä¸ªäººä¸å¤ªå–œæ¬¢æŠŠdataå’Œaesæ”¾åœ¨ggplot()é‡Œå…¨å±€è®¾ç½®</span> <span class="token comment"># å¦‚æœå¤šä¸ªå‡ ä½•å¯¹è±¡åˆ†åˆ«ä½¿ç”¨ä¸åŒæ•°æ®æºï¼ŒæŒ‡å®šå…¨å±€è®¾ç½®ä¼šé€ æˆæ··ä¹±</span> geom_point<span class="token punctuation">(</span>data <span class="token operator">=</span> <span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># è®¾ç½®åæ ‡è½´æ ‡é¢˜</span> labs<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># è®¾ç½®åæ ‡è½´ç¼©æ”¾</span> scale_x_continuous<span class="token punctuation">(</span>limits <span class="token operator">=</span> <span class="token punctuation">,</span> breaks <span class="token operator">=</span> <span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># æ·»åŠ æ ‡æ³¨</span> annotate<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># è®¾ç½®ä¸»é¢˜æ ·å¼</span> theme_bw<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># è¦†å†™éƒ¨åˆ†ä¸»é¢˜é…ç½®</span> theme<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å„ç±»å›¾éƒ½å¯ä»¥åœ¨æ­¤æ¨¡æ¿åŸºç¡€ä¸Šè¿›è¡Œè°ƒæ•´ä¸è‡ªå®šä¹‰ï¼Œè¯¦ç»†é…ç½®å»ºè®®å‚è€ƒ<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Function Reference">[2]</span></a></sup>ã€‚</p><p>ä»¥ä¸‹å†…å®¹ä¸ºæˆ‘åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­è°ƒæ•´å’Œé…ç½®çš„tricksã€‚</p><h3 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h3><p>ggplot2 çš„å…¸å‹ç»“æ„å¦‚ä¸‹ï¼Œ<code>panel</code>éƒ¨åˆ†ç”¨äºæ‰¿è½½å‡ ä½•å¯¹è±¡ï¼Œå…¶ä»–æ¯ä¸ªéƒ¨åˆ†éƒ½å¯å•ç‹¬è®¾ç½®ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/structure.png/pic"></p><h3 id="Geoms"><a href="#Geoms" class="headerlink" title="Geoms"></a>Geoms</h3><p>å„ç§Geomsçš„å®ç°æ–¹æ³•å®˜æ–¹ç¤ºä¾‹ååˆ†è¯¦ç»†ï¼Œè¯·<a href="https://ggplot2.tidyverse.org/reference/index.html#section-layers">ç§»æ­¥</a></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># æŸ¥çœ‹è®¾ç½®ç‚¹çš„å½¢çŠ¶</span>ggpubr<span class="token operator">::</span>show_point_shapes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># æŸ¥çœ‹è®¾ç½®çº¿çš„å½¢çŠ¶</span>ggpubr<span class="token operator">::</span>show_line_types<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/pointtype.png/pic"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/linetype.jpg/pic"></div></div><div class="group-image-row"></div></div><h3 id="Scales"><a href="#Scales" class="headerlink" title="Scales"></a>Scales</h3><ul><li><p><a href="https://mattzou.com/2019/11/23/ggplot2-Axis/">ggplot2 åæ ‡è½´è°ƒæ•´</a></p></li><li><p><a href="https://mattzou.com/2020/07/16/ggplot2-Expression/">ggplot2 ä½¿ç”¨expressionæ·»åŠ å…¬å¼ä¸æ•°å­¦ç¬¦å·</a></p></li><li><p><a href="https://mattzou.com/2019/11/23/ggplot2-Dual-Axis/">ggplot2 åŒåæ ‡è½´å®ç°</a></p></li></ul><h3 id="Themes"><a href="#Themes" class="headerlink" title="Themes"></a>Themes</h3><p>ç”¨äºè°ƒæ•´<code>theme(...)</code>ä¸­çš„å†…å®¹ã€‚</p><ul><li><p>èƒŒæ™¯è‰²</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># æ— å¡«å……åˆ™è®¾ç½®ä¸º element_blank()</span><span class="token comment"># ç»˜å›¾åŒº</span>panel.background <span class="token operator">=</span> element_rect<span class="token punctuation">(</span>fill<span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment"># ç»˜å›¾åŒºå¤–ä¾§</span>plot.background <span class="token operator">=</span> element_rect<span class="token punctuation">(</span>fill<span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>ç½‘æ ¼çº¿</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># ä¸»ç½‘æ ¼</span>panel.grid.major <span class="token operator">=</span> element_line<span class="token punctuation">(</span>colour<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># æ¬¡ç½‘æ ¼</span>panel.grid.minor <span class="token operator">=</span> element_line<span class="token punctuation">(</span>colour<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>ç»˜å›¾è¾¹è·<br>æŸ¥çœ‹é»˜è®¤ç»˜å›¾è¾¹è·<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="r - é»˜è®¤çš„ggplot2ç»˜å›¾è¾¹è·æ˜¯å¤šå°‘?">[3]</span></a></sup>ï¼Œå…¶ä»–è¾¹è·å†…å®¹å‚è§<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="Rè¯­è¨€åŸºç¡€ç»˜å›¾ä¹‹è¾¹è·å‚æ•°">[4]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># é»˜è®¤ä¸»é¢˜</span>theme_grey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">$</span>plot.margin<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">5.5</span>pt <span class="token number">5.5</span>pt <span class="token number">5.5</span>pt <span class="token number">5.5</span>pt<span class="token comment"># å…¶ä»–ä¸»é¢˜ï¼ˆæ¨èï¼‰</span>theme_get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">$</span>plot.margin <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p><a href="https://mattzou.com//2020/07/14/ggplot2-Legend/">ggplot2 è°ƒæ•´å›¾ä¾‹</a></p></li></ul><h3 id="Color"><a href="#Color" class="headerlink" title="Color"></a>Color</h3><p><a href="https://mattzou.com/2019/04/21/ggplot2-Color/">ggplot2 é¢œè‰²é…ç½®</a></p><h3 id="Font"><a href="#Font" class="headerlink" title="Font"></a>Font</h3><p>ç»˜å›¾ä½¿ç”¨<code>Times New Roman</code>å­—ä½“ã€‚</p><ol><li>å®šä¹‰å­—ä½“æ ·å¼<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">windowsFonts<span class="token punctuation">(</span>RMN <span class="token operator">=</span> windowsFont<span class="token punctuation">(</span><span class="token string">"Times New Roman"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li>åœ¨éœ€è¦è®¾ç½®å­—ä½“çš„ä½ç½®è®¾ç½®<code>family</code>å±æ€§<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">family <span class="token operator">=</span> <span class="token string">"RMN"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ol><h3 id="Facetting"><a href="#Facetting" class="headerlink" title="Facetting"></a>Facetting</h3><p><a href="https://mattzou.com/2019/07/03/ggplot2-Facet/">ggplot2 åˆ†é¢ç»˜å›¾</a></p><h3 id="Annotations"><a href="#Annotations" class="headerlink" title="Annotations"></a>Annotations</h3><p><a href="https://mattzou.com/2020/10/21/ggplot2-Annotation/">ggplot2 æ·»åŠ æ³¨é‡Š</a></p><h3 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h3><p>ggplot2 å¤šå›¾ç»„åˆä¸»è¦é€šè¿‡<code>grid</code>ç­‰ä¸€ç³»åˆ—åŒ…å®ç°<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="Laying out multiple plots on a page">[5]</span></a></sup>ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/gridExtra.png/pic"><br>è§„åˆ™æ’åˆ—</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å¹¶æ’å¤šå›¾ï¼ŒnrowæŒ‡å®šå›¾åƒæ’åˆ—è¡Œæ•°</span>p <span class="token operator">+</span> grid.arrange<span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># å¤šå›¾ä¸è§„åˆ™æ’åˆ—ï¼Œå°†éœ€è¦æ’åˆ—çš„å›¾åƒåŠ å…¥åˆ—è¡¨ glï¼Œé€šè¿‡layout_matrixæŒ‡å®šæ’åˆ—å½¢å¼</span>p <span class="token operator">+</span> grid.arrange<span class="token punctuation">(</span>  grobs <span class="token operator">=</span> gl<span class="token punctuation">,</span>  widths <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  layout_matrix <span class="token operator">=</span> rbind<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">NA</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        c<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/ggplot2-mixing-multiple-plots-common-legend-data-visualization-1.png/pic"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/layout_matrix.png/pic"></div></div><div class="group-image-row"></div></div><p>å¯¹äºé‡å å›¾å¯ä»¥ä½¿ç”¨<code>annotation_custom</code>ï¼ŒæŒ‡å®šå­å›¾æ’å¸ƒä½ç½®ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># g æ˜¯å­å›¾å…ƒç´ </span>p <span class="token operator">+</span> annotation_custom<span class="token punctuation">(</span>    grob <span class="token operator">=</span> g<span class="token punctuation">,</span>    <span class="token comment"># å®šä½åæ ‡ï¼Œå·¦ä¸‹å³ä¸Šç‚¹</span>    xmin <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>    xmax <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>    ymin <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>    ymax <span class="token operator">=</span> <span class="token number">10</span>  <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>å›¾åƒè¾“å‡ºç›´æ¥ä½¿ç”¨<code>ggsave()</code><sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="Save a ggplot (or other grid object) with sensible defaults">[6]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">ggsave<span class="token punctuation">(</span>  <span class="token comment"># å›¾åƒåç§°</span>  filename<span class="token punctuation">,</span>  <span class="token comment"># å›¾å¯¹è±¡</span>  plot<span class="token punctuation">,</span>  width <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>  height <span class="token operator">=</span> <span class="token keyword">NA</span><span class="token punctuation">,</span>  units <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"in"</span><span class="token punctuation">,</span> <span class="token string">"cm"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ†è¾¨ç‡</span>  dpi <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">,</span>  <span class="token comment"># å¯¹äºtiffç±»å‹å›¾åƒï¼Œå»ºè®®åŠ å…¥æ­¤é€‰é¡¹å‹ç¼©å›¾ç‰‡</span>  compression <span class="token operator">=</span> <span class="token string">"lzw"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>Elsevieræ¨èå‡ºå›¾å°ºå¯¸ï¼Œå¯ä»¥æ®æ­¤è°ƒæ•´<code>width</code><br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/Elsevier.png/pic"></p><h2 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h2><ul><li><p>ggplot2 æä¾›äº†å¼ºå¤§çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡é•¿æœŸä½¿ç”¨å½¢æˆé€‚åº”è‡ªå·±ç ”ç©¶ä½“ç³»çš„ç»˜å›¾æ¨¡æ¿ï¼Œæ–¹ä¾¿ç»˜å›¾çš„æ ‡å‡†åŒ–ï¼Œæœªæ¥ä½¿ç”¨æ—¶å¯å°†æ›´å¤šç²¾åŠ›æ”¾åœ¨æ•°æ®å¤„ç†ä¸Šã€‚</p></li><li><p>ä½†æ›´é«˜çš„çµæ´»åº¦æ„å‘³ç€ç®€å•åŠŸèƒ½å¯èƒ½ä¹Ÿéœ€è¦å¤æ‚ä»£ç å®ç°ï¼ˆæˆ–è€…æ ¹æœ¬å®ç°ä¸äº†ï¼Œéœ€è¦ç»•è·¯ğŸ˜‚ï¼‰ï¼Œå¦‚æœæŠ˜è…¾ç²¾åŠ›ä¸å¤Ÿï¼Œå»ºè®®ç®€å•å›¾è¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿç»˜å›¾è½¯ä»¶ã€‚</p></li><li><p>å¯¹äºç‰¹åˆ«å¤æ‚çš„å›¾ï¼Œå„ç§é«˜ç«¯ç‚«é…·çš„ä»¥åŠ3Dç±»è¿˜æ˜¯å»ºè®®AI+PSï¼ˆæ‡‚å¾—éƒ½æ‡‚ğŸ˜ï¼‰ã€åœ°ç†ç©ºé—´ç±»åˆ™å»ºè®®ä½¿ç”¨<code>Python</code>çš„<a href="https://geopandas.org/">Geopandas</a>ï¼Œæœºå™¨å­¦ä¹ ç±»çš„å›¾ä¹Ÿæ˜¯<code>Python</code>æä¾›çš„è½®å­æ›´å¤šã€‚</p></li><li><p>äº¤äº’ç±»å›¾è¡¨ä¸æ˜¯ggplot2æ“…é•¿çš„åœ°æ–¹ï¼Œç‰¹åˆ«æ˜¯ç”¨äºRMarkdownæ–‡æ¡£å±•ç¤ºçš„å›¾ï¼Œæ¨èä½¿ç”¨å„ç§å›¾è¡¨jsçš„Rç‰ˆæœ¬å®ç°ï¼Œggplot2è¿˜æ˜¯è€è€å®å®åšé™æ€å›¾ç‰‡å§ã€‚<a href="https://mattzou.com/2016/09/26/%E2%80%9C%E5%85%AC%E7%9B%8A%E4%BA%91%E5%9B%BE%E2%80%9D%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/">è¿™é‡Œ</a>æœ‰æˆ‘è¿œå¤æ—¶æœŸåœ¨å…¨Rç¯å¢ƒä¸‹å®ç°çš„äº¤äº’å¼ç½‘é¡µï¼ŒåŠ¨æ€å›¾è¿˜æ˜¯ç”¨å‰ç«¯å·¥å…·åšå§ğŸ˜‚</p></li></ul><blockquote><p>ggplot2 è™½å¥½ï¼Œ å¯ä¸è¦è´ªæ¯ğŸ»å“¦</p></blockquote><h2 id="Acknowledgements"><a href="#Acknowledgements" class="headerlink" title="Acknowledgements"></a>Acknowledgements</h2>   <a href="https://mattzou.com/2021/04/15/R-ggplot2/#Acknowledgements" class="card-body hover-with-bg" target="_blank" rel="noopener">     <div class="card-content">      <div class="link-avatar my-auto">        <img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/%E7%8C%B4%E5%AD%90%E5%A5%B3%E7%8E%8B.jpg" alt=""             onerror="this.onerror=null; this.srcset=null; this.src=''"/>      </div>       <div class="link-text">         <div class="link-title">ğŸ’ğŸ‘‘</div>         <div class="link-intro"></div>       </div>     </div>   </a>   <a href="https://mattzou.com/2021/04/15/R-ggplot2/#Acknowledgements" class="card-body hover-with-bg" target="_blank" rel="noopener">     <div class="card-content">      <div class="link-avatar my-auto">        <img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/%E6%96%87%E4%BB%B6%E4%BC%A0%E5%81%B7%E5%8A%A9%E7%90%86.jpg" alt=""             onerror="this.onerror=null; this.srcset=null; this.src=''"/>      </div>       <div class="link-text">         <div class="link-title">æ–‡ä»¶ä¼ å·åŠ©ç†</div>         <div class="link-intro"></div>       </div>     </div>   </a><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ggplot2-book.org/index.html">ggplot2: elegant graphics for data analysis</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/index.html">Function Reference</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.coder.work/article/6542920">r - é»˜è®¤çš„ggplot2ç»˜å›¾è¾¹è·æ˜¯å¤šå°‘?</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.jianshu.com/p/5fbaf17d9aee">Rè¯­è¨€åŸºç¡€ç»˜å›¾ä¹‹è¾¹è·å‚æ•°</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://cran.r-project.org/web/packages/egg/vignettes/Ecosystem.html">Laying out multiple plots on a page</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">Save a ggplot (or other grid object) with sensible defaults</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç›®å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ğŸ˜PPTç³»ç»ŸğŸ¤£</title>
    <link href="/2021/04/10/Env-PPT%E7%B3%BB%E7%BB%9F/"/>
    <url>/2021/04/10/Env-PPT%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[<p>æŠŠä¹‹å‰çš„è®¾è®¡æ•´åˆä¸€ä¸‹ï¼Œå‹‰å¼ºçœ‹çœ‹ã€‚</p><br><div class="row">    <embed src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Environment/%E7%B3%BB%E7%BB%9F.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>ç¯ä¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äº‘æœåŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mendeley æ–‡çŒ®å¼•ç”¨æ ¼å¼è®¾ç½®</title>
    <link href="/2021/04/03/Mendeley/"/>
    <url>/2021/04/03/Mendeley/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘ä½¿ç”¨Mendeleyï¼Œç ”ç©¶äº†ä¸€ä¸‹å¼•æ–‡æ ¼å¼è°ƒæ•´æ–¹æ³•å’ŒæŠ€å·§ã€‚</p></blockquote><span id="more"></span><h2 id="Mendeleyæ–‡çŒ®å¼•ç”¨æ ¼å¼è®¾ç½®"><a href="#Mendeleyæ–‡çŒ®å¼•ç”¨æ ¼å¼è®¾ç½®" class="headerlink" title="Mendeleyæ–‡çŒ®å¼•ç”¨æ ¼å¼è®¾ç½®"></a>Mendeleyæ–‡çŒ®å¼•ç”¨æ ¼å¼è®¾ç½®</h2><p><strong>æ³¨æ„ï¼šä»…é€‚ç”¨äºWindowsç¯å¢ƒï¼Œå½“å‰æµ‹è¯•ç¯å¢ƒï¼šç³»ç»Ÿç‰ˆæœ¬Win10 21313.1000ï¼Œè½¯ä»¶ç‰ˆæœ¬1.19.8</strong><br>Mendeleyå¼•æ–‡æ ¼å¼ä¸»è¦é€šè¿‡åœ¨çº¿æ–¹å¼ä¸‹è½½æ›´æ–°ï¼Œå¯¹æ ¼å¼çš„è‡ªå®šä¹‰å¯é€šè¿‡å…¶æä¾›çš„CSLåœ¨çº¿ç¼–è¾‘å™¨è¿›è¡Œï¼ŒåŒæ—¶Mendeleyä¹Ÿæ”¯æŒæœ¬åœ°ç¼–è¯‘å¥½çš„CSLæ–‡ä»¶é…ç½®ã€‚</p><h3 id="å¼•æ–‡æ ¼å¼é…ç½®æ–‡ä»¶"><a href="#å¼•æ–‡æ ¼å¼é…ç½®æ–‡ä»¶" class="headerlink" title="å¼•æ–‡æ ¼å¼é…ç½®æ–‡ä»¶"></a>å¼•æ–‡æ ¼å¼é…ç½®æ–‡ä»¶</h3><p><a href="http://citationstyles.org/">Citation Style Language</a><br>CSLç”¨äºé…ç½®å¼•æ–‡æ ¼å¼ï¼ŒZoteroã€Mendeleyç­‰è½¯ä»¶æ”¯æŒæ­¤æ–¹å¼å®šä¹‰å¼•æ–‡æ ¼å¼ã€‚</p><h3 id="Mendeleyä¸­è®¾ç½®å¸¸ç”¨æœŸåˆŠå¼•æ–‡æ–¹å¼"><a href="#Mendeleyä¸­è®¾ç½®å¸¸ç”¨æœŸåˆŠå¼•æ–‡æ–¹å¼" class="headerlink" title="Mendeleyä¸­è®¾ç½®å¸¸ç”¨æœŸåˆŠå¼•æ–‡æ–¹å¼"></a>Mendeleyä¸­è®¾ç½®å¸¸ç”¨æœŸåˆŠå¼•æ–‡æ–¹å¼</h3><ol><li>ç‚¹å‡»èœå•æ <code>View</code>-<code>Citation Style</code>-<code>More Styles...</code></li><li>å¼¹å‡ºçª—å£ä¸­é€‰æ‹©<code>Get More Styles</code><br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Mendeley/Mendeley_install.jpg/pic" alt="å®‰è£…"></li><li>æœç´¢å¯¹åº”æœŸåˆŠä¸‹è½½å®‰è£…å³å¯</li></ol><h3 id="Mendeleyä¸­ç¼–è¾‘å¼•æ–‡æ ¼å¼"><a href="#Mendeleyä¸­ç¼–è¾‘å¼•æ–‡æ ¼å¼" class="headerlink" title="Mendeleyä¸­ç¼–è¾‘å¼•æ–‡æ ¼å¼"></a>Mendeleyä¸­ç¼–è¾‘å¼•æ–‡æ ¼å¼</h3><ol><li>åœ¨å¼¹å‡ºçª—å£ä¸­æŸ¥çœ‹å·²å®‰è£…å¼•æ–‡æ ¼å¼ï¼Œå³é”®<code>Edit Style</code>ï¼Œè·³è½¬è¿›å…¥æµè§ˆå™¨è¿›è¡Œåœ¨çº¿ç¼–è¾‘<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Mendeley/Mendeley_edit.jpg/pic" alt="ç¼–è¾‘"></li><li>å¯è§†åŒ–ç¼–è¾‘åŒºåŸŸ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Mendeley/Mendeley_online_edit.jpg/pic" alt="åœ¨çº¿ç¼–è¾‘"></li></ol><ul><li>å·¦ä¾§æ ‘ç»“æ„ï¼Œå¯åˆ†åˆ«å¯¹å…¨å±€è®¾ç½®ã€æ–‡å†…å¼•ç”¨ã€å‚è€ƒä¹¦ç›®ã€å¼•æ–‡ç»„ä»¶è¿›è¡Œè®¾ç½®</li><li>é¼ æ ‡æ‚¬åœäºå³ä¾§ç¤ºä¾‹ä¸Šï¼Œå·¦ä¾§æ ‘ä¼šé«˜äº®æ˜¾è¿™å—å¼•æ–‡å†…å®¹æ¶‰åŠçš„é…ç½®é¡¹ç›®</li><li><strong>STYLE INFO</strong>ä¸­<code>Global Formatting Options</code>ï¼Œ<code>default-locale</code>é¡¹ç›®å¯è°ƒæ•´åˆ‡æ¢â€˜ç­‰â€˜ä¸â€™<em>et al</em>â€˜ï¼Œå‚æ•°åˆ†åˆ«ä¸ºâ€™zh-CNâ€˜ã€â€™en-USâ€˜</li><li>æ–‡å†…å¼•æ–‡(<strong>Inline Citations</strong>)å’Œå‚è€ƒä¹¦ç›®(<strong>Bibliography</strong>)<ul><li>ç”±<code>Group</code>ç»“æ„æ„æˆï¼Œ<code>Group</code>å†…æˆå‘˜ç”±<code>Macros</code>å®šä¹‰</li><li>ç‚¹å‡»æ ¹èŠ‚ç‚¹ï¼Œå…¶ä¸­<code>et-al-min</code>é¡¹ç›®è®¾ç½®å‡ ä¸ªä½œè€…åå‡ºç°â€™ç­‰â€˜</li><li><code>Sort</code>èŠ‚ç‚¹ï¼Œå®šä¹‰æ–‡çŒ®æ’åˆ—é¡ºåºï¼ŒæŒ‰ä½œè€…ã€æ—¶é—´ç­‰å‡é™åºè§„åˆ™ï¼Œå¯å®šä¹‰å¤šä¸ªè§„åˆ™ï¼Œä¼˜å…ˆçº§ç”±ä¸Šè‡³ä¸‹</li></ul></li></ul><h3 id="æœ¬åœ°CSLæ–‡ä»¶é…ç½®åŠä½¿ç”¨"><a href="#æœ¬åœ°CSLæ–‡ä»¶é…ç½®åŠä½¿ç”¨" class="headerlink" title="æœ¬åœ°CSLæ–‡ä»¶é…ç½®åŠä½¿ç”¨"></a>æœ¬åœ°CSLæ–‡ä»¶é…ç½®åŠä½¿ç”¨</h3><ul><li>å¦‚æœè¦ä½¿ç”¨[GB-T-7714] ç›¸å…³CSLï¼Œå¯ä»ä»¥ä¸‹repoä¸‹è½½<a href="https://github.com/redleafnew/Chinese-STD-GB-T-7714-related-csl">Chinese-STD-GB-T-7714-related-csl</a></li><li>Mendeleyå°†æ‰€æœ‰CSLæ–‡ä»¶å­˜å‚¨åœ¨å¦‚ä¸‹è·¯å¾„<blockquote><p>C:\Users\{User}\AppData\Local\Mendeley Ltd\Mendeley Desktop\citationStyles-1.0</p></blockquote></li><li>å°†ä¸‹è½½åçš„CSLç§»åŠ¨åˆ°æ­¤ç›®å½•</li><li>CSLæ–‡ä»¶ç±»ä¼¼XMLæ ·å¼ï¼Œå¯ä»¥ç›´æ¥æ›´æ”¹å…¶ä¸­é…ç½®<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Mendeley/Mendeley_CSL.jpg/pic" alt="æœ¬åœ°é…ç½®"></li><li>æ–‡ä»¶ä¿®æ”¹ä¿å­˜åï¼Œåœ¨<code>More Styles...</code>çª—å£ä¸­å·²å®‰è£…å¯è§ã€‚</li></ul><h2 id="æ¨èæ’ä»¶"><a href="#æ¨èæ’ä»¶" class="headerlink" title="æ¨èæ’ä»¶"></a>æ¨èæ’ä»¶</h2><h3 id="Mendeley-Reference-Manager"><a href="#Mendeley-Reference-Manager" class="headerlink" title="Mendeley Reference Manager"></a><a href="https://www.mendeley.com/reference-management/reference-manager">Mendeley Reference Manager</a></h3><p><img src="https://cms-cdn.mendeley.com/prod/2021-03/stable_release_desktop_latest_mrm_img.png?qQFcGBSStKhraR6U0otl7yyd3t0ZQdBR"><br>Mendeleyç°åœ¨ä¸»æ¨<strong>Mendeley Reference Manager</strong>ï¼Œè²Œä¼¼æœ‰æ„å–ä»£ç°æœ‰<strong>Desktop</strong>è½¯ä»¶ï¼Œæ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªå¥—å£³æµè§ˆå™¨ğŸ˜‚</p><h3 id="Mendeley-Web-Importer"><a href="#Mendeley-Web-Importer" class="headerlink" title="Mendeley Web Importer"></a><a href="https://www.mendeley.com/reference-management/web-importer">Mendeley Web Importer</a></h3><p><img src="https://cms-cdn.mendeley.com/prod/2019-09/web_importer_chrome_desktop.png?TOU3kk7tQZboiFYrIn90RYh1TyDQvaTg"><br>æ–‡çŒ®å¯¼å…¥åˆ©å™¨ï¼Œæµè§ˆå™¨éšçœ‹éšå¯¼ï¼Œè‡ªåŠ¨è¯†åˆ«å†…å®¹o(ï¿£â–½ï¿£)ï½„</p>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Mendeley</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äº¤é€šä¸GNN</title>
    <link href="/2020/12/11/Traffic-and-AI/"/>
    <url>/2020/12/11/Traffic-and-AI/</url>
    
    <content type="html"><![CDATA[<br><div class="row">    <embed src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Environment/Traffic%20and%20AI.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>ç¯ä¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äº¤é€š</tag>
      
      <tag>GNN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 æ·»åŠ æ³¨é‡Š</title>
    <link href="/2020/10/21/ggplot2-Annotation/"/>
    <url>/2020/10/21/ggplot2-Annotation/</url>
    
    <content type="html"><![CDATA[<p>ä¸»è¦ä»‹ç»ggplot2æ·»åŠ å›¾æ³¨é‡Š</p><h2 id="ä½¿ç”¨annotate"><a href="#ä½¿ç”¨annotate" class="headerlink" title="ä½¿ç”¨annotate()"></a>ä½¿ç”¨annotate()</h2><p>ggplot2 ä¸­æä¾›å„ç§çµæ´»çš„æ–¹å¼æ·»åŠ æ³¨é‡Šï¼Œæ¯”å¦‚ä½¿ç”¨<code>geom_text, geom_rect, geom_line</code>ç­‰ï¼Œä½†æˆ‘æ›´æ¨èä½¿ç”¨<code>annotate()</code>è¿›è¡Œæ ‡æ³¨ã€‚</p><p><code>annotate()</code>ä½¿ç”¨<code>vectors</code>ä¸­çš„å€¼è¿›è¡Œå‡ ä½•å¯¹è±¡æ•°æ®æ˜ å°„ï¼Œç›¸æ¯”<code>geom_</code>ç±»ä»<strong>data frame</strong>æ˜ å°„æ•°æ®æ›´åŠ è½»ä¾¿<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Create an annotation layer">[1]</span></a></sup>ã€‚</p><h2 id="æ ‡æ³¨ç±»å‹"><a href="#æ ‡æ³¨ç±»å‹" class="headerlink" title="æ ‡æ³¨ç±»å‹"></a>æ ‡æ³¨ç±»å‹</h2><p><code>annotate()</code>é€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šæ ‡æ³¨ç±»å‹ï¼š</p><blockquote><p><code>&quot;text&quot;ï¼Œ&quot;rect&quot;ï¼Œ&quot;segment&quot;ï¼Œ&quot;pointrange&quot;ï¼Œ&quot;curve&quot;</code>ï¼Œ</p></blockquote><h2 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h2><ul><li><p>ä»¥åæ ‡å½¢å¼æŒ‡å®šæ ‡æ³¨æ”¾ç½®ä½ç½®</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> annotate<span class="token punctuation">(</span>    geom <span class="token operator">=</span> <span class="token string">"curve"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> xend <span class="token operator">=</span> <span class="token number">2.65</span><span class="token punctuation">,</span> yend <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">,</span>     curvature <span class="token operator">=</span> <span class="token number">.3</span><span class="token punctuation">,</span> arrow <span class="token operator">=</span> arrow<span class="token punctuation">(</span>length <span class="token operator">=</span> unit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span> <span class="token operator">+</span>  annotate<span class="token punctuation">(</span>geom <span class="token operator">=</span> <span class="token string">"text"</span><span class="token punctuation">,</span> x <span class="token operator">=</span> <span class="token number">4.1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">"subaru"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/curve_annotation-1.png/pic"></p></li><li><p>å¯¹äº<code>&quot;rect&quot;</code>å‹æ ‡æ³¨ï¼Œé€šè¿‡è®¾ç½® <code>ymin/ymax</code> ä¸º <code>+/-Inf</code>ï¼Œç»˜åˆ¶èƒŒæ™¯åˆ†åŒºæ ·å¼<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Annotations">[2]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> geom_rect<span class="token punctuation">(</span>    aes<span class="token punctuation">(</span>xmin <span class="token operator">=</span> start<span class="token punctuation">,</span> xmax <span class="token operator">=</span> end<span class="token punctuation">,</span> fill <span class="token operator">=</span> party<span class="token punctuation">)</span><span class="token punctuation">,</span>     ymin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">Inf</span><span class="token punctuation">,</span> ymax <span class="token operator">=</span> <span class="token number">Inf</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>     data <span class="token operator">=</span> presidential  <span class="token punctuation">)</span> <span class="token operator">+</span>   scale_fill_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/unemp-pres-1.png/pic"></p></li><li><p>åœ¨Facet<a href="https://mattzou.com/2019/07/03/ggplot2-Facet/#%E4%B8%BA%E4%B8%8D%E5%90%8C%E5%AD%90%E5%9B%BE%E5%A2%9E%E5%8A%A0%E6%A0%87%E6%B3%A8">å¢åŠ æ ‡æ³¨</a>å‚è€ƒæ­¤æ–‡ã€‚</p></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/annotate.html">Create an annotation layer</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://ggplot2-book.org/annotations.html#annotations">Annotations</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 ä½¿ç”¨expressionæ·»åŠ å…¬å¼ä¸æ•°å­¦ç¬¦å·</title>
    <link href="/2020/07/16/ggplot2-Expression/"/>
    <url>/2020/07/16/ggplot2-Expression/</url>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶éœ€è¦åœ¨å›¾ä¸Šæ ‡æ³¨è¯¸å¦‚æ•°å­¦å…¬å¼ã€ä¸Šä¸‹æ ‡ç­‰ç¬¦å·ï¼Œè¯¥æ“ä½œå¯ä»¥é€šè¿‡<code>expression</code>å‡½æ•°å®Œæˆã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å¦‚æœåœ¨ggplot2ä¸­<code>text</code>å‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼å½¢å¼ï¼ˆ<code>expression</code>ï¼‰ï¼Œåˆ™è¯¥å‚æ•°å°†è¢«æ ¹æ®ç±»ä¼¼TeXçš„è§„åˆ™å¯¹è¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºã€‚<code>expression</code>å¯ç”¨äºæ ‡é¢˜ï¼Œæ³¨é‡Šä»¥åŠxè½´å’Œyè½´æ ‡ç­¾<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Mathematical Annotation in R">[1]</span></a></sup>ã€‚</p><p><code>expression</code>ä»£ç ä¸è¾“å‡ºçš„å¯¹åº”å…³ç³»å¦‚å›¾<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/expression.jpg/pic"></p><h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><h3 id="æ™®é€šlabel"><a href="#æ™®é€šlabel" class="headerlink" title="æ™®é€šlabel"></a>æ™®é€šlabel</h3><p>å¦‚æœåªæ˜¯è¾“å‡ºå•ç‹¬ç¬¦å·ï¼Œåˆ™ç‹¬ç«‹ä½¿ç”¨<strong>expression</strong>å³å¯ï¼Œå¦‚æœç»„åˆå¤æ‚å…¬å¼æˆ–æ·»åŠ æ–‡æœ¬æè¿°ï¼Œåˆ™åœ¨<strong>expression</strong>ä¸­ä½¿ç”¨<strong>paste</strong>è¿›è¡Œæ‹¼æ¥ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å…¨å…¬å¼</span> labels <span class="token operator">=</span> expression<span class="token punctuation">(</span><span class="token operator">-</span>pi<span class="token punctuation">,</span> <span class="token operator">-</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> pi<span class="token punctuation">)</span><span class="token comment"># æ–‡æœ¬ä¸ç¬¦å·ç»„åˆ</span> xlab <span class="token operator">=</span> expression<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"Phase Angle "</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="facet-grid-ä¸­çš„label"><a href="#facet-grid-ä¸­çš„label" class="headerlink" title="facet_grid()ä¸­çš„label"></a><code>facet_grid()</code>ä¸­çš„label</h3><p>éœ€è¦å°†labelè§£ææ–¹å¼è®¾ç½®ä¸ºâ€label_parsedâ€<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Formatting Math Symbols and Expressions in ggplot Labels">[2]</span></a></sup>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">facet_grid<span class="token punctuation">(</span><span class="token operator">~</span> x<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">"label_parsed"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="annotate-ä¸­çš„label"><a href="#annotate-ä¸­çš„label" class="headerlink" title="annotate()ä¸­çš„label"></a><code>annotate()</code>ä¸­çš„label</h3><p><strong>text</strong>ç±»å‹çš„æ ‡æ³¨ï¼Œéœ€å°†parseè®¾ç½®ä¸ºTRUEã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">annotate<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">,</span> label <span class="token operator">=</span> expression<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">,</span> parse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/plotmath.html">Mathematical Annotation in R</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.benjaminackerman.com/post/2019-03-08-equation_labels/">Formatting Math Symbols and Expressions in ggplot Labels</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 è°ƒæ•´å›¾ä¾‹</title>
    <link href="/2020/07/14/ggplot2-Legend/"/>
    <url>/2020/07/14/ggplot2-Legend/</url>
    
    <content type="html"><![CDATA[<p>ä¸»è¦ä»‹ç»ggplot2é‡ŒLegendéƒ¨åˆ†è®¾ç½®</p><p>ggplot2æä¾›<code>guide_legend()</code>è®¾ç½®å›¾ä¾‹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Legend guide">[1]</span></a></sup>ï¼Œæ›´å¤šå‚æ•°å¯å‚è€ƒã€‚</p><h2 id="å¸¸ç”¨è®¾ç½®"><a href="#å¸¸ç”¨è®¾ç½®" class="headerlink" title="å¸¸ç”¨è®¾ç½®"></a>å¸¸ç”¨è®¾ç½®</h2><p>ä»¥ä¸‹è®¾ç½®åœ¨<code>theme()</code>ä¸­é…ç½®ï¼Œå¸¸è§„è®¾ç½®è¯·å‚è€ƒ<a href="http://www.sthda.com/english/wiki/ggplot2-legend-easy-steps-to-change-the-position-and-the-appearance-of-a-graph-legend-in-r-software">æ­¤æ–‡</a>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å›¾ä¾‹ä½ç½®ä¸æ–‡å­—æ ·å¼è°ƒæ•´</span>legend.position <span class="token operator">=</span> <span class="token operator">|</span><span class="token string">"left"</span><span class="token punctuation">,</span> <span class="token string">"top"</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">,</span> <span class="token string">"bottom"</span><span class="token punctuation">,</span> <span class="token string">"none"</span><span class="token operator">|</span>legend.text <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token punctuation">,</span>legend.title <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>æˆ‘è‡ªå·±ç»˜å›¾æ—¶è¿˜å¯¹ä»¥ä¸‹å†…å®¹è¿›è¡Œè®¾ç½®ã€‚</p><h3 id="å›¾ä¾‹å°ºå¯¸ä¸è¾¹è·"><a href="#å›¾ä¾‹å°ºå¯¸ä¸è¾¹è·" class="headerlink" title="å›¾ä¾‹å°ºå¯¸ä¸è¾¹è·"></a>å›¾ä¾‹å°ºå¯¸ä¸è¾¹è·</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å›¾ä¾‹é•¿å®½</span> legend.key.size<span class="token operator">=</span>unit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'mm'</span><span class="token punctuation">)</span> legend.key.width<span class="token operator">=</span>unit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'mm'</span><span class="token punctuation">)</span><span class="token comment"># å›¾ä¾‹ä¸å›¾çš„è·ç¦»æˆ–ä¸¤ä¸ªå›¾ä¾‹ä¹‹é—´è·ç¦»</span> legend.margin<span class="token operator">=</span>margin<span class="token punctuation">(</span>b <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.3</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'cm'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å›¾ä¾‹æ–‡å­—ä¸é¢œè‰²æ˜ å°„"><a href="#å›¾ä¾‹æ–‡å­—ä¸é¢œè‰²æ˜ å°„" class="headerlink" title="å›¾ä¾‹æ–‡å­—ä¸é¢œè‰²æ˜ å°„"></a>å›¾ä¾‹æ–‡å­—ä¸é¢œè‰²æ˜ å°„</h3><p>å¯¹äº<code>aes()</code>äº§ç”Ÿçš„å›¾ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨<code>scale_color_identity</code>æˆ–<code>scale_color_manual</code>ä¸¤ç§æ–¹å¼è‡ªå®šä¹‰å›¾ä¾‹æ˜¾ç¤ºåç§°ä¸é¢œè‰²çš„æ˜ å°„å…³ç³»<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Creating legends when aesthetics are constants in ggplot2">[2]</span></a></sup></p><ol><li><code>aes</code>å®šä¹‰é¢œè‰²æè¿°ï¼Œé€šè¿‡labelæŒ‡å®šæ–‡å­—æè¿°<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">ggplot<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>mpg<span class="token punctuation">,</span> hp<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">+</span>     geom_point<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>     geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">+</span>     geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> y <span class="token operator">~</span> poly<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>     geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> y <span class="token operator">~</span> poly<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>     scale_color_identity<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Model fit"</span><span class="token punctuation">,</span>                          breaks <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                          labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Linear"</span><span class="token punctuation">,</span> <span class="token string">"Quadratic"</span><span class="token punctuation">,</span> <span class="token string">"Cubic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                          guide <span class="token operator">=</span> <span class="token string">"legend"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><code>aes</code>å®šä¹‰æ–‡å­—æè¿°ï¼Œé€šè¿‡valueå»ºç«‹é¢œè‰²æ˜ å°„<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">ggplot<span class="token punctuation">(</span>mtcars<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>mpg<span class="token punctuation">,</span> hp<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">+</span>  geom_point<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"Linear"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">+</span>  geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> y <span class="token operator">~</span> poly<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"Quadratic"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> y <span class="token operator">~</span> poly<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> aes<span class="token punctuation">(</span>color <span class="token operator">=</span> <span class="token string">"Cubic"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  scale_color_manual<span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Model fit"</span><span class="token punctuation">,</span>                     breaks <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Linear"</span><span class="token punctuation">,</span> <span class="token string">"Quadratic"</span><span class="token punctuation">,</span> <span class="token string">"Cubic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                     values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Cubic"</span> <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"Quadratic"</span> <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"Linear"</span> <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ol><h3 id="å›¾ä¾‹é¡ºåº"><a href="#å›¾ä¾‹é¡ºåº" class="headerlink" title="å›¾ä¾‹é¡ºåº"></a>å›¾ä¾‹é¡ºåº</h3><p>å¯¹äºå¤šä¸ªå›¾ä¾‹(size, shape, colour, alpha, fillç­‰)ï¼Œå¤šä¸ªå›¾ä¾‹é¡ºåºè°ƒæ•´æ–¹å¼å¦‚ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># nrowè°ƒèŠ‚è¡Œåˆ—æ•°ï¼Œorderè°ƒèŠ‚å¤šä¸ªå›¾ä¾‹çš„é¡ºåº</span>p <span class="token operator">+</span> guides<span class="token punctuation">(</span>colour <span class="token operator">=</span> guide_legend<span class="token punctuation">(</span>nrow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>             fill <span class="token operator">=</span> guide_legend<span class="token punctuation">(</span>nrow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h2 id="Open-airé£ç«ç‘°å›¾å›¾ä¾‹Labelå®šä¹‰"><a href="#Open-airé£ç«ç‘°å›¾å›¾ä¾‹Labelå®šä¹‰" class="headerlink" title="Open airé£ç«ç‘°å›¾å›¾ä¾‹Labelå®šä¹‰"></a>Open airé£ç«ç‘°å›¾å›¾ä¾‹Labelå®šä¹‰</h2><p>é€šè¿‡åŠ å…¥<code>key = list(labels = c())</code>è¿›è¡Œå®šä¹‰ï¼Œæ›¿æ¢ç°æœ‰label<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Changing the legend labels in a windrose from R openair">[3]</span></a></sup>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>openair<span class="token punctuation">)</span>windRose<span class="token punctuation">(</span>mydata<span class="token punctuation">,</span> ws<span class="token operator">=</span><span class="token string">"ws"</span><span class="token punctuation">,</span> wd<span class="token operator">=</span><span class="token string">"wd"</span><span class="token punctuation">,</span> breaks<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">,</span><span class="token number">3.3</span><span class="token punctuation">,</span><span class="token number">5.4</span><span class="token punctuation">,</span><span class="token number">7.9</span><span class="token punctuation">,</span><span class="token number">10.7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          auto.text<span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> paddle <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> annotate <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>         key <span class="token operator">=</span> list<span class="token punctuation">(</span>labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">Legend guide</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://aosmith.rbind.io/2018/07/19/manual-legends-ggplot2/">Creating legends when aesthetics are constants in ggplot2</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://databasefaq.com/index.php/answer/112135/r-legend-changing-the-legend-labels-in-a-windrose-from-r-openair">Changing the legend labels in a windrose from R openair</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>6-5ç¯å¢ƒæ—¥å®£ä¼ ppt</title>
    <link href="/2020/06/06/Env-65%E7%8E%AF%E5%A2%83%E6%97%A5/"/>
    <url>/2020/06/06/Env-65%E7%8E%AF%E5%A2%83%E6%97%A5/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¹´å…­äº”ç¯å¢ƒæ—¥ä¸»é¢˜â€œç¾ä¸½ä¸­å›½ï¼Œæˆ‘æ˜¯è¡ŒåŠ¨è€…â€<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ç”Ÿæ€ç¯å¢ƒéƒ¨å‘å¸ƒ2020å¹´å…­äº”ç¯å¢ƒæ—¥ä¸»é¢˜æµ·æŠ¥">[1]</span></a></sup>ï¼Œæ™ºæ…§äº¤é€šåŠ©åŠ›ç¯ä¿ã€‚</p><br><div class="row">    <embed src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Environment/%E8%8E%86%E7%94%B065.pdf" width="100%" height="550" type="application/pdf"></div><br><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.mee.gov.cn/ywgz/xcjy/xccpzyk/hb/202005/t20200522_780328.shtml">ç”Ÿæ€ç¯å¢ƒéƒ¨å‘å¸ƒ2020å¹´å…­äº”ç¯å¢ƒæ—¥ä¸»é¢˜æµ·æŠ¥</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç¯ä¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ—¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GEE å¸¸ç”¨å«æ˜Ÿäº§å“è½½å…¥åŠæ˜¾ç¤º</title>
    <link href="/2019/11/30/GEE%E7%AC%94%E8%AE%B0-%E4%BA%A7%E5%93%81%E6%98%BE%E7%A4%BA/"/>
    <url>/2019/11/30/GEE%E7%AC%94%E8%AE%B0-%E4%BA%A7%E5%93%81%E6%98%BE%E7%A4%BA/</url>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨GEEå¹³å°code editoré‡Œæ˜¾ç¤ºå«æ˜Ÿäº§å“</p></blockquote><span id="more"></span><p>åœ¨GEEä¸­ï¼Œéƒ¨åˆ†èµ„äº§å¯ä»¥é€šè¿‡<a href="https://explorer.earthengine.google.com/#workspace">Explorer</a>è¿›è¡Œé¢„è§ˆï¼Œå¤šæ•°æƒ…å†µä¸‹ä¸‹åœ¨<a href="https://code.earthengine.google.com/">Editor</a>é‡ŒæŸ¥çœ‹æ›´ä¸ºæ–¹ä¾¿ã€‚</p><h2 id="Landsat-8"><a href="#Landsat-8" class="headerlink" title="Landsat 8"></a>Landsat 8</h2><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> l8 <span class="token operator">=</span> ee<span class="token punctuation">.</span><span class="token function">ImageCollection</span><span class="token punctuation">(</span><span class="token string">"LANDSAT/LC08/C01/T1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    roi <span class="token operator">=</span>     ee<span class="token punctuation">.</span>Geometry<span class="token punctuation">.</span><span class="token function">Polygon</span><span class="token punctuation">(</span>        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">119.23097080607909</span><span class="token punctuation">,</span> <span class="token number">36.93905749319195</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">119.23097080607909</span><span class="token punctuation">,</span> <span class="token number">32.21992180906591</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">124.09242100139159</span><span class="token punctuation">,</span> <span class="token number">32.21992180906591</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">124.09242100139159</span><span class="token punctuation">,</span> <span class="token number">36.93905749319195</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">var</span> Data_Collection <span class="token operator">=</span> l8<span class="token punctuation">.</span><span class="token function">filterDate</span><span class="token punctuation">(</span><span class="token string">'2016-05-01'</span><span class="token punctuation">,</span><span class="token string">'2016-08-30'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€‰æ‹©äº‘é‡æœ€å°‘çš„å½±åƒç»„åˆ</span><span class="token keyword">var</span> Select_Collection<span class="token operator">=</span>  ee<span class="token punctuation">.</span>Algorithms<span class="token punctuation">.</span>Landsat<span class="token punctuation">.</span><span class="token function">simpleComposite</span><span class="token punctuation">(</span>Data_Collection<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span>roi<span class="token punctuation">)</span><span class="token comment">//è½½å…¥å›¾å±‚</span>Map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>Select_Collection<span class="token punctuation">,</span><span class="token punctuation">&#123;</span>bands<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"B4"</span><span class="token punctuation">,</span><span class="token string">"B3"</span><span class="token punctuation">,</span><span class="token string">"B2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>gamma<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">,</span>max<span class="token operator">:</span> <span class="token number">108</span><span class="token punctuation">,</span>min<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">'True-Color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Map<span class="token punctuation">.</span><span class="token function">centerObject</span><span class="token punctuation">(</span>roi<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="MODIS"><a href="#MODIS" class="headerlink" title="MODIS"></a>MODIS</h2><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// é€‰æ‹©æ•°æ®æºï¼Œå¹¶å®šä¹‰èŒƒå›´ roi</span><span class="token keyword">var</span> mod500 <span class="token operator">=</span> ee<span class="token punctuation">.</span><span class="token function">ImageCollection</span><span class="token punctuation">(</span><span class="token string">"MODIS/006/MYD09A1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    roi <span class="token operator">=</span>     ee<span class="token punctuation">.</span>Geometry<span class="token punctuation">.</span><span class="token function">Polygon</span><span class="token punctuation">(</span>        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">118.96562188688824</span><span class="token punctuation">,</span> <span class="token number">36.08745610383932</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">118.96562188688824</span><span class="token punctuation">,</span> <span class="token number">34.000935416392934</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">121.29472344938824</span><span class="token punctuation">,</span> <span class="token number">34.000935416392934</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token punctuation">[</span><span class="token number">121.29472344938824</span><span class="token punctuation">,</span> <span class="token number">36.08745610383932</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> image_mod500 <span class="token operator">=</span> ee<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>     mod500<span class="token punctuation">.</span><span class="token function">filterDate</span><span class="token punctuation">(</span><span class="token string">'2016-05-01'</span><span class="token punctuation">,</span><span class="token string">'2016-08-30'</span>d<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span>roi<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFloat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Select the QA band</span><span class="token keyword">var</span> <span class="token constant">QA</span> <span class="token operator">=</span> image_mod500<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'StateQA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Get the cloud_state bits and find cloudy areas.</span><span class="token keyword">var</span> cloud <span class="token operator">=</span> <span class="token function">getQABits</span><span class="token punctuation">(</span><span class="token constant">QA</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'cloud_state'</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token string">"b(0) == 1 || b(0) == 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Create a mask that filters out  cloudy areas.</span><span class="token keyword">var</span> mask <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">not</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰æ˜¾ç¤ºå‚æ•°</span><span class="token keyword">var</span> visParams_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span>bands<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'sur_refl_b01'</span><span class="token punctuation">,</span><span class="token string">'sur_refl_b04'</span><span class="token punctuation">,</span><span class="token string">'sur_refl_b03'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>min<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>max<span class="token operator">:</span><span class="token number">3000</span><span class="token punctuation">,</span>gamma<span class="token operator">:</span><span class="token number">1.3</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//è½½å…¥å›¾å±‚</span>Map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>image_mod500<span class="token punctuation">.</span><span class="token function">updatemask</span><span class="token punctuation">(</span>mask<span class="token punctuation">)</span><span class="token punctuation">,</span> visParams_color<span class="token punctuation">,</span> <span class="token string">'mod500_color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.zhihu.com/people/li-shi-wei-36">çŸ¥ä¹ç”¨æˆ· <strong>æ— å½¢çš„é£</strong></a></li></ol><ol start="2"><li><a href="https://www.zhihu.com/column/c_123993183">çŸ¥ä¹ä¸“æ </a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GEE</tag>
      
      <tag>é¥æ„Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Google Earth Engine æ•™å­¦è§†é¢‘ç¬”è®°</title>
    <link href="/2019/11/30/GEE%E7%AC%94%E8%AE%B0/"/>
    <url>/2019/11/30/GEE%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Bç«™ä¸ŠGEEåŸºç¡€è§†é¢‘è¦ç‚¹ç¬”è®°</p></blockquote><span id="more"></span><h2 id="åŸºç¡€æ•°æ®ç±»å‹ï¼š"><a href="#åŸºç¡€æ•°æ®ç±»å‹ï¼š" class="headerlink" title="åŸºç¡€æ•°æ®ç±»å‹ï¼š"></a>åŸºç¡€æ•°æ®ç±»å‹ï¼š</h2><h3 id="Stringã€Number"><a href="#Stringã€Number" class="headerlink" title="Stringã€Number"></a>Stringã€Number</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee1.png/pic"></p><ul><li>åŸºç¡€è¿ç®—ï¼šæ‹¼æ¥ã€æ›¿æ¢ã€åˆ‡åˆ†</li><li>ä½è¿ç®—ç”¨äºäº‘å±‚å¤„ç†<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee2.png/pic"><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee3.png/pic"><h3 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee4.png/pic"></li><li>Add æ·»åŠ å†…å®¹ï¼ŒInsert å¯ä»¥æŒ‡å®šä½ç½®ï¼Œmapæ“ä½œæ¯”è¾ƒé‡è¦ï¼Œå¾ªç¯ä½¿ç”¨</li></ul><h2 id="ç©ºé—´æ•°æ®å¯¹è±¡ï¼š"><a href="#ç©ºé—´æ•°æ®å¯¹è±¡ï¼š" class="headerlink" title="ç©ºé—´æ•°æ®å¯¹è±¡ï¼š"></a>ç©ºé—´æ•°æ®å¯¹è±¡ï¼š</h2><h3 id="Geometry"><a href="#Geometry" class="headerlink" title="Geometry"></a>Geometry</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee5.png/pic"></p><ul><li>å®ç°ç©ºé—´åæ ‡å˜æ¢ï¼Œåœ¨<a href="https://epsg.io/">epsg</a>ç½‘ç«™æŸ¥æ‰¾epsgä»£ç å¡«å…¥å‚æ•°</li><li><code>Geometry.distance()</code>  ç”¨äºæµ‹ç®—æœ€è¿‘ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»<h3 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee6.png/pic"></li><li><code>Feature.Area()</code> æ±‚é¢ç§¯<h3 id="Feature-Collection"><a href="#Feature-Collection" class="headerlink" title="Feature Collection"></a>Feature Collection</h3></li><li> ç›¸å½“äºarcgis shpç¼–è¾‘<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee7.png/pic"></li><li> reduceToImage çŸ¢é‡è½¬æ …æ ¼<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee8.png/pic"></li><li> toLIst å˜æˆåˆ—è¡¨å…ƒç´ <br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee9.png/pic"><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3></li><li>Mask  æ©è†œæ“ä½œ  ç±»ä¼¼è£å‰ªï¼Œä½†ä¸çœŸå®åˆ é™¤å…ƒç´ <br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee10.png/pic"></li><li> <code>Clip(geometry)</code>  è£å‰ªæ“ä½œ</li><li><code>Select(â€˜bandsâ€™)</code>  æ³¢æ®µåç§°é€‰æ‹©   slice()  æŒ‰æ³¢æ®µindexé€‰æ‹©</li><li><code>Addbands()</code> åŠ æ³¢æ®µ</li><li><code>Reproject()</code>  epsg:3857 å¸¸ç”¨ç½‘ç»œåœ°å›¾åæ ‡ä»£å·</li><li>Rgb hsv è½¬æ¢</li><li><code>where()</code>é‡æ–°èµ‹å€¼  å¯¹å°äº4000çš„é‡èµ‹å€¼ä¸º0  å¯ä»¥å‰”é™¤æŸäº›å†…å®¹<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee11.png/pic"></li><li>æ•°å€¼åˆ¤æ–­ï¼Œå€¼åŸŸæˆªå–<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee12.png/pic"></li><li>è‡ªå®šä¹‰å‡½æ•°ï¼Œè®¡ç®—NDVIæ—¶å¯ç”¨<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee13.png/pic"></li><li><code>Image.derivative()</code>é«˜ç¨‹è¿›è¡Œxï¼Œ y å¾®åˆ† æ±‚å¡åº¦</li><li>çº¹ç†æå–<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee14.png/pic"></li><li>ä¸´åŸŸæ“ä½œï¼Œèšåˆæ›¿æ¢<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee15.png/pic"><h3 id="Image-Collection"><a href="#Image-Collection" class="headerlink" title="Image Collection"></a>Image Collection</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee16.png/pic"></li><li><code>Filter</code> è¾¹ç•Œã€æ—¶é—´æ®µã€æ•°æ®å±æ€§ç­›é€‰<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee17.png/pic"></li><li><code>mosaic()</code>å®ç°å¤šå›¾å åŠ ï¼Œå°†collectionå˜ä¸€å¼ imageï¼Œé‡å ä½ç½®è§„åˆ™ï¼šåé¢å–ä»£å‰é¢<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee18.png/pic"></li><li><code>Select</code> æ³¢æ®µç­›é€‰å¹¶é‡å‘½åï¼Œåªèƒ½å¯¹åŒæºæ•°æ®æ“ä½œ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee19.png/pic"></li><li>é€»è¾‘åˆ¤æ–­ï¼ŒOr è‡³å°‘ä¸€æ¬¡ï¼Œand å¤šæ¬¡<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee20.png/pic"></li><li> <code>unmixing</code>è§£å†³åŒç‰©å¼‚è°±æˆ–åŒè°±å¼‚ç‰©<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee21.png/pic"></li></ul><h2 id="å¯¹è±¡æ“ä½œ"><a href="#å¯¹è±¡æ“ä½œ" class="headerlink" title="å¯¹è±¡æ“ä½œ"></a>å¯¹è±¡æ“ä½œ</h2><h3 id="Dates"><a href="#Dates" class="headerlink" title="Dates"></a>Dates</h3><ul><li>æ—¶é—´åŸºæœ¬æ“ä½œ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee22.png/pic"></li><li>æ—¶é—´è¡¨ç¤ºæ–¹æ³•<br>ä½¿ç”¨<a href="https://www.unixtimestamp.com/"><code>Unix timestamp</code></a>è¡¨ç¤º<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee23.png/pic"></li><li>æ—¶é—´æ®µ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee24.png/pic"></li><li>æ—¶é—´æ®µåˆå¹¶union<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee25.png/pic"></li></ul><h3 id="Filters"><a href="#Filters" class="headerlink" title="Filters"></a>Filters</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee26.png/pic"></p><ul><li>ç­›é€‰å™¨æ“ä½œæ­¥éª¤ï¼š<ol><li>è·å–é›†åˆ</li><li>åˆ›å»ºç­›é€‰å™¨  f = Filter.xxxx()</li><li>å¯¹é›†åˆæ‰§è¡Œç­›é€‰å™¨ collections.filter(f)</li></ol></li><li>å†…å®¹ç­›é€‰ä¸è·å–<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee27.png/pic"></li><li>æ—¥æœŸç­›é€‰<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee28.png/pic"></li><li>ç»„åˆç­›é€‰<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee29.png/pic"><h3 id="Joins"><a href="#Joins" class="headerlink" title="Joins"></a>Joins</h3><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee30.png/pic"></li><li>å·¦è¿æ¥ï¼Œå®šä¹‰ç­›é€‰å™¨ç­›é€‰<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee31.png/pic"></li><li>å½±åƒäº§å“ç»“åˆ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee32.png/pic"></li><li>saveAll åªé“¾æ¥å±æ€§ï¼Œç±»ä¼¼ArcGIS joinä¸­å­—æ®µè¿æ¥</li><li>saveBest å‚è§guide<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee33.png/pic"></li></ul><h3 id="Reducers"><a href="#Reducers" class="headerlink" title="Reducers"></a>Reducers</h3><ul><li>ä¸»è¦ç”¨äºæ …æ ¼æ•°æ®åˆ†æ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee34.png/pic"></li><li>è®¡æ•°ï¼ŒcountEvery å¯ä»¥è®¡ç®—NA<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee35.png/pic"></li><li>Reducers  maxè¯»å–æ³¢æ®µå–æœ€å¤§ï¼Œ æˆ–è€…å¤šæ³¢æ®µä¸­ä½å€¼<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee36.png/pic"><h3 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h3></li><li>å¯¹æŸä¸€ä¸ªæ …æ ¼å‘¨å›´å…ƒç´ è¿›è¡Œæ“ä½œ<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee37.png/pic"><br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee38.png/pic"></li><li> å¯¹è±¡è¯†åˆ«ä¸è¾¹ç•Œæå–<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee39.png/pic"><br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/gee/gee40.png/pic"></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://www.bilibili.com/video/BV1Sb411p7TQ">é¥æ„Ÿå¤§æ•°æ®å¹³å° Google Earth Engine æ•™å­¦è§†é¢‘</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GEE</tag>
      
      <tag>é¥æ„Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 åæ ‡è½´è°ƒæ•´</title>
    <link href="/2019/11/23/ggplot2-Axis/"/>
    <url>/2019/11/23/ggplot2-Axis/</url>
    
    <content type="html"><![CDATA[<p>åæ ‡è½´æ˜¯ggplot2 ä¸­è°ƒæ•´è¾ƒå¤šçš„éƒ¨åˆ†ï¼Œæœ¬æ–‡ä»æ•°æ®æ˜ å°„å’Œæ ·å¼ä¸¤ä¸ªæ–¹é¢ä»‹ç»åæ ‡è½´å¸¸ç”¨è®¾ç½®ã€‚</p><h2 id="æ•°æ®æ˜ å°„"><a href="#æ•°æ®æ˜ å°„" class="headerlink" title="æ•°æ®æ˜ å°„"></a>æ•°æ®æ˜ å°„</h2><h3 id="è½´èŒƒå›´"><a href="#è½´èŒƒå›´" class="headerlink" title="è½´èŒƒå›´"></a>è½´èŒƒå›´</h3><p>å¯¹äºæ•°å€¼å½¢å¼çš„è½´ï¼Œæœ€ç®€å•çš„è®¾ç½®æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨<code>lims()</code>ç±»å‡½æ•°<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Set scale limits">[1]</span></a></sup>è®¾ç½®å€¼åŸŸå³å¯ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> lims<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>p <span class="token operator">+</span> xlim<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>p <span class="token operator">+</span> ylim<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><blockquote><p>æ³¨æ„<br><code>lims</code>ç±»æ“ä½œå¯¹åŸå§‹æ•°æ®æœ‰æ“ä½œï¼Œå‡½æ•°å…ˆæ ¹æ®èŒƒå›´è¿‡æ»¤æ•°æ®ï¼Œå†ç”Ÿæˆå›¾ã€‚è¿™å¯¹ç»Ÿè®¡ç±»å›¾å¦‚<strong>boxplot</strong>é€ æˆå¾ˆå¤§å½±å“ï¼Œç”±äºæ›´æ”¹äº†æ•°æ®ï¼Œä¼šä½¿ç”¨é”™è¯¯ç»Ÿè®¡ç»“æœç»˜å›¾ã€‚å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›çš„èŒƒå›´é™å®šæ˜¯æŒ‡å›¾åƒè£åˆ‡ï¼Œå³ç”Ÿæˆå›¾åè£åˆ‡å¤šä½™çš„ä½ç½®ï¼Œå› æ­¤å¯¹äºç»Ÿè®¡ç±»ç»˜å›¾ä½¿ç”¨<code>coord_cartesian</code>è¿›è¡Œç¼©æ”¾æ›´ä¸ºå®‰å…¨<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggplot2ä¸­ylimçš„å‘">[2]</span></a></sup>ã€‚</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> coord_cartesian<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>å¯¹äºå…¶ä»–ç±»å‹æ•°æ®ï¼Œåœ¨æŒ‡å®šèŒƒå›´çš„åŒæ—¶ï¼Œè¿˜éœ€æŒ‡å®šåæ ‡é—´éš”ï¼Œä½¿ç”¨ä»¥ä¸‹ç³»åˆ—å‡½æ•°<br><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_*_discrete</a>ï¼Œ<a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_*_continuous</a>ï¼Œ<a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_*_date</a></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># limitsæŒ‡å®šèŒƒå›´ï¼ŒbreaksæŒ‡å®šé—´éš”ï¼Œlabelså®šä¹‰æ–°çš„æ ‡è®°</span><span class="token comment"># ç¦»æ•£å‹</span>p <span class="token operator">+</span> scale_x_discrete<span class="token punctuation">(</span>limits<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># è¿ç»­å‹</span>p <span class="token operator">+</span> scale_x_continuous<span class="token punctuation">(</span>limits<span class="token punctuation">,</span> breaks<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># æ—¶é—´å‹</span>p <span class="token operator">+</span> scale_x_date<span class="token punctuation">(</span>limits<span class="token punctuation">,</span> breaks<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è½´å˜æ¢"><a href="#è½´å˜æ¢" class="headerlink" title="è½´å˜æ¢"></a>è½´å˜æ¢</h3><ul><li><p>logå˜æ¢<br>æœ‰ä¸‰ç§æ–¹å¼å®ç°å¯¹æ•°åæ ‡è½´å˜æ¢<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Position scales for continuous data (x &amp; y)">[3]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># 1.aesæˆ–æ•°æ®é›†é‡Œç›´æ¥å˜æ¢</span>ggplot<span class="token punctuation">(</span>data<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">,</span> y<span class="token operator">=</span>log10<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 2.scale_y_continuous è¿›è¡Œå˜æ¢</span>p <span class="token operator">+</span> scale_y_continuous<span class="token punctuation">(</span>trans<span class="token operator">=</span><span class="token string">"log10"</span><span class="token punctuation">,</span>        breaks<span class="token operator">=</span>trans_breaks<span class="token punctuation">(</span><span class="token string">"log10"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token number">10</span><span class="token operator">^</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>        labels<span class="token operator">=</span>trans_format<span class="token punctuation">(</span><span class="token string">"log10"</span><span class="token punctuation">,</span>math_format<span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">^</span>.x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 3.scale_y_log10 å‡½æ•°</span>p <span class="token operator">+</span> scale_y_log10<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>æ—¶é—´å˜æ¢<br>ä½¿ç”¨<code>date_labels</code>è¿›è¡Œæ—¶é—´è½¬æ¢<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="Date scale labels">[4]</span></a></sup></p><table><thead><tr class="header"><th align="left">String</th><th align="left">Meaning</th></tr></thead><tbody><tr class="odd"><td align="left"><code>%S</code></td><td align="left">second (00-59)</td></tr><tr class="even"><td align="left"><code>%M</code></td><td align="left">minute (00-59)</td></tr><tr class="odd"><td align="left"><code>%l</code></td><td align="left">hour, in 12-hour clock (1-12)</td></tr><tr class="even"><td align="left"><code>%I</code></td><td align="left">hour, in 12-hour clock (01-12)</td></tr><tr class="odd"><td align="left"><code>%p</code></td><td align="left">am/pm</td></tr><tr class="even"><td align="left"><code>%H</code></td><td align="left">hour, in 24-hour clock (00-23)</td></tr><tr class="odd"><td align="left"><code>%a</code></td><td align="left">day of week, abbreviated (Mon-Sun)</td></tr><tr class="even"><td align="left"><code>%A</code></td><td align="left">day of week, full (Monday-Sunday)</td></tr><tr class="odd"><td align="left"><code>%e</code></td><td align="left">day of month (1-31)</td></tr><tr class="even"><td align="left"><code>%d</code></td><td align="left">day of month (01-31)</td></tr><tr class="odd"><td align="left"><code>%m</code></td><td align="left">month, numeric (01-12)</td></tr><tr class="even"><td align="left"><code>%b</code></td><td align="left">month, abbreviated (Jan-Dec)</td></tr><tr class="odd"><td align="left"><code>%B</code></td><td align="left">month, full (January-December)</td></tr><tr class="even"><td align="left"><code>%y</code></td><td align="left">year, without century (00-99)</td></tr><tr class="odd"><td align="left"><code>%Y</code></td><td align="left">year, with century (0000-9999)</td></tr></tbody></table></li></ul><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> scale_x_date<span class="token punctuation">(</span>date_breaks <span class="token operator">=</span> <span class="token string">"5 years"</span><span class="token punctuation">,</span> date_labels <span class="token operator">=</span> <span class="token string">"%y"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="è½´å½¢æ€"><a href="#è½´å½¢æ€" class="headerlink" title="è½´å½¢æ€"></a>è½´å½¢æ€</h3><p>å¸¸ç”¨è½´å˜æ¢æœ‰ä»¥ä¸‹ä¸‰ç±»</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># x\yè½´è‡ªèº«ç¿»è½¬</span>p <span class="token operator">+</span> scale_<span class="token operator">*</span>_reverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># xä¸yè½´äº¤æ¢</span>p <span class="token operator">+</span> coord_flip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># è½¬æ¢æåæ ‡</span>p <span class="token operator">+</span> coord_polar<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ ·å¼"><a href="#æ ·å¼" class="headerlink" title="æ ·å¼"></a>æ ·å¼</h2><p>è½´æ ·å¼çš„å®šä¹‰åœ¨<code>theme</code>ä¸­ä»¥<strong>axis</strong>å¼€å¤´<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="GGPLOT AXIS TICKS: SET AND ROTATE TEXT LABELS">[5]</span></a></sup></p><blockquote><p><code>ticks</code>å¯¹åº”åˆ»åº¦çº¿<br><code>text</code>å¯¹åº”æ ‡ç­¾<br><code>title</code>å¯¹åº”æ ‡é¢˜<br><code>line</code>å¯¹åº”è½´çº¿</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/ggplot2-axis-ticks-example-1.png/pic"></p><h3 id="åˆ»åº¦çº¿"><a href="#åˆ»åº¦çº¿" class="headerlink" title="åˆ»åº¦çº¿"></a>åˆ»åº¦çº¿</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å…¨å±€</span>  axis.ticks <span class="token operator">=</span> element_line<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token comment"># åªæ”¹å˜xè½´     </span>  axis.ticks.x <span class="token operator">=</span> element_line<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># åªæ”¹å˜yè½´</span>  axis.ticks.y <span class="token operator">=</span> element_line<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># åˆ»åº¦çº¿é•¿åº¦</span>  axis.ticks.length <span class="token operator">=</span> unit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"pt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è½´æ ‡ç­¾"><a href="#è½´æ ‡ç­¾" class="headerlink" title="è½´æ ‡ç­¾"></a>è½´æ ‡ç­¾</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å…¨å±€</span>  axis.text <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token comment"># åªæ”¹å˜xè½´    </span>  axis.text.x <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># åªæ”¹å˜é¡¶ç«¯xè½´ï¼ˆå¦‚æœæœ‰ï¼‰</span>  axis.text.x.top <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># åªæ”¹å˜yè½´</span>  axis.text.y <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># åªæ”¹å˜å³ä¾§yè½´ï¼ˆå¦‚æœæœ‰ï¼‰</span>  axis.text.y.right <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="è½´æ ‡é¢˜"><a href="#è½´æ ‡é¢˜" class="headerlink" title="è½´æ ‡é¢˜"></a>è½´æ ‡é¢˜</h3><ul><li>å®šä¹‰æ ‡é¢˜æ ·å¼<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">axis.title.x <span class="token operator">=</span> element_text<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li>è½´æ ‡é¢˜æ—‹è½¬<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># angleå®šä¹‰æ—‹è½¬è§’åº¦</span><span class="token comment"># ç”±äºæ—‹è½¬åæ–‡å­—ä¼šä¸åæ ‡è½´å¹²æ¶‰å†²çªï¼Œå¯è®¾ç½®vjustæˆ–hjuståç§»é‡è°ƒæ•´</span>axis.title.y <span class="token operator">=</span> element_text<span class="token punctuation">(</span>angle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> vjust <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li></ul><h3 id="è½´çº¿"><a href="#è½´çº¿" class="headerlink" title="è½´çº¿"></a>è½´çº¿</h3><p>è®¾ç½®è½´çº¿å®½åº¦</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">axis.line.y <span class="token operator">=</span> element_line<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="ç§»é™¤"><a href="#ç§»é™¤" class="headerlink" title="ç§»é™¤"></a>ç§»é™¤</h3><p>å¦‚éœ€ç§»é™¤ç›¸åº”å†…å®¹</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">axis.<span class="token operator">*</span> <span class="token operator">=</span> element_blank<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/lims.html">Set scale limits</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.jianshu.com/p/312d30049a25">ggplot2ä¸­ylimçš„å‘</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">Position scales for continuous data (x &amp; y)</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://ggplot2-book.org/scale-position.html#date-labels">Date scale labels</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.datanovia.com/en/blog/ggplot-axis-ticks-set-and-rotate-text-labels/">GGPLOT AXIS TICKS: SET AND ROTATE TEXT LABELS</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 åŒåæ ‡è½´å®ç°</title>
    <link href="/2019/11/23/ggplot2-Dual-Axis/"/>
    <url>/2019/11/23/ggplot2-Dual-Axis/</url>
    
    <content type="html"><![CDATA[<p>æŒ‰ç…§ggplot2ä½œè€…çš„æ€è·¯ï¼ŒåŒyè½´ä¼šé™ä½å›¾ç‰‡çš„æ˜“è¯»æ€§ï¼Œä¸æ¨èä½¿ç”¨ï¼Œæ‰€ä»¥ggplot2æ²¡æœ‰å•ç‹¬åŒyè½´è®¾ç½®ï¼Œè¿™é‡Œæœ‰ä¸€ç³»åˆ—å…³äºåŒè½´çš„è®¨è®º<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Dual-Scaled Axes in Graphs Are They Ever the Best Solution?">[1]</span></a></sup><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="A Study on Dual-Scale Data Charts">[2]</span></a></sup>ã€‚åªèƒ½é€šè¿‡<code>scale_y_continuous()</code>ä¸<code>sec.axis</code>å±æ€§è¿‚å›å®ç°<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Specify a secondary axis">[3]</span></a></sup>ã€‚</p><h2 id="å®šä¹‰ç¬¬äºŒè½´"><a href="#å®šä¹‰ç¬¬äºŒè½´" class="headerlink" title="å®šä¹‰ç¬¬äºŒè½´"></a>å®šä¹‰ç¬¬äºŒè½´</h2><p><code>sec.axis()</code>æ˜¯<code>scale_y_continuous()</code>çš„å±æ€§ï¼Œ<code>sec.axis()</code>å¹¶éæ„å»ºå…¨æ–°çš„Yè½´ã€‚ å®ƒåªæ˜¯é€šè¿‡æ•°å­¦å˜æ¢ç”±ç¬¬ä¸€ä¸ªYè½´æ„å»ºç¬¬äºŒä¸ªYè½´ã€‚å› æ­¤å¯¹äºç¬¬äºŒè½´æ•°æ®ï¼Œåœ¨ç»˜å›¾å‰éœ€è¦å…ˆæŒ‰åˆé€‚æ¯”ä¾‹ç¼©æ”¾ï¼Œä»¥ä¿è¯ç¼©æ”¾åå€¼åŸŸåœ¨ä¸»è½´æ•°æ®å€¼åŸŸå†…ï¼Œéšåç»˜åˆ¶ç¬¬äºŒè½´å‡ ä½•å›¾å½¢<strong>geom_x</strong>ï¼Œå†é€šè¿‡<code>sec.axis()</code>é‡Œçš„<code>trans</code>è¿›è¡Œé€†è¿ç®—è¿˜åŸç¬¬äºŒè½´å®é™…æ•°å€¼æ˜¾ç¤º<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="Dual Y axis with R and ggplot2">[4]</span></a></sup>ã€‚</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å®šä¹‰ç¼©æ”¾ç³»æ•°ï¼Œç³»æ•°æ ¹æ®å·¦å³è½´çš„å€¼åŸŸæ¯”ä¾‹ç¡®å®šï¼Œæ‰¾å…¬çº¦æ•°ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ç½‘æ ¼çº¿å¯¹é½</span>coeff <span class="token operator">&lt;-</span> <span class="token number">10</span>ggplot<span class="token punctuation">(</span>data<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x<span class="token operator">=</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token comment"># ä¸»è½´å‡ ä½•å¯¹è±¡æ­£å¸¸ç»˜åˆ¶</span>  geom_line<span class="token punctuation">(</span> aes<span class="token punctuation">(</span>y<span class="token operator">=</span>temperature<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>   <span class="token comment"># ç¬¬äºŒè½´æ•°æ®åœ¨ç»˜åˆ¶å‡ ä½•å›¾å½¢æ—¶è¿›è¡Œç¼©æ”¾è‡³ä¸»è½´å€¼åŸŸ</span>  geom_line<span class="token punctuation">(</span> aes<span class="token punctuation">(</span>y<span class="token operator">=</span>price <span class="token operator">/</span> coeff<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>   scale_y_continuous<span class="token punctuation">(</span>    <span class="token comment"># è®¾ç½®ç¬¬ä¸€è½´ï¼Œå·¦ä¾§ä¸»è½´</span>    name <span class="token operator">=</span> <span class="token string">"First Axis"</span><span class="token punctuation">,</span>    <span class="token comment"># å¢åŠ å³ä¾§ç¬¬äºŒè½´ï¼Œå¹¶é€šè¿‡ç³»æ•°è¿˜åŸå€¼æ˜¾ç¤º</span>    sec.axis <span class="token operator">=</span> sec_axis<span class="token punctuation">(</span><span class="token operator">~</span>.<span class="token operator">*</span>coeff<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"Second Axis"</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/thecode3-1.png/pic"><br>è¿™é‡Œæœ‰ç›¸å…³ä¾‹å­å¯ä»¥å‚è€ƒè¾…åŠ©ç†è§£<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggplot2: Secondary Y axis">[5]</span></a></sup>ã€‚</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.perceptualedge.com/articles/visual_business_intelligence/dual-scaled_axes.pdf">Dual-Scaled Axes in Graphs Are They Ever the Best Solution?</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.lri.fr/~isenberg/publications/papers/Isenberg_2011_ASO.pdf">A Study on Dual-Scale Data Charts</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html">Specify a secondary axis</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.r-graph-gallery.com/line-chart-dual-Y-axis-ggplot2.html">Dual Y axis with R and ggplot2</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://whatalnk.github.io/r-tips/ggplot2-secondary-y-axis.nb.html">ggplot2: Secondary Y axis</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç©ºé—´ç›¸å…³æ€§</title>
    <link href="/2019/07/31/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E7%A9%BA%E9%97%B4%E7%9B%B8%E5%85%B3%E6%80%A7/"/>
    <url>/2019/07/31/%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90-%E7%A9%BA%E9%97%B4%E7%9B%B8%E5%85%B3%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<blockquote><p>The first law of geography: Everything is related to everything else, but near things are more related than distant things.<br>Waldo R. Tobler<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Tobler, Waldo R. 1970. â€œA Computer Movie Simulating Urban Growth in the Detroit Region.â€ Economic Geography 46 (2): 234â€“40.">[1]</span></a></sup></p></blockquote><p>åœ¨ç©ºé—´ç»Ÿè®¡åˆ†æä¸­ï¼Œç©ºé—´è‡ªç›¸å…³åæ˜ äº†ç ”ç©¶åŒºåŸŸå†…è¦ç´ ä¹‹é—´çš„åˆ†å¸ƒè§„å¾‹ï¼Œè¿™äº›è§„å¾‹é€šè¿‡ç©ºé—´åˆ†å¸ƒæ¨¡å¼è¿›è¡Œè¡¡é‡ï¼Œç©ºé—´åˆ†å¸ƒæ¨¡å¼ä¸»è¦æœ‰éšæœºï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ã€èšé›†ã€ç¦»æ•£ï¼ˆæ³Šæ¾åˆ†å¸ƒï¼‰ä¸‰ç±»ï¼Œè¦ç´ é—´ç©ºé—´æ¨¡å¼è®¡ç®—æ˜¯ç ”ç©¶ç©ºé—´è‡ªç›¸å…³çš„ä¸»è¦æ–¹æ³•ï¼Œç ”ç©¶è€…å¼•å…¥äº†ä¸€ç³»åˆ—æŒ‡æ ‡æ¥å®šé‡ç›¸å…³æ€§ã€‚</p><p>è«å…°æŒ‡æ•°æ˜¯ç©ºé—´è‡ªç›¸å…³ç©ºé—´åˆ†å¸ƒæ¨¡å¼å®šé‡è¯„ä»·çš„é‡è¦æŒ‡æ ‡ï¼Œè«å…°æŒ‡æ•°åˆ†ä¸ºå…¨å±€è«å…°æŒ‡æ•°ï¼ˆGlobal Moranâ€™s Iï¼‰å’Œå±€éƒ¨è«å…°æŒ‡æ•°ï¼ˆLocal Moranâ€™s Iï¼‰ï¼Œå‰è€…æ˜¯Patrick Alfred Pierce Moranå¼€å‘çš„ç©ºé—´è‡ªç›¸å…³çš„åº¦é‡ï¼›åè€…æ˜¯ç¾å›½äºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦åœ°ç†ä¸è§„åˆ’å­¦é™¢é™¢é•¿ Luc Anselin æ•™æˆåœ¨1995å¹´æå‡ºçš„ã€‚</p><h1 id="Global-Moranâ€™s-I"><a href="#Global-Moranâ€™s-I" class="headerlink" title="Global Moranâ€™s I"></a>Global Moranâ€™s I</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>åœ¨ArcGISä¸­ä½¿ç”¨<strong>ç©ºé—´è‡ªç›¸å…³Global Moranâ€™s I</strong>å·¥å…·è¿›è¡ŒæŒ‡æ•°è®¡ç®—ï¼Œè¯¥å·¥å…·é€šè¿‡è®¡ç®— Moranâ€™s I æŒ‡æ•°å€¼ã€z å¾—åˆ†å’Œ p å€¼æ¥å¯¹è¯¥æŒ‡æ•°çš„æ˜¾è‘—æ€§è¿›è¡Œè¯„ä¼°<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ç©ºé—´è‡ªç›¸å…³ (Global Moranâ€™s I) çš„å·¥ä½œåŸç†">[2]</span></a></sup>ã€‚è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š<br><img src="https://desktop.arcgis.com/zh-cn/arcmap/10.3/tools/spatial-statistics-toolbox/GUID-2089108B-3773-4558-A63E-8EE028F0A1C0-web.png"><br>è«å…°æŒ‡æ•°çš„å€¼ä¼šè¢«å½’ä¸€åŒ–åˆ° -1.0 ä¸ +1.0 ä¹‹é—´ï¼Œz å¾—åˆ†å’Œ p å€¼æ˜¯ç»Ÿè®¡æ˜¾è‘—æ€§çš„é‡åº¦ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦æ‹’ç»é›¶å‡è®¾ã€‚p å€¼è¡¨ç¤ºæ¦‚ç‡ã€‚å¯¹äºæ¨¡å¼åˆ†æå·¥å…·æ¥è¯´ï¼Œp å€¼è¡¨ç¤ºæ‰€è§‚æµ‹åˆ°çš„ç©ºé—´æ¨¡å¼æ˜¯ç”±æŸä¸€éšæœºè¿‡ç¨‹åˆ›å»ºè€Œæˆçš„æ¦‚ç‡ã€‚å½“ p å¾ˆå°æ—¶ï¼Œæ„å‘³ç€æ‰€è§‚æµ‹åˆ°çš„ç©ºé—´æ¨¡å¼ä¸å¤ªå¯èƒ½äº§ç”Ÿäºéšæœºè¿‡ç¨‹(å°æ¦‚ç‡äº‹ä»¶)ï¼Œå› æ­¤å¯ä»¥æ‹’ç»é›¶å‡è®¾ã€‚Z å¾—åˆ†è¡¨ç¤ºæ ‡å‡†å·®çš„å€æ•°ã€‚ä½¿ç”¨ z å¾—åˆ†æˆ– p å€¼æŒ‡ç¤ºç»Ÿè®¡æ˜¾è‘—æ€§æ—¶ï¼Œ<code>Moran&#39;s I &gt; 0</code>è¡¨ç¤ºç©ºé—´æ­£ç›¸å…³æ€§ï¼Œå…¶å€¼è¶Šå¤§ï¼Œç©ºé—´ç›¸å…³æ€§è¶Šæ˜æ˜¾ï¼Œ<code>Moran&#39;s I &lt; 0</code>è¡¨ç¤ºç©ºé—´è´Ÿç›¸å…³æ€§ï¼Œå…¶å€¼è¶Šå°ï¼Œç©ºé—´å·®å¼‚è¶Šå¤§ï¼Œå¦åˆ™ï¼Œ<code>Moran&#39;s I = 0</code>ï¼Œç©ºé—´å‘ˆéšæœºæ€§ã€‚</p><h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><p>ç‰ˆæœ¬: ArcGIS 10.5</p><h3 id="å·¥å…·ä½ç½®"><a href="#å·¥å…·ä½ç½®" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/GlobalMoranTool.jpg/pic"></p><h3 id="å‚æ•°è®¾ç½®"><a href="#å‚æ•°è®¾ç½®" class="headerlink" title="å‚æ•°è®¾ç½®"></a>å‚æ•°è®¾ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/GlobalMoranWindows.jpg/pic"><br>ä½¿ç”¨æ—¶ï¼Œå‹¾é€‰<code>Generate Report</code>ï¼Œå¯ä»¥ç”Ÿæˆhtml æŠ¥è¡¨æ–‡ä»¶<br><code>Distance Method</code>åŒ…æ‹¬æ¬§æ°è·ç¦»å’Œæ›¼å“ˆé¡¿è·ç¦»ï¼Œæ ¹æ®ä¸åŒè¦ç´ ç±»å‹è¿›è¡Œé€‰æ‹©<br><code>Conceptualization of Spatial Relationships</code>æ¨èé€‰æ‹©<code>CONTIGUITY_EDGES_CORNERS</code>ï¼Œä¹Ÿå°±æ˜¯Queenâ€™s Caseï¼Œå…±è¾¹å…±ç‚¹éƒ½è¢«è§†ä¸ºé‚»æ¥è¦ç´ <sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="å†è°ˆè«å…°æŒ‡æ•°ï¼ˆMoranâ€™s Iï¼‰">[3]</span></a></sup>ï¼Œæ›´å¤šç©ºé—´å…³ç³»å¯å‚è€ƒ<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="GLOBAL VS LOCAL SPATIAL AUTOCORRELATION">[4]</span></a></sup><br>æœ‰æ—¶è«å…°æŒ‡æ•°è®¡ç®—ç»“æœè¶…å‡º[-1ï¼Œ1]èŒƒå›´ï¼Œäº§ç”ŸåŸå› å¦‚ä¸‹<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="ç™½è¯ç©ºé—´ç»Ÿè®¡ä¹‹ï¼šMoranâ€™s Iï¼ˆè«å…°æŒ‡æ•°ï¼‰">[5]</span></a></sup>ï¼š</p><ol><li>è¾“å…¥çš„æ•°æ®ä¸¥é‡åæ–œï¼ˆåˆ›å»ºæ•°æ®å€¼çš„ç›´æ–¹å›¾å¯äº†è§£æ­¤æƒ…å†µï¼‰ï¼Œç©ºé—´å…³ç³»çš„æ¦‚å¿µåŒ–æˆ–è·ç¦»èŒƒå›´çš„è®¾ç½®ä½¿å¾—æŸäº›è¦ç´ çš„ç›¸é‚»è¦ç´ éå¸¸å°‘ã€‚Global Moranâ€™s I ç»Ÿè®¡é‡æ˜¯æ¸è¿›æ­£æ€çš„ï¼Œè¿™æ„å‘³ç€ï¼Œå¯¹äºåæ–œæ•°æ®ï¼Œæ¯ä¸ªè¦ç´ è‡³å°‘éœ€è¦å…·æœ‰ 8 ä¸ªç›¸é‚»è¦ç´ ã€‚ä¸ºè·ç¦»èŒƒå›´æˆ–è·ç¦»é˜ˆå€¼å‚æ•°è®¡ç®—çš„é»˜è®¤å€¼å¯ç¡®ä¿æ¯ä¸ªè¦ç´ è‡³å°‘å…·æœ‰ 1 ä¸ªç›¸é‚»è¦ç´ ï¼Œä½†è¿™å¯èƒ½ä¸å¤Ÿï¼Œå°¤å…¶æ˜¯åœ¨è¾“å…¥æ•°æ®ä¸­çš„æœ‰çš„å€¼å‡ºç°ä¸¥é‡åæ–œæ—¶ã€‚</li><li>ä½¿ç”¨åè·ç¦»ç©ºé—´å…³ç³»çš„æ¦‚å¿µåŒ–ï¼Œåœ¨é€‰æ‹©åè·ç¦»çš„å¹‚çš„æ—¶å€™ï¼Œä¸ºäº†çªå‡ºæ‹‰ä¼¸ï¼Œé€‰æ‹©äº†ä¸€ä¸ªè¿‡é«˜çš„å¹‚ï¼Œè¿™æ ·å°±ä¼šæŠŠåè·ç¦»ï¼ˆè·ç¦»çš„å€’æ•°ï¼‰å˜å¾—éå¸¸çš„å°ã€‚</li><li>æœªé€‰æ‹©è¡Œæ ‡å‡†åŒ–ï¼Œä½†åº”é€‰æ‹©ã€‚é™¤éèšåˆæ–¹æ¡ˆä¸æ‰€åˆ†æçš„å­—æ®µç›´æ¥ç›¸å…³ï¼Œå¦åˆ™ï¼Œåªè¦å¯¹æ•°æ®è¿›è¡Œäº†èšåˆå¤„ç†ï¼Œå°±åº”é€‰æ‹©è¡Œæ ‡å‡†åŒ–ã€‚</li></ol><p>å› æ­¤æ ¹æ®å®é™…æ•°æ®æƒ…å†µï¼Œåˆç†è°ƒæ•´å„é¡¹è®¾ç½®ååˆ†é‡è¦ã€‚</p><h3 id="ç»“æœæå–"><a href="#ç»“æœæå–" class="headerlink" title="ç»“æœæå–"></a>ç»“æœæå–</h3><p>å½“é€‰æ‹©è¾“å‡ºhtmlæŠ¥è¡¨ï¼Œå¦‚æœç»“æœè¾ƒå¤šï¼Œå¯ä½¿ç”¨ä»£ç æ‰¹é‡æå–æŠ¥è¡¨ä¸­çš„å€¼ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> os<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token comment"># éå†æŠ¥è¡¨ç›®å½•ï¼Œè·å–æ–‡ä»¶åˆ—è¡¨</span>file_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">r'D:\html'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># è§£æhtmlæ–‡ä»¶</span><span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>      html_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:/html/'</span> <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html_file<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>    table <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">)</span>    tab <span class="token operator">=</span> table<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    tab2 <span class="token operator">=</span> table<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    tds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>           <span class="token keyword">for</span> tr <span class="token keyword">in</span> tab<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> td <span class="token keyword">in</span> tr<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>td<span class="token punctuation">.</span>getText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> tr <span class="token keyword">in</span> tab2<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> td <span class="token keyword">in</span> tr<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>td<span class="token punctuation">.</span>getText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment"># æå–è¿½åŠ å…³é”®å­—æ®µ        </span>    data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            <span class="token string">'Moran\'s I index'</span><span class="token punctuation">:</span> tds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token string">'z-score'</span><span class="token punctuation">:</span> tds<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token string">'p-value'</span><span class="token punctuation">:</span> tds<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token string">'file name'</span><span class="token punctuation">:</span> tds<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token string">'hour'</span><span class="token punctuation">:</span> tds<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment"># æ±‡æ€»ç»“æœ</span>results <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="Anselin-Local-Moranâ€™s-I"><a href="#Anselin-Local-Moranâ€™s-I" class="headerlink" title="Anselin Local Moranâ€™s I"></a>Anselin Local Moranâ€™s I</h1><h2 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>ç›¸æ¯”äºå…¨å±€è«å…°æŒ‡æ•°ï¼ŒLocal Moranâ€™s Iæ›´åå‘äºè¯†åˆ«å±€éƒ¨è‡ªç›¸å…³ç°è±¡<sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="Spatial Autocorrelation">[6]</span></a></sup>ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„ç©ºé—´ç»Ÿè®¡å·¥å…·ã€‚ArcGISä¸­é€šè¿‡<strong>èšç±»å’Œå¼‚å¸¸å€¼åˆ†æ Anselin Local Moranâ€™s I</strong>å®ç°ï¼Œè¯¥å·¥å…·è®¡ç®— local Moranâ€™s I å€¼ã€z å¾—åˆ†ã€ä¼ª p å€¼å’Œè¡¨ç¤ºæ¯ä¸ªå…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§çš„è¦ç´ çš„èšç±»ç±»å‹çš„ç¼–ç ã€‚z å¾—åˆ†å’Œä¼ª p å€¼è¡¨ç¤ºè®¡ç®—å‡ºçš„æŒ‡æ•°å€¼çš„ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š<br><img src="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/GUID-3638FD3C-9405-4A52-A3DE-5F209866C306-web.png"></p><p>ArcGIS å¯¹äºç©ºé—´æ¨¡å¼ç¼–ç çš„è¾“å‡ºå­—æ®µä¸ºCOType(clustering /  outlier Type), å®ƒè¡¨ç¤ºå…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§çš„é«˜å€¼ (HH) èšç±»ã€ä½å€¼ (LL) èšç±»ã€é«˜å€¼ä¸»è¦ç”±ä½å€¼å›´ç»•çš„å¼‚å¸¸å€¼ (HL) ä»¥åŠä½å€¼ä¸»è¦ç”±é«˜å€¼å›´ç»•çš„å¼‚å¸¸å€¼ (LH)ã€‚è¿™äº›æ¨¡å¼çš„åˆ¤æ–­ä¾æ®å‚è§è®ºæ–‡<sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="Anselin, Luc. Local Indicators of Spatial Associationâ€”LISA. Geographical Analysis 27(2): 93â€“115, 1995.">[8]</span></a></sup>ï¼Œç®€å•ç†è§£å¯å‚è€ƒæ­¤å›¾<sup id="fnref:9" class="footnote-ref"><a href="#fn:9" rel="footnote"><span class="hint--top hint--rounded" aria-label="Anselin Local Moranâ€™s I: èšç±»å’Œå¼‚å¸¸å€¼åˆ†æ">[9]</span></a></sup>ï¼š<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/Anselin.jpg"></p><h2 id="ä½¿ç”¨æ–¹å¼-1"><a href="#ä½¿ç”¨æ–¹å¼-1" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><p>ç‰ˆæœ¬: ArcGIS 10.5</p><h3 id="å·¥å…·ä½ç½®-1"><a href="#å·¥å…·ä½ç½®-1" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/LocalMoranTool.jpg/pic"></p><h3 id="å‚æ•°è®¾ç½®-1"><a href="#å‚æ•°è®¾ç½®-1" class="headerlink" title="å‚æ•°è®¾ç½®"></a>å‚æ•°è®¾ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/LocalMoranWindows.jpg/pic"><br>å‚æ•°é€‰å®šä¸<strong>Global Moranâ€™s I</strong>ç±»ä¼¼ï¼Œå·¥å…·è¾“å‡ºä¸ºåŒ…å«ç©ºé—´æ¨¡å¼ç¼–ç çš„å›¾å±‚ï¼Œå¹¶æœ‰é¢„è®¾æ¸²æŸ“æ•ˆæœã€‚</p><h1 id="Getis-Ord-Gi"><a href="#Getis-Ord-Gi" class="headerlink" title="Getis-Ord Gi*"></a>Getis-Ord Gi*</h1><h2 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>çƒ­ç‚¹åˆ†æï¼ˆGetis-Ord Gi* ï¼‰å·¥å…·çš„å®ç°åŸç†æºäºGetis and Ord ï¼ˆ1992ï¼‰ï¼Œå®ƒè¾“å‡ºç»“æœç”¨äºæŒ‡ç¤ºç»Ÿè®¡å­¦ä¸Šæ˜¾è‘—çš„çƒ­ç‚¹ã€‚è¦æˆä¸ºå…·æœ‰æ˜¾è‘—ç»Ÿè®¡å­¦æ„ä¹‰çš„çƒ­ç‚¹ï¼Œè¦ç´ åº”å…·æœ‰é«˜å€¼ï¼Œä¸”è¢«å…¶ä»–åŒæ ·å…·æœ‰é«˜å€¼çš„è¦ç´ æ‰€åŒ…å›´ã€‚çƒ­ç‚¹åˆ†æå·¥å…·å¯å¯¹æ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªè¦ç´ è®¡ç®—Getis-Ord Gi* ã€‚é€šè¿‡å¾—åˆ°çš„z å¾—åˆ†å’Œp å€¼ï¼Œå¯ä»¥çŸ¥é“é«˜å€¼æˆ–ä½å€¼è¦ç´ åœ¨ç©ºé—´ä¸Šå‘ç”Ÿèšç±»çš„ä½ç½®ã€‚å¯¹äºå…·æœ‰æ˜¾è‘—ç»Ÿè®¡å­¦æ„ä¹‰çš„æ­£çš„z å¾—åˆ†ï¼Œz å¾—åˆ†è¶Šé«˜ï¼Œé«˜å€¼ï¼ˆçƒ­ç‚¹ï¼‰çš„èšç±»å°±è¶Šç´§å¯†ã€‚å¯¹äºç»Ÿè®¡å­¦ä¸Šçš„æ˜¾è‘—æ€§è´Ÿz å¾—åˆ†ï¼Œz å¾—åˆ†è¶Šä½ï¼Œä½å€¼ï¼ˆå†·ç‚¹ï¼‰çš„èšç±»å°±è¶Šç´§å¯†ã€‚è®¡ç®—æ–¹å¼å¦‚ä¸‹<sup id="fnref:10" class="footnote-ref"><a href="#fn:10" rel="footnote"><span class="hint--top hint--rounded" aria-label="çƒ­ç‚¹åˆ†æ (Getis-Ord Gi*) çš„å·¥ä½œåŸç†">[10]</span></a></sup>ï¼š<br><img src="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/GUID-AEFD71B5-BE33-42AB-84FB-AEE3FD5E2114-web.png"></p><h2 id="ä½¿ç”¨æ–¹å¼-2"><a href="#ä½¿ç”¨æ–¹å¼-2" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><p>ç‰ˆæœ¬: ArcGIS 10.5</p><h3 id="å·¥å…·ä½ç½®-2"><a href="#å·¥å…·ä½ç½®-2" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/GetisTool.jpg/pic"></p><h3 id="å‚æ•°è®¾ç½®-2"><a href="#å‚æ•°è®¾ç½®-2" class="headerlink" title="å‚æ•°è®¾ç½®"></a>å‚æ•°è®¾ç½®</h3><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/GetisWindows.jpg/pic"><br><code>Conceptualization of Spatial Relationships</code>æ¨èé€‰æ‹©â€œå›ºå®šè·ç¦»èŒƒå›´â€<br>å¯¹äºç‚¹äº‹ä»¶æ•°æ®ï¼Œå¦‚éœ€è¯„ä¼°äº‹ä»¶çš„ç‚¹å¯†åº¦ï¼Œéœ€è¦åœ¨åˆ†æå‰å¯¹äº‹ä»¶ç‚¹æ•°æ®è¿›è¡Œèšåˆï¼Œæ–¹æ³•ä¸»è¦ä¸ºç©ºé—´è¿æ¥ï¼š<br><img src="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/GUID-D66FFAA9-4DA8-4883-960F-A807F32CF89D-web.png"></p><p>çƒ­ç‚¹åˆ†æ (Getis-Ord Gi*) å·¥å…·ä¹Ÿæ˜¯æŸ¥æ‰¾çƒ­ç‚¹å’Œå†·ç‚¹ä½ç½®çš„æœ‰æ•ˆå·¥å…·ã€‚ä½†æ˜¯ï¼Œåªæœ‰èšç±»å’Œå¼‚å¸¸å€¼åˆ†æ (Anselin Local Moranâ€™s I) å·¥å…·å¯ä»¥è¯†åˆ«å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§çš„ç©ºé—´å¼‚å¸¸å€¼ï¼ˆé«˜å€¼ç”±ä½å€¼å›´ç»•æˆ–ä½å€¼ç”±é«˜å€¼å›´ç»•ï¼‰ã€‚<a href="https://www.zhihu.com/people/daxialu">è™¾ç¥è¯´D</a> å¯¹è¿™ä¸¤ç±»æ–¹æ³•åšäº†è¯¦ç»†å¯¹æ¯”æ€»ç»“ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/LocalandGetis.jpg"></p><p>ç°åœ¨è§åˆ°çš„è¾ƒå¤šçš„â€œçƒ­åŠ›å›¾â€å…¶å®æ˜¯ä¸€ç§å¯†åº¦åˆ†æç»“æœï¼Œè¿™ç§æ–¹å¼å•çº¯çš„æŒ‰ç…§æ•°æ®çš„å¤šå°‘ï¼Œæ¥è¿›è¡Œèšé›†ï¼Œè€Œä¸å»è€ƒè™‘æƒé‡ã€ç©ºé—´å…³ç³»ç­‰å†…å®¹ï¼Œä¸ä»¥ä¸Šç»Ÿè®¡å­¦çš„çƒ­ç‚¹åˆ†ææ˜¯ä¸åŒçš„ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä»¥ä¸Šå¸¸ç”¨ç©ºé—´ç›¸å…³æ€§åˆ†ææ–¹æ³•å¯ä»¥è¾ƒå¥½è¯†åˆ«å¹¶å®šä¹‰å…·æœ‰ç»Ÿè®¡å­¦æ„ä¹‰çš„ç©ºé—´æ¨¡å¼ï¼Œæ˜¯ç ”ç©¶åˆ†æä¸­ç©ºé—´è§„å¾‹åˆæ¢çš„å¥½å·¥å…·ï¼Œéšç€ç ”ç©¶çš„æ·±å…¥ï¼Œç°åœ¨ç©ºé—´ç›¸å…³æ€§é€šå¸¸ä¹Ÿä¸æ—¶é—´ç›¸å…³æ€§è”åˆè€ƒè™‘ï¼Œè¿™äº›ä¼ ç»Ÿç©ºé—´åˆ†ææŒ‡æ ‡è¿˜å­˜åœ¨æ›´å¤šä¼˜åŒ–æ‹“å±•ç©ºé—´ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://www.geog.ucsb.edu/~tobler/publications/pdf_docs/A-Computer-Movie.pdf">Tobler, Waldo R. 1970. â€œA Computer Movie Simulating Urban Growth in the Detroit Region.â€ Economic Geography 46 (2): 234â€“40.</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/h-how-spatial-autocorrelation-moran-s-i-spatial-st.htm">ç©ºé—´è‡ªç›¸å…³ (Global Moranâ€™s I) çš„å·¥ä½œåŸç†</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://blog.csdn.net/allenlu2008/article/details/50896262">å†è°ˆè«å…°æŒ‡æ•°ï¼ˆMoranâ€™s Iï¼‰</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://storymaps.arcgis.com/stories/5b26f25bb81a437b89003423505e2f71">GLOBAL VS LOCAL SPATIAL AUTOCORRELATION</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://blog.csdn.net/allenlu2008/article/details/47130353">ç™½è¯ç©ºé—´ç»Ÿè®¡ä¹‹ï¼šMoranâ€™s Iï¼ˆè«å…°æŒ‡æ•°ï¼‰</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://mgimond.github.io/Spatial/spatial-autocorrelation.html#ref-Tobler1970">Spatial Autocorrelation</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/h-how-cluster-and-outlier-analysis-anselin-local-m.htm">èšç±»å’Œå¼‚å¸¸å€¼åˆ†æ (Anselin Local Moranâ€™s I)çš„å·¥ä½œåŸç†</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="http://isites.harvard.edu/fs/docs/icb.topic868440.files/Anselin1995%20LISA.pdf">Anselin, Luc. Local Indicators of Spatial Associationâ€”LISA. Geographical Analysis 27(2): 93â€“115, 1995.</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:9" class="footnote-text"><span><a href="https://blog.csdn.net/allenlu2008/article/details/103028990/?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-0&spm=1001.2101.3001.4242">Anselin Local Moranâ€™s I: èšç±»å’Œå¼‚å¸¸å€¼åˆ†æ</a><a href="#fnref:9" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:10" class="footnote-text"><span><a href="https://pro.arcgis.com/zh-cn/pro-app/latest/tool-reference/spatial-statistics/h-how-hot-spot-analysis-getis-ord-gi-spatial-stati.htm">çƒ­ç‚¹åˆ†æ (Getis-Ord Gi*) çš„å·¥ä½œåŸç†</a><a href="#fnref:10" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>ç©ºé—´åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS ä¸Šä¸‹è§’æ ‡</title>
    <link href="/2019/07/07/ArcGIS-%E4%B8%8A%E4%B8%8B%E8%A7%92%E6%A0%87/"/>
    <url>/2019/07/07/ArcGIS-%E4%B8%8A%E4%B8%8B%E8%A7%92%E6%A0%87/</url>
    
    <content type="html"><![CDATA[<p>ç»˜åˆ¶ä¸“é¢˜å›¾æ—¶ï¼ŒLegendæˆ–Titleéƒ¨åˆ†å­˜åœ¨ä¸Šä¸‹æ ‡ã€‚</p><span id="more"></span><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>ArcGISæ ‡æ³¨ç³»ç»Ÿæ”¯æŒç±»htmlæ ‡ç­¾ï¼Œç›´æ¥åœ¨æ–‡æœ¬è®¾ç½®ä¸­å¡«å…¥å¯¹åº”è§’æ ‡å³å¯ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/Arcgis_%E8%A7%92%E6%A0%87.jpg/pic" alt="ä¸Šä¸‹æ ‡"></p><h3 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h3><p>å…¶ä»–å—æ”¯æŒçš„æ ‡ç­¾å¦‚ä¸‹</p><table><thead>  <tr>    <th>å…ƒç´ æè¿°</th>    <th>èµ·å§‹æ ‡ç­¾</th>    <th>ç»“æŸæ ‡ç­¾</th>    <th>æœ‰æ•ˆçš„å±æ€§å€¼</th>    <th>å¤‡æ³¨</th>  </tr></thead><tbody>  <tr>    <td>å­—ä½“åç§°å’Œ/æˆ–å­—å·</td>    <td>&lt;FNT&gt;</td>    <td>&lt;/FNT&gt;</td>    <td>name = {TrueType font} size = {1} scale = {1-}</td>    <td>è®¾ç½®åç§°ã€å¤§å°å’Œæ¯”ä¾‹ï¼Œæˆ–å…¨éƒ¨è®¾ç½®ã€‚</td>  </tr>  <tr>    <td>é¢œè‰²(RGB)</td>    <td>&lt;CLR&gt;</td>    <td>&lt;/CLR&gt;</td>    <td>red, green, blue = {0-255}</td>    <td>ç¼ºå¤±çš„é¢œè‰²å±æ€§å‡å®šä¸º 0</td>  </tr>  <tr>    <td>é¢œè‰² (CMYK)</td>    <td>&lt;CLR&gt;</td>    <td>&lt;/CLR&gt;</td>    <td>cyan, magenta, yellow, black = {0-100}</td>    <td>ç¼ºå¤±çš„é¢œè‰²å±æ€§å‡å®šä¸º 0</td>  </tr>  <tr>    <td>ç²—ä½“</td>    <td>&lt;BOL&gt;</td>    <td>&lt;/BOL&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>æ–œä½“</td>    <td>&lt;ITA&gt;</td>    <td>&lt;/ITA&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸‹åˆ’çº¿</td>    <td>&lt;UND&gt;</td>    <td>&lt;/UND&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>å…¨éƒ¨å¤§å†™</td>    <td>&lt;ACP&gt;</td>    <td>&lt;/ACP&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>å°å‹å¤§å†™å­—æ¯</td>    <td>&lt;SCP&gt;</td>    <td>&lt;/SCP&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸Šæ ‡</td>    <td>&lt;SUP&gt;</td>    <td>&lt;/SUP&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸‹æ ‡</td>    <td>&lt;SUB&gt;</td>    <td>&lt;/SUB&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>å­—ç¬¦é—´è·</td>    <td>&lt;CHR&gt;</td>    <td>&lt;/CHR&gt;</td>    <td>spacing = {1-}</td>    <td>è¡¨ç¤ºç›¸å¯¹äºå¸¸è§„å­—ç¬¦é—´è·çš„è°ƒæ•´ç™¾åˆ†æ¯”ï¼›0% è¡¨ç¤ºæ²¡æœ‰è°ƒæ•´ã€‚</td>  </tr>  <tr>    <td>å­—ç¬¦å®½åº¦</td>    <td>&lt;CHR&gt;</td>    <td>&lt;/CHR&gt;</td>    <td> </td>    <td>è¡¨ç¤ºç›¸å¯¹äºå¸¸è§„å­—ç¬¦å®½åº¦çš„è°ƒæ•´ç™¾åˆ†æ¯”ï¼›0% è¡¨ç¤ºæ²¡æœ‰è°ƒæ•´ã€‚</td>  </tr>  <tr>    <td>è¯é—´è·</td>    <td>&lt;WRD&gt;</td>    <td>&lt;/WRD&gt;</td>    <td>spacing = {1-}</td>    <td>è¡¨ç¤ºè¯é—´çš„é—´è·ç™¾åˆ†æ¯”ï¼›100% è¡¨ç¤ºå¸¸è§„é—´è·ã€‚</td>  </tr>  <tr>    <td>è¡Œé—´è·</td>    <td>&lt;LIN&gt;</td>    <td>&lt;/LIN&gt;</td>    <td>leading = {1-}</td>    <td>è¡¨ç¤ºç›¸å¯¹äºå¸¸è§„è¡Œé—´è·çš„è°ƒæ•´ï¼ˆå•ä½ä¸ºç£…ï¼‰ï¼›0 ç£…è¡¨ç¤ºæ²¡æœ‰è°ƒæ•´ã€‚</td>  </tr>  <tr>    <td>ä¸åŠ ç²—</td>    <td>&lt;_BOL&gt;</td>    <td>&lt;/BOL&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸å€¾æ–œ</td>    <td>&lt;_ITA&gt;</td>    <td>&lt;/_ITA&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸åŠ ä¸‹åˆ’çº¿</td>    <td>&lt;_UND&gt;</td>    <td>&lt;/_UND&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸åŠ ä¸Šæ ‡</td>    <td>&lt;_SUP&gt;</td>    <td>&lt;/_SUP&gt;</td>    <td>æ— </td>    <td> </td>  </tr>  <tr>    <td>ä¸åŠ ä¸‹æ ‡</td>    <td>&lt;_SUB&gt;</td>    <td>&lt;/_SUB&gt;</td>    <td>æ— </td>    <td> </td>  </tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>ArcGIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>è§’æ ‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 åˆ†é¢ç»˜å›¾</title>
    <link href="/2019/07/03/ggplot2-Facet/"/>
    <url>/2019/07/03/ggplot2-Facet/</url>
    
    <content type="html"><![CDATA[<p>ä¸»è¦ä»‹ç»ggplot2é‡ŒFacettingä½¿ç”¨è¦ç‚¹ã€‚</p><p><code>Facetting</code>ç”¨äºå°†å›¾ä»¥é¢æ¿çŸ©é˜µçš„å½¢å¼åˆ†æˆå¤šä¸ªå­å›¾è¿›è¡Œç»˜åˆ¶ï¼Œä¸»è¦é€šè¿‡ä»¥ä¸‹å‡½æ•°å®ç°<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Facetting">[1]</span></a></sup>ã€‚</p><ul><li><code>facet_grid()</code></li><li><code>facet_wrap()</code></li></ul><p>ä¸€äº›å¸¸è§„è®¾ç½®å‚è€ƒæ­¤æ–‡<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggplot2 facet : split a plot into a matrix of panels">[2]</span></a></sup>ï¼Œä¸‹é¢æ˜¯æˆ‘ä½¿ç”¨æ—¶è°ƒæ•´çš„ä¸€äº›å†…å®¹ã€‚</p><h2 id="é¢æ¿æ ‡ç­¾æ¨¡å—è®¾ç½®"><a href="#é¢æ¿æ ‡ç­¾æ¨¡å—è®¾ç½®" class="headerlink" title="é¢æ¿æ ‡ç­¾æ¨¡å—è®¾ç½®"></a>é¢æ¿æ ‡ç­¾æ¨¡å—è®¾ç½®</h2><h3 id="Labelæ›¿æ¢"><a href="#Labelæ›¿æ¢" class="headerlink" title="Labelæ›¿æ¢"></a>Labelæ›¿æ¢</h3><p>è¿™éƒ¨åˆ†å†…å®¹åœ¨<code>facet_grid/warp()</code>é‡Œè°ƒæ•´<br>  <div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># æ„é€ æ›¿æ¢å­—å…¸</span><span class="token comment"># æ–°label</span>supp.labs <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"Orange Juice"</span><span class="token punctuation">,</span> <span class="token string">"Vitamin C"</span><span class="token punctuation">)</span><span class="token comment"># åŸlabel</span>names<span class="token punctuation">(</span>supp.labs<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"OJ"</span><span class="token punctuation">,</span> <span class="token string">"VC"</span><span class="token punctuation">)</span><span class="token comment"># åœ¨labellerä¸­è¿›è¡Œæ›¿æ¢</span>p <span class="token operator">+</span> facet_grid<span class="token punctuation">(</span>  . <span class="token operator">~</span> supp<span class="token punctuation">,</span>   labeller <span class="token operator">=</span> labeller<span class="token punctuation">(</span>supp <span class="token operator">=</span> supp.labs<span class="token punctuation">)</span>  <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><h3 id="å­—ä½“åŠèƒŒæ™¯è‰²"><a href="#å­—ä½“åŠèƒŒæ™¯è‰²" class="headerlink" title="å­—ä½“åŠèƒŒæ™¯è‰²"></a>å­—ä½“åŠèƒŒæ™¯è‰²</h3><p>è¿™éƒ¨åˆ†åœ¨<code>theme()</code>é‡Œè°ƒæ•´ï¼Œä¸åˆ†é¢ç›¸å…³çš„å±æ€§ä»¥<strong>strip</strong>å¼€å¤´ã€‚<br>  <div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">theme<span class="token punctuation">(</span>     <span class="token comment"># æ–‡å­—æ ·å¼è°ƒæ•´</span>     strip.text.x <span class="token operator">=</span> element_text<span class="token punctuation">(</span>     size <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> face <span class="token operator">=</span> <span class="token string">"bold.italic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token comment"># æ ‡ç­¾èƒŒæ™¯è‰²è°ƒæ•´ï¼Œfillè¡¨ç¤ºå¡«å……è‰²ï¼Œcolorè¡¨ç¤ºè¾¹æ¡†é¢œè‰²</span>     strip.background <span class="token operator">=</span> element_rect<span class="token punctuation">(</span>     color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token string">"#FC4E07"</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> linetype<span class="token operator">=</span><span class="token string">"solid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><h3 id="ä¸ºä¸åŒå­å›¾å¢åŠ æ ‡æ³¨"><a href="#ä¸ºä¸åŒå­å›¾å¢åŠ æ ‡æ³¨" class="headerlink" title="ä¸ºä¸åŒå­å›¾å¢åŠ æ ‡æ³¨"></a>ä¸ºä¸åŒå­å›¾å¢åŠ æ ‡æ³¨</h3><p>ä»<code>facet_</code>å®ç°è€ƒè™‘ï¼Œåˆ†é¡µå­—æ®µå¯ä»¥çœ‹ä½œå­å›¾ç´¢å¼•ï¼ˆäºŒç»´ï¼‰ï¼Œå› æ­¤é€šè¿‡åˆ›å»ºåŒ…å«åˆ†é¡µå­—æ®µçš„æ ‡æ³¨å­æ•°æ®é›†ï¼Œåœ¨ç»˜å›¾æ—¶å°±å¯ä»¥åœ¨æŒ‡å®šå­å›¾ä¸ŠåŠ å…¥ç‰¹å®šæ ‡æ³¨<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Adding different annotation to each facet in ggplot">[3]</span></a></sup>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># è½½å…¥åŒ…</span>library<span class="token punctuation">(</span>ggplot2<span class="token punctuation">)</span>library<span class="token punctuation">(</span>Rmisc<span class="token punctuation">)</span><span class="token comment"># è½½å…¥æ•°æ®</span>butter <span class="token operator">&lt;-</span> read.table<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token comment"># summaryæ•°æ®</span>buttersum <span class="token operator">&lt;-</span> summarySE<span class="token punctuation">(</span>data <span class="token operator">=</span> butter<span class="token punctuation">,</span> measurevar <span class="token operator">=</span> <span class="token string">"winglen"</span><span class="token punctuation">,</span>                      groupvars <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"spp"</span><span class="token punctuation">,</span> <span class="token string">"sex"</span><span class="token punctuation">,</span> <span class="token string">"region"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ä¸ºæ ‡æ³¨åˆ›å»ºæ•°æ®é›†ï¼ŒåŒ…å«regionè¿™ä¸ªåˆ†é¢å­—æ®µï¼Œè¿™ä¸€æ­¥æ˜¯å…³é”®</span>anno <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>x1 <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1.75</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x2 <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2.25</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    y1 <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y2 <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    xstar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ystar <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   lab <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"***"</span><span class="token punctuation">,</span> <span class="token string">"**"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                   region <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"North"</span><span class="token punctuation">,</span> <span class="token string">"South"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>æ ‡æ³¨å½¢æ€å¦‚ä¸‹<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/diag2-14.png"></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># ç»˜åˆ¶å›¾åƒï¼Œé€‰æ‹©regionä½œä¸ºåˆ†é¢</span>ggplot<span class="token punctuation">(</span>data <span class="token operator">=</span> buttersum<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> spp<span class="token punctuation">,</span> y <span class="token operator">=</span> winglen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_point<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>shape <span class="token operator">=</span> sex<span class="token punctuation">)</span><span class="token punctuation">,</span> position <span class="token operator">=</span> position_dodge<span class="token punctuation">(</span>width <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>  scale_shape_manual<span class="token punctuation">(</span>values <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"Female"</span><span class="token punctuation">,</span> <span class="token string">"Male"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>  geom_errorbar<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>group <span class="token operator">=</span> sex<span class="token punctuation">,</span> ymin <span class="token operator">=</span> winglen <span class="token operator">-</span> se<span class="token punctuation">,</span> ymax <span class="token operator">=</span> winglen <span class="token operator">+</span> se<span class="token punctuation">)</span><span class="token punctuation">,</span>                 width <span class="token operator">=</span> <span class="token number">.2</span><span class="token punctuation">,</span> position <span class="token operator">=</span> position_dodge<span class="token punctuation">(</span>width <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_text<span class="token punctuation">(</span>data <span class="token operator">=</span> anno<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> xstar<span class="token punctuation">,</span>  y <span class="token operator">=</span> ystar<span class="token punctuation">,</span> label <span class="token operator">=</span> lab<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_segment<span class="token punctuation">(</span>data <span class="token operator">=</span> anno<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> x1<span class="token punctuation">,</span> xend <span class="token operator">=</span> x1<span class="token punctuation">,</span>            y <span class="token operator">=</span> y1<span class="token punctuation">,</span> yend <span class="token operator">=</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span>           colour <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_segment<span class="token punctuation">(</span>data <span class="token operator">=</span> anno<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> x2<span class="token punctuation">,</span> xend <span class="token operator">=</span> x2<span class="token punctuation">,</span>            y <span class="token operator">=</span> y1<span class="token punctuation">,</span> yend <span class="token operator">=</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span>           colour <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token operator">+</span>  geom_segment<span class="token punctuation">(</span>data <span class="token operator">=</span> anno<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>x <span class="token operator">=</span> x1<span class="token punctuation">,</span> xend <span class="token operator">=</span> x2<span class="token punctuation">,</span>            y <span class="token operator">=</span> y2<span class="token punctuation">,</span> yend <span class="token operator">=</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span>           colour <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span><span class="token operator">+</span>  facet_grid<span class="token punctuation">(</span>. <span class="token operator">~</span> region<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/annofacet-15.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ggplot2.tidyverse.org/reference/index.html#section-facetting">Facetting</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="http://www.sthda.com/english/wiki/ggplot2-facet-split-a-plot-into-a-matrix-of-panels">ggplot2 facet : split a plot into a matrix of panels</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://buzzrbeeline.blog/2018/11/06/adding-different-annotation-to-each-facet-in-ggplot/">Adding different annotation to each facet in ggplot</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 é¢œè‰²é…ç½®</title>
    <link href="/2019/04/21/ggplot2-Color/"/>
    <url>/2019/04/21/ggplot2-Color/</url>
    
    <content type="html"><![CDATA[<p>ggplot2ä¸»è¦é€šè¿‡<code>FILL</code>å’Œ<code>COLOR</code>å±æ€§è®¾ç½®å‡ ä½•å¯¹è±¡çš„é¢œè‰²ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šæŸä¸€ç§é¢œè‰²ï¼Œè®©é¢œè‰²éšå˜é‡è‡ªåŠ¨é…ç½®æˆ–è€…ä½¿ç”¨è°ƒè‰²æ¿è®¾ç½®é¢œè‰²<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Dealing with colors in ggplot2">[1]</span></a></sup>ã€‚</p><h2 id="è‰²å½©ä»£ç "><a href="#è‰²å½©ä»£ç " class="headerlink" title="è‰²å½©ä»£ç "></a>è‰²å½©ä»£ç </h2><p>å¯¹äºå•ä¸ªé¢œè‰²é€‰æ‹©ï¼Œå¯ä»¥å‚è€ƒRè¯­è¨€ç»˜å›¾é¢œè‰²å¯¹ç…§è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†å‡ ä¹å¯ä»¥ç”¨åˆ°çš„é¢œè‰²ä»£ç <br><br></p><div class="row">    <embed src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/ColorChart.pdf" width="100%" height="550" type="application/pdf"></div><br><h2 id="è°ƒè‰²æ¿"><a href="#è°ƒè‰²æ¿" class="headerlink" title="è°ƒè‰²æ¿"></a>è°ƒè‰²æ¿</h2><p>å¯¹äºè¿ç»­è‰²é˜¶æˆ–è€…å¤šç§è‰²å½©æ­é…ï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨<code>RColorBrewer</code>æä¾›çš„è°ƒè‰²æ¿ã€‚<br>ggplot2åŸç”Ÿæ”¯æŒé€šè¿‡è®¾ç½®<code>palette</code>æ¥åˆ‡æ¢è°ƒè‰²æ¿<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggplot2 colors : How to change colors automatically and manually?">[2]</span></a></sup>ï¼Œ<a href="https://www.r-graph-gallery.com/38-rcolorbrewers-palettes.html">è¿™é‡Œ</a>æä¾›äº†é¢„è®¾<code>ColorBrewer</code>è°ƒè‰²æ¿ä»£å·åŠé¢„è§ˆã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> scale_color_brewer<span class="token punctuation">(</span>palette <span class="token operator">=</span> <span class="token string">"PuOr"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/thecode-1.png/pic"></p><p>å¦å¤–ä¸€ç§å®˜æ–¹åŸç”Ÿæ”¯æŒçš„è‰²æ¿<code>Viridis</code>ï¼Œ<a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">è¿™é‡Œ</a>æœ‰é¢„è®¾è‰²æ¿ã€‚è¿™ä¸ªè‰²æ¿ä»¥è¿ç»­é¢œè‰²ä¸ºä¸»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®<code>discrete=TRUE</code>å±æ€§ä½¿ç”¨ç¦»æ•£è‰²é˜¶ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">p <span class="token operator">+</span> scale_color_viridis<span class="token punctuation">(</span>option<span class="token operator">=</span><span class="token string">"magma"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/viridis.png/pic"></p><p>æ­¤å¤–è¿˜å¯é€šè¿‡<a href="https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html">ggsci</a>æˆ–è€…<a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">ggthemes</a>é€‰æ‹©åˆé€‚çš„è°ƒè‰²æ¿<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ggplot2/ggthemes-1.png/pic"></p><h3 id="è°ƒè‰²æ¿hexä»£ç æŸ¥çœ‹"><a href="#è°ƒè‰²æ¿hexä»£ç æŸ¥çœ‹" class="headerlink" title="è°ƒè‰²æ¿hexä»£ç æŸ¥çœ‹"></a>è°ƒè‰²æ¿hexä»£ç æŸ¥çœ‹</h3><ul><li><a href="https://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3">è¿™é‡Œ</a>æä¾›äº†<code>ColorBrewer</code>è°ƒè‰²æ¿åŠ¨æ€é¢„è§ˆåŠhexä»£ç æŸ¥çœ‹ã€‚</li><li>è·å–å…¶ä»–è°ƒè‰²æ¿hex<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>paletteer<span class="token punctuation">)</span>paletteer_c<span class="token punctuation">(</span>package <span class="token operator">=</span> <span class="token string">"scico"</span><span class="token punctuation">,</span> palette <span class="token operator">=</span> <span class="token string">"berlin"</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li>ggplot2 é»˜è®¤è°ƒè‰²æ¿æŸ¥çœ‹<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>scales<span class="token punctuation">)</span> <span class="token comment"># nä¸ºè‰²æ¿é˜¶æ•°</span>show_col<span class="token punctuation">(</span>hue_pal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li></ul><h3 id="è‡ªå®šä¹‰è°ƒè‰²æ¿"><a href="#è‡ªå®šä¹‰è°ƒè‰²æ¿" class="headerlink" title="è‡ªå®šä¹‰è°ƒè‰²æ¿"></a>è‡ªå®šä¹‰è°ƒè‰²æ¿</h3><p>å½“ä»¥ä¸Šè‰²æ¿æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è‡ªå®šä¹‰è‰²æ¿<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Rè¯­è¨€ä½œå›¾ï¼šè‡ªå®šä¹‰è°ƒè‰²ç›˜">[3]</span></a></sup>ã€‚</p><ul><li>ç”Ÿæˆè‰²æ¿<br>ä¸»è¦ä½¿ç”¨<code>colorRampPalette</code>ï¼Œè¯¦è§<a href="https://www.rdocumentation.org/packages/dichromat/versions/1.1/topics/colorRampPalette">æ–‡æ¡£</a><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å®šä¹‰åŸºå‡†è‰²</span>cols<span class="token operator">&lt;-</span>c<span class="token punctuation">(</span><span class="token string">'#E64E00'</span><span class="token punctuation">,</span><span class="token string">'#65B48E'</span><span class="token punctuation">,</span><span class="token string">'#E6EB00'</span><span class="token punctuation">,</span><span class="token string">'#E64E00'</span><span class="token punctuation">)</span><span class="token comment"># ç”Ÿæˆè‰²æ¿ 20 è‰²é˜¶</span><span class="token comment"># biasç”¨äºè®¾ç½®è‰²é˜¶åç§» Bias >1 puts more colors at high values</span>pal<span class="token operator">&lt;-</span>colorRampPalette<span class="token punctuation">(</span>cols<span class="token punctuation">,</span> bias <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>image<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>z<span class="token operator">=</span>as.matrix<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>col<span class="token operator">=</span>pal<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>æŸ¥çœ‹è‰²æ¿<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">pal<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token string">"#3E5CC5"</span> <span class="token string">"#4469BC"</span> <span class="token string">"#4A77B3"</span> <span class="token string">"#5085AA"</span> <span class="token string">"#5693A2"</span> <span class="token string">"#5CA199"</span> <span class="token string">"#62AF90"</span> <span class="token string">"#72B97F"</span> <span class="token string">"#86C268"</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token string">"#9BCB52"</span> <span class="token string">"#AFD33B"</span> <span class="token string">"#C4DC25"</span> <span class="token string">"#D8E50E"</span> <span class="token string">"#E6E200"</span> <span class="token string">"#E6C900"</span> <span class="token string">"#E6B100"</span> <span class="token string">"#E69800"</span> <span class="token string">"#E67F00"</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token string">"#E66600"</span> <span class="token string">"#E64E00"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>ä½¿ç”¨è‰²æ¿<br>è‹¥ä½¿ç”¨æ—¶nå°äºè®¾ç½®é˜¶æ•°ï¼Œåˆ™ä»å·¦å¼€å§‹æˆªæ–­ä½¿ç”¨ã€‚<div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># è¿ç»­å‹</span>p <span class="token operator">+</span> scale_color_gradientn<span class="token punctuation">(</span>colors <span class="token operator">=</span> pal<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ç¦»æ•£å‹</span>p <span class="token operator">+</span> scale_color_manual<span class="token punctuation">(</span>colors <span class="token operator">=</span> pal<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.r-graph-gallery.com/ggplot2-color.html">Dealing with colors in ggplot2</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually">ggplot2 colors : How to change colors automatically and manually?</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/144764468">Rè¯­è¨€ä½œå›¾ï¼šè‡ªå®šä¹‰è°ƒè‰²ç›˜</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ggplot2 æ·»åŠ æ‹Ÿåˆçº¿åŠå…¬å¼</title>
    <link href="/2019/04/21/ggplot2-Lines/"/>
    <url>/2019/04/21/ggplot2-Lines/</url>
    
    <content type="html"><![CDATA[<p>ä¸»è¦ä»‹ç»ggplot2é‡Œæ‹Ÿåˆçº¿ä¸å…¬å¼è®¾ç½®</p><h2 id="ä½¿ç”¨ggpmisc"><a href="#ä½¿ç”¨ggpmisc" class="headerlink" title="ä½¿ç”¨ggpmisc()"></a>ä½¿ç”¨ggpmisc()</h2><p>stat_smooth + stat_poly_eqç»„åˆå®ç°æ‹Ÿåˆæ›²çº¿ä»¥åŠæ‹Ÿåˆå…¬å¼æ˜¾ç¤ºã€‚</p><p>stat_poly_eqç”¨äºæ˜¾ç¤ºå…¬å¼ï¼Œæ”¯æŒä»¥ä¸‹ç»Ÿè®¡å‚æ•°æ˜¾ç¤º<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Equation, p-value, R^2, AIC or BIC of fitted polynomial">[1]</span></a></sup>ï¼š</p><blockquote><p>eq.label<br>equation for the fitted polynomial as a character string to be parsed</p></blockquote><blockquote><p>rr.label<br>R2 of the fitted model as a character string to be parsed</p></blockquote><blockquote><p>adj.rr.label<br>Adjusted R2 of the fitted model as a character string to be parsed</p></blockquote><blockquote><p>f.value.label<br>F value and degrees of freedom for the fitted model as a whole.</p></blockquote><blockquote><p>p.value..label<br>P-value for the F-value above.</p></blockquote><blockquote><p>AIC.label<br>AIC for the fitted model.</p></blockquote><blockquote><p>BIC.label<br>BIC for the fitted model.</p></blockquote><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å®šä¹‰å…¬å¼ç±»å‹</span>formula <span class="token operator">&lt;-</span> y <span class="token operator">~</span> x <span class="token operator">+</span> I<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment"># æ·»åŠ æ‹Ÿåˆçº¿</span>P <span class="token operator">+</span> geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> formula<span class="token punctuation">)</span><span class="token comment"># æ·»åŠ å…¬å¼</span>p <span class="token operator">+</span> stat_poly_eq<span class="token punctuation">(</span>aes<span class="token punctuation">(</span>label <span class="token operator">=</span>  paste<span class="token punctuation">(</span>stat<span class="token punctuation">(</span>eq.label<span class="token punctuation">)</span><span class="token punctuation">,</span> stat<span class="token punctuation">(</span>adj.rr.label<span class="token punctuation">)</span><span class="token punctuation">,</span>                 sep <span class="token operator">=</span> <span class="token string">"*\", \"*"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> formula <span class="token operator">=</span> formula<span class="token punctuation">,</span> parse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token comment"># æ·»åŠ å‚æ•°è¡¨</span>p <span class="token operator">+</span> stat_fit_tb<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">,</span>              method.args <span class="token operator">=</span> list<span class="token punctuation">(</span>formula <span class="token operator">=</span> formula<span class="token punctuation">)</span><span class="token punctuation">,</span>              tb.type <span class="token operator">=</span> <span class="token string">"fit.anova"</span><span class="token punctuation">,</span>              tb.vars <span class="token operator">=</span> c<span class="token punctuation">(</span>Effect <span class="token operator">=</span> <span class="token string">"term"</span><span class="token punctuation">,</span>                           <span class="token string">"df"</span><span class="token punctuation">,</span>                          <span class="token string">"M.S."</span> <span class="token operator">=</span> <span class="token string">"meansq"</span><span class="token punctuation">,</span>                           <span class="token string">"italic(F)"</span> <span class="token operator">=</span> <span class="token string">"statistic"</span><span class="token punctuation">,</span>                           <span class="token string">"italic(P)"</span> <span class="token operator">=</span> <span class="token string">"p.value"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              label.y <span class="token operator">=</span> <span class="token number">0.87</span><span class="token punctuation">,</span> label.x <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span>              size <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>              parse <span class="token operator">=</span> <span class="token boolean">TRUE</span>  <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>stat_poly_eqæ˜¾ç¤ºp-value<code>stat(p.value.label)</code>ï¼Œpæ˜¾ç¤ºä¸ºå¤§å†™<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="â€œ på€¼â€çš„æ­£ç¡®æ‹¼å†™ï¼ˆå¤§å†™ï¼Œæ–œä½“ï¼Œè¿å­—ç¬¦ï¼‰å—ï¼Ÿ">[2]</span></a></sup>ï¼Œå¦‚æœéœ€è¦æ”¹ä¸ºå°å†™æ–œä½“<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Can we neatly align the regression equation and R2 and p value?">[3]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å°†stat(p.value.label) æ›¿æ¢ä¸º</span>paste<span class="token punctuation">(</span><span class="token string">"italic(p)"</span><span class="token punctuation">,</span> substring<span class="token punctuation">(</span>p.value.label<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="å¯¹æ•°æŒ‡æ•°å½¢å¼"><a href="#å¯¹æ•°æŒ‡æ•°å½¢å¼" class="headerlink" title="å¯¹æ•°æŒ‡æ•°å½¢å¼"></a>å¯¹æ•°æŒ‡æ•°å½¢å¼</h3><p><code>stat_poly_eq</code>åœ¨æ˜¾ç¤ºæŒ‡æ•°æˆ–å¯¹æ•°å‡½æ•°æ—¶æ€»å‡ºç°é—®é¢˜ï¼Œå› æ­¤è€ƒè™‘é‡‡ç”¨geom_line + geom_ribbon + annotateæ–¹å¼è¿‚å›å®ç°<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="How to visulaize linear model prediction in ggplot along with confidence interval?">[4]</span></a></sup>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å…¬å¼æ‹Ÿåˆ</span>log.model <span class="token operator">&lt;-</span>lm<span class="token punctuation">(</span>log<span class="token punctuation">(</span>Frequency<span class="token punctuation">)</span> <span class="token operator">~</span> Coverage<span class="token punctuation">,</span> area<span class="token punctuation">)</span><span class="token comment"># ç”¨äºgeom_ribbonæ˜¾ç¤ºCI</span>observeddata <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>area<span class="token punctuation">,</span> predict<span class="token punctuation">(</span>log.model<span class="token punctuation">,</span> newdata <span class="token operator">=</span> area<span class="token punctuation">,</span> interval <span class="token operator">=</span> <span class="token string">'confidence'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ç»„åˆç”Ÿæˆæ‹Ÿåˆçº¿ä¸å…¬å¼</span>p <span class="token operator">+</span> geom_ribbon<span class="token punctuation">(</span>data <span class="token operator">=</span> observeddata<span class="token punctuation">,</span>                 aes<span class="token punctuation">(</span>x <span class="token operator">=</span> Coverage<span class="token punctuation">,</span> y <span class="token operator">=</span> exp<span class="token punctuation">(</span>fit<span class="token punctuation">)</span><span class="token punctuation">,</span> ymin <span class="token operator">=</span> exp<span class="token punctuation">(</span>lwr<span class="token punctuation">)</span><span class="token punctuation">,</span> ymax <span class="token operator">=</span> exp<span class="token punctuation">(</span>upr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>   geom_line<span class="token punctuation">(</span>data <span class="token operator">=</span> log.model.df<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>Coverage<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span> <span class="token operator">+</span>   annotate<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="ä½¿ç”¨ggPredict"><a href="#ä½¿ç”¨ggPredict" class="headerlink" title="ä½¿ç”¨ggPredict()"></a>ä½¿ç”¨ggPredict()</h2><p><code>ggPredict</code>æä¾›äº†æ‹Ÿåˆæ›²çº¿çš„å°è£…å‡½æ•°ï¼Œç›¸æ¯”ggplot2åŸç”Ÿç»˜åˆ¶ï¼Œæ›´ä¸ºç®€å•ï¼ŒåŒæ—¶æ”¯æŒlm()ï¼Œglm()ç­‰æ‹Ÿåˆæ–¹å¼<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="ggPredict-Visualize multiple regression model">[5]</span></a></sup>ã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">install.packages<span class="token punctuation">(</span><span class="token string">"devtools"</span><span class="token punctuation">)</span>devtools<span class="token operator">::</span>install_github<span class="token punctuation">(</span><span class="token string">"cardiomoon/ggiraphExtra"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="å¯¹æ¯”åŸç”Ÿæ–¹æ³•"><a href="#å¯¹æ¯”åŸç”Ÿæ–¹æ³•" class="headerlink" title="å¯¹æ¯”åŸç”Ÿæ–¹æ³•"></a>å¯¹æ¯”åŸç”Ÿæ–¹æ³•</h3><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># è½½å…¥æ ·ä¾‹æ•°æ®</span>require<span class="token punctuation">(</span>moonBook<span class="token punctuation">)</span><span class="token comment"># æ‹Ÿåˆ </span>fit <span class="token operator">=</span> lm<span class="token punctuation">(</span>NTAV<span class="token operator">~</span>age<span class="token punctuation">,</span> data <span class="token operator">=</span> radial<span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ggplotçš„ geom_smooth ç»˜åˆ¶</span>ggplot<span class="token punctuation">(</span>radial<span class="token punctuation">,</span> aes<span class="token punctuation">(</span>y <span class="token operator">=</span> NTAV<span class="token punctuation">,</span>x <span class="token operator">=</span> age<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> geom_point<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> geom_smooth<span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">"lm"</span><span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ggPredictç»˜åˆ¶</span>ggPredict<span class="token punctuation">(</span>fit<span class="token punctuation">,</span> se <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> interactive <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html">Equation, p-value, R^2, AIC or BIC of fitted polynomial</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://qastack.cn/stats/871/correct-spelling-capitalization-italicization-hyphenation-of-p-value">â€œ på€¼â€çš„æ­£ç¡®æ‹¼å†™ï¼ˆå¤§å†™ï¼Œæ–œä½“ï¼Œè¿å­—ç¬¦ï¼‰å—ï¼Ÿ</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://stackoverflow.com/questions/61266084/can-we-neatly-align-the-regression-equation-and-r2-and-p-value">Can we neatly align the regression equation and R2 and p value?</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://stackoverflow.com/questions/41205153/how-to-visulaize-linear-model-prediction-in-ggplot-along-with-confidence-interva">How to visulaize linear model prediction in ggplot along with confidence interval?</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://cran.r-project.org/web/packages/ggiraphExtra/vignettes/ggPredict.html">ggPredict-Visualize multiple regression model</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>ggplot2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›½å†…åœ°å›¾åæ ‡è½¬æ¢</title>
    <link href="/2019/03/25/Python-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/"/>
    <url>/2019/03/25/Python-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/</url>
    
    <content type="html"><![CDATA[<h2 id="å¸¸ç”¨åæ ‡ç³»ç»Ÿ"><a href="#å¸¸ç”¨åæ ‡ç³»ç»Ÿ" class="headerlink" title="å¸¸ç”¨åæ ‡ç³»ç»Ÿ"></a>å¸¸ç”¨åæ ‡ç³»ç»Ÿ</h2><ul><li>WGS84 ï¼šåœ°ç†åæ ‡ç³»ç»Ÿï¼ŒGoogle Earthå’Œä¸­å›½å¤–çš„Google Mapä½¿ç”¨ï¼Œå¦å¤–ï¼Œç›®å‰åŸºæœ¬ä¸Šæ‰€æœ‰å®šä½ç©ºé—´ä½ç½®çš„è®¾å¤‡éƒ½ä½¿ç”¨è¿™ç§åæ ‡ç³»ç»Ÿï¼Œä¾‹å¦‚æ‰‹æœºçš„GPSç³»ç»Ÿã€‚</li><li>GCJ-02ï¼šæŠ•å½±åæ ‡ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„ç«æ˜Ÿåæ ‡ç³»ï¼ŒGoogle Mapä¸­å›½ã€é«˜å¾·å’Œè…¾è®¯ä½¿ç”¨ï¼Œè¿™ä¸ªæ˜¯ä¸­å›½è‡ªå·±åœ¨WGS84åŸºç¡€ä¸ŠåŠ å¯†è€Œæˆã€‚</li><li>BD09ï¼šæŠ•å½±åæ ‡ç³»ç»Ÿï¼Œç™¾åº¦åœ°å›¾ä½¿ç”¨ï¼Œåœ¨GCJ-02åŸºç¡€ä¸ŠäºŒæ¬¡åŠ å¯†è€Œæˆã€‚</li></ul><h2 id="å›½å†…åœ°å›¾APIåæ ‡ç³»ç»Ÿ"><a href="#å›½å†…åœ°å›¾APIåæ ‡ç³»ç»Ÿ" class="headerlink" title="å›½å†…åœ°å›¾APIåæ ‡ç³»ç»Ÿ"></a>å›½å†…åœ°å›¾APIåæ ‡ç³»ç»Ÿ</h2><table><thead><tr><th>API</th><th>åæ ‡ç³»</th></tr></thead><tbody><tr><td>ç™¾åº¦åœ°å›¾API</td><td>ç™¾åº¦åæ ‡</td></tr><tr><td>è…¾è®¯æœæœåœ°å›¾API</td><td>ç«æ˜Ÿåæ ‡</td></tr><tr><td>æœç‹æœç‹—åœ°å›¾API</td><td>æœç‹—åæ ‡</td></tr><tr><td>é˜¿é‡Œäº‘åœ°å›¾API</td><td>ç«æ˜Ÿåæ ‡</td></tr><tr><td>å›¾å§MapBaråœ°å›¾API</td><td>å›¾å§åæ ‡</td></tr><tr><td>é«˜å¾·MapABCåœ°å›¾API</td><td>ç«æ˜Ÿåæ ‡</td></tr><tr><td>çµå›¾51dituåœ°å›¾API</td><td>ç«æ˜Ÿåæ ‡</td></tr></tbody></table><h2 id="è½¬æ¢æ–¹å¼"><a href="#è½¬æ¢æ–¹å¼" class="headerlink" title="è½¬æ¢æ–¹å¼"></a>è½¬æ¢æ–¹å¼</h2><p>Python å®ç°</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json<span class="token keyword">import</span> requests<span class="token keyword">import</span> math<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdkey <span class="token operator">=</span> <span class="token string">'your key here'</span>  <span class="token comment"># è¿™é‡Œå¡«å†™ä½ çš„ç™¾åº¦å¼€æ”¾å¹³å°çš„key</span>x_pi <span class="token operator">=</span> <span class="token number">3.14159265358979324</span> <span class="token operator">*</span> <span class="token number">3000.0</span> <span class="token operator">/</span> <span class="token number">180.0</span>pi <span class="token operator">=</span> <span class="token number">3.1415926535897932384626</span>  <span class="token comment"># Ï€</span>a <span class="token operator">=</span> <span class="token number">6378245.0</span>  <span class="token comment"># é•¿åŠè½´</span>ee <span class="token operator">=</span> <span class="token number">0.00669342162296594323</span>  <span class="token comment"># æ‰ç‡</span><span class="token keyword">def</span> <span class="token function">geocode</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    åˆ©ç”¨ç™¾åº¦geocodingæœåŠ¡è§£æåœ°å€è·å–ä½ç½®åæ ‡    :param address:éœ€è¦è§£æçš„åœ°å€    :return:    """</span>    geocoding <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'s'</span><span class="token punctuation">:</span> <span class="token string">'rsv3'</span><span class="token punctuation">,</span>                 <span class="token string">'key'</span><span class="token punctuation">:</span> key<span class="token punctuation">,</span>                 <span class="token string">'city'</span><span class="token punctuation">:</span> <span class="token string">'å…¨å›½'</span><span class="token punctuation">,</span>                 <span class="token string">'address'</span><span class="token punctuation">:</span> address<span class="token punctuation">&#125;</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>        <span class="token string">"http://restapi.amap.com/v3/geocode/geo"</span><span class="token punctuation">,</span> params<span class="token operator">=</span>geocoding<span class="token punctuation">)</span>    <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>        json <span class="token operator">=</span> res<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        status <span class="token operator">=</span> json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'status'</span><span class="token punctuation">)</span>        count <span class="token operator">=</span> json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> status <span class="token operator">==</span> <span class="token string">'1'</span> <span class="token keyword">and</span> <span class="token builtin">int</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">:</span>            geocodes <span class="token operator">=</span> json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'geocodes'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            lng <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>geocodes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'location'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            lat <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>geocodes<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'location'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">[</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">None</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token keyword">def</span> <span class="token function">gcj02tobd09</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    ç«æ˜Ÿåæ ‡ç³»(GCJ-02)è½¬ç™¾åº¦åæ ‡ç³»(BD-09)    è°·æ­Œã€é«˜å¾·â€”â€”>ç™¾åº¦    :param lng:ç«æ˜Ÿåæ ‡ç»åº¦    :param lat:ç«æ˜Ÿåæ ‡çº¬åº¦    :return:    """</span>    z <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>lng <span class="token operator">*</span> lng <span class="token operator">+</span> lat <span class="token operator">*</span> lat<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.00002</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lat <span class="token operator">*</span> x_pi<span class="token punctuation">)</span>    theta <span class="token operator">=</span> math<span class="token punctuation">.</span>atan2<span class="token punctuation">(</span>lat<span class="token punctuation">,</span> lng<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.000003</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>lng <span class="token operator">*</span> x_pi<span class="token punctuation">)</span>    bd_lng <span class="token operator">=</span> z <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.0065</span>    bd_lat <span class="token operator">=</span> z <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.006</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>bd_lng<span class="token punctuation">,</span> bd_lat<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">bd09togcj02</span><span class="token punctuation">(</span>bd_lon<span class="token punctuation">,</span> bd_lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    ç™¾åº¦åæ ‡ç³»(BD-09)è½¬ç«æ˜Ÿåæ ‡ç³»(GCJ-02)    ç™¾åº¦â€”â€”>è°·æ­Œã€é«˜å¾·    :param bd_lat:ç™¾åº¦åæ ‡çº¬åº¦    :param bd_lon:ç™¾åº¦åæ ‡ç»åº¦    :return:è½¬æ¢åçš„åæ ‡åˆ—è¡¨å½¢å¼    """</span>    x <span class="token operator">=</span> bd_lon <span class="token operator">-</span> <span class="token number">0.0065</span>    y <span class="token operator">=</span> bd_lat <span class="token operator">-</span> <span class="token number">0.006</span>    z <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.00002</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>y <span class="token operator">*</span> x_pi<span class="token punctuation">)</span>    theta <span class="token operator">=</span> math<span class="token punctuation">.</span>atan2<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.000003</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x <span class="token operator">*</span> x_pi<span class="token punctuation">)</span>    gg_lng <span class="token operator">=</span> z <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>    gg_lat <span class="token operator">=</span> z <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>gg_lng<span class="token punctuation">,</span> gg_lat<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">wgs84togcj02</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    WGS84è½¬GCJ02(ç«æ˜Ÿåæ ‡ç³»)    :param lng:WGS84åæ ‡ç³»çš„ç»åº¦    :param lat:WGS84åæ ‡ç³»çš„çº¬åº¦    :return:    """</span>    <span class="token keyword">if</span> out_of_china<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># åˆ¤æ–­æ˜¯å¦åœ¨å›½å†…</span>        <span class="token keyword">return</span> lng<span class="token punctuation">,</span> lat    dlat <span class="token operator">=</span> transformlat<span class="token punctuation">(</span>lng <span class="token operator">-</span> <span class="token number">105.0</span><span class="token punctuation">,</span> lat <span class="token operator">-</span> <span class="token number">35.0</span><span class="token punctuation">)</span>    dlng <span class="token operator">=</span> transformlng<span class="token punctuation">(</span>lng <span class="token operator">-</span> <span class="token number">105.0</span><span class="token punctuation">,</span> lat <span class="token operator">-</span> <span class="token number">35.0</span><span class="token punctuation">)</span>    radlat <span class="token operator">=</span> lat <span class="token operator">/</span> <span class="token number">180.0</span> <span class="token operator">*</span> pi    magic <span class="token operator">=</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>radlat<span class="token punctuation">)</span>    magic <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> ee <span class="token operator">*</span> magic <span class="token operator">*</span> magic    sqrtmagic <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>magic<span class="token punctuation">)</span>    dlat <span class="token operator">=</span> <span class="token punctuation">(</span>dlat <span class="token operator">*</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> ee<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>magic <span class="token operator">*</span> sqrtmagic<span class="token punctuation">)</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span>    dlng <span class="token operator">=</span> <span class="token punctuation">(</span>dlng <span class="token operator">*</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> sqrtmagic <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>radlat<span class="token punctuation">)</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span>    mglat <span class="token operator">=</span> lat <span class="token operator">+</span> dlat    mglng <span class="token operator">=</span> lng <span class="token operator">+</span> dlng    <span class="token keyword">return</span> <span class="token punctuation">[</span>mglng<span class="token punctuation">,</span> mglat<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">gcj02towgs84</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    GCJ02(ç«æ˜Ÿåæ ‡ç³»)è½¬GPS84    :param lng:ç«æ˜Ÿåæ ‡ç³»çš„ç»åº¦    :param lat:ç«æ˜Ÿåæ ‡ç³»çº¬åº¦    :return:    """</span>    lng <span class="token operator">=</span> data<span class="token punctuation">[</span>x<span class="token punctuation">]</span>    lat <span class="token operator">=</span> data<span class="token punctuation">[</span>y<span class="token punctuation">]</span>        <span class="token keyword">if</span> out_of_china<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> lng<span class="token punctuation">,</span> lat    dlat <span class="token operator">=</span> transformlat<span class="token punctuation">(</span>lng <span class="token operator">-</span> <span class="token number">105.0</span><span class="token punctuation">,</span> lat <span class="token operator">-</span> <span class="token number">35.0</span><span class="token punctuation">)</span>    dlng <span class="token operator">=</span> transformlng<span class="token punctuation">(</span>lng <span class="token operator">-</span> <span class="token number">105.0</span><span class="token punctuation">,</span> lat <span class="token operator">-</span> <span class="token number">35.0</span><span class="token punctuation">)</span>    radlat <span class="token operator">=</span> lat <span class="token operator">/</span> <span class="token number">180.0</span> <span class="token operator">*</span> pi    magic <span class="token operator">=</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>radlat<span class="token punctuation">)</span>    magic <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> ee <span class="token operator">*</span> magic <span class="token operator">*</span> magic    sqrtmagic <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>magic<span class="token punctuation">)</span>    dlat <span class="token operator">=</span> <span class="token punctuation">(</span>dlat <span class="token operator">*</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> ee<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>magic <span class="token operator">*</span> sqrtmagic<span class="token punctuation">)</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span>    dlng <span class="token operator">=</span> <span class="token punctuation">(</span>dlng <span class="token operator">*</span> <span class="token number">180.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> sqrtmagic <span class="token operator">*</span> math<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>radlat<span class="token punctuation">)</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span>    mglat <span class="token operator">=</span> lat <span class="token operator">+</span> dlat    mglng <span class="token operator">=</span> lng <span class="token operator">+</span> dlng    <span class="token keyword">return</span> <span class="token punctuation">[</span>lng <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> mglng<span class="token punctuation">,</span> lat <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> mglat<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">transformlat</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    ret <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100.0</span> <span class="token operator">+</span> <span class="token number">2.0</span> <span class="token operator">*</span> lng <span class="token operator">+</span> <span class="token number">3.0</span> <span class="token operator">*</span> lat <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">*</span> lat <span class="token operator">*</span> lat <span class="token operator">+</span> \        <span class="token number">0.1</span> <span class="token operator">*</span> lng <span class="token operator">*</span> lat <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>math<span class="token punctuation">.</span>fabs<span class="token punctuation">(</span>lng<span class="token punctuation">)</span><span class="token punctuation">)</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">20.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">6.0</span> <span class="token operator">*</span> lng <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">20.0</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*</span> lng <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">20.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lat <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">40.0</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lat <span class="token operator">/</span> <span class="token number">3.0</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">160.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lat <span class="token operator">/</span> <span class="token number">12.0</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">320</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lat <span class="token operator">*</span> pi <span class="token operator">/</span> <span class="token number">30.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    <span class="token keyword">return</span> ret<span class="token keyword">def</span> <span class="token function">transformlng</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    ret <span class="token operator">=</span> <span class="token number">300.0</span> <span class="token operator">+</span> lng <span class="token operator">+</span> <span class="token number">2.0</span> <span class="token operator">*</span> lat <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> lng <span class="token operator">*</span> lng <span class="token operator">+</span> \        <span class="token number">0.1</span> <span class="token operator">*</span> lng <span class="token operator">*</span> lat <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>math<span class="token punctuation">.</span>fabs<span class="token punctuation">(</span>lng<span class="token punctuation">)</span><span class="token punctuation">)</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">20.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">6.0</span> <span class="token operator">*</span> lng <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">20.0</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*</span> lng <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">20.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lng <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">40.0</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lng <span class="token operator">/</span> <span class="token number">3.0</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    ret <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">150.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lng <span class="token operator">/</span> <span class="token number">12.0</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">300.0</span> <span class="token operator">*</span>            math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>lng <span class="token operator">/</span> <span class="token number">30.0</span> <span class="token operator">*</span> pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">/</span> <span class="token number">3.0</span>    <span class="token keyword">return</span> ret<span class="token keyword">def</span> <span class="token function">out_of_china</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    åˆ¤æ–­æ˜¯å¦åœ¨å›½å†…ï¼Œä¸åœ¨å›½å†…ä¸åšåç§»    :param lng:    :param lat:    :return:    """</span>    <span class="token keyword">if</span> lng <span class="token operator">&lt;</span> <span class="token number">72.004</span> <span class="token keyword">or</span> lng <span class="token operator">></span> <span class="token number">137.8347</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">if</span> lat <span class="token operator">&lt;</span> <span class="token number">0.8293</span> <span class="token keyword">or</span> lat <span class="token operator">></span> <span class="token number">55.8271</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    lng <span class="token operator">=</span> <span class="token number">128.543</span>    lat <span class="token operator">=</span> <span class="token number">37.065</span>    result1 <span class="token operator">=</span> gcj02tobd09<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span>    result2 <span class="token operator">=</span> bd09togcj02<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span>    result3 <span class="token operator">=</span> wgs84togcj02<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span>    result4 <span class="token operator">=</span> gcj02towgs84<span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">)</span>    result5 <span class="token operator">=</span> geocode<span class="token punctuation">(</span><span class="token string">'åŒ—äº¬å¸‚æœé˜³åŒºæœé˜³å…¬å›­'</span><span class="token punctuation">)</span>    results <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r'D:\kk.csv'</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">'gbk'</span><span class="token punctuation">)</span>results<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span> <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>gcj02towgs84 <span class="token punctuation">,</span>       axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> results<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'ss.csv'</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">'gbk'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.jianshu.com/p/c39a2c72dc65">åœ°å›¾åæ ‡è½¬æ¢ï¼ˆç«æ˜Ÿã€è°·æ­Œã€ç™¾åº¦ã€è…¾è®¯ã€é«˜å¾·ç­‰åæ ‡ï¼‰</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åæ ‡è½¬æ¢</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>R æ•°æ®è½¬æ¢</title>
    <link href="/2018/12/11/R-Format/"/>
    <url>/2018/12/11/R-Format/</url>
    
    <content type="html"><![CDATA[<p>åªæä¾›å‡½æ•°ä¸åŠŸèƒ½å…³é”®å­—é€ŸæŸ¥ï¼Œå…·ä½“ç”¨æ³•å¯è‡ªå·±æœç´¢å®˜æ–¹æ–‡æ¡£ï¼Œç¤ºä¾‹æ¯”è¾ƒè¯¦å°½ã€‚</p><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># è·å–å­—ç¬¦ä¸²é•¿åº¦</span>nchar<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># å­—ç¬¦ä¸²åˆ†å‰²</span>strsplit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># å­—ç¬¦ä¸²æ‹¼æ¥</span>paste<span class="token punctuation">(</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token comment"># å­—ç¬¦ä¸²æˆªå–</span>substr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># å­—ç¬¦ä¸²æ›¿ä»£</span>gsub<span class="token punctuation">(</span><span class="token punctuation">)</span>chartr<span class="token punctuation">(</span><span class="token punctuation">)</span>sub<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># å­—ç¬¦ä¸²åŒ¹é…</span>grep<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># å¤§å°å†™æ›¿æ¢</span>toupper<span class="token punctuation">(</span><span class="token punctuation">)</span>tolower<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h2><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token comment"># å–æ•´</span><span class="token comment">## å‘ä¸‹</span>floor<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment">## å‘ä¸Š</span>ceiling<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment">## å››èˆäº”å…¥</span>round<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># æœ‰æ•ˆæ•°å­—</span><span class="token comment">## å°æ•°ç‚¹åå¼€å§‹</span>round<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment">## ä»å¤´å¼€å§‹</span>signif<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span><span class="token comment"># ç§‘å­¦è®¡æ•°æ³•</span>format<span class="token punctuation">(</span><span class="token punctuation">,</span> scientific <span class="token operator">=</span> T<span class="token punctuation">)</span><span class="token comment"># è¡¥é›¶è¡¥ä½</span>sprintf<span class="token punctuation">(</span><span class="token string">'%03d'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># åƒåˆ†ä½é—´éš”</span>prettyNum<span class="token punctuation">(</span><span class="token punctuation">,</span> big.mark <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h2><p>POSIXlt</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r"><span class="token operator">></span> today<span class="token operator">&lt;-</span>Sys.time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> unclass<span class="token punctuation">(</span>as.POSIXlt<span class="token punctuation">(</span>today<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">$</span>sec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">53.27151</span><span class="token operator">$</span>min<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">38</span><span class="token operator">$</span>hour<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">20</span><span class="token operator">$</span>mday<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">6</span><span class="token operator">$</span>mon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">5</span><span class="token operator">$</span>year<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">116</span><span class="token operator">$</span>wday<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">1</span><span class="token operator">$</span>yday<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">157</span><span class="token operator">$</span>isdst<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">0</span><span class="token operator">$</span>zone<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token string">"CST"</span><span class="token operator">$</span>gmtoff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">28800</span>attr<span class="token punctuation">(</span><span class="token punctuation">,</span><span class="token string">"tzone"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h2><p>R å­—ç¬¦ä¸²å¤„ç†æ”¯æŒåœ¨<code>pattern</code>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Regular Expressions as used in R">[1]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&#39;\n&#39;          newline                                            &#39;\r&#39;          carriage return                                    &#39;\t&#39;          tab                                                &#39;\b&#39;          backspace                                          &#39;\a&#39;          alert (bell)                                       &#39;\f&#39;          form feed                                          &#39;\v&#39;          vertical tab                                       &#39;\\&#39;          backslash &#39;\&#39;                                      &#39;\&#39;&#39;          ASCII apostrophe &#39;&#39;&#39;                               &#39;\&quot;&#39;          ASCII quotation mark &#39;&quot;&#39;                           &#39;\&#96;&#39;          ASCII grave accent (backtick) &#39;&#96;&#39;                  &#39;\nnn&#39;        character with given octal code (1, 2 or 3 digits) &#39;\xnn&#39;        character with given hex code (1 or 2 hex digits)  &#39;\unnnn&#39;      Unicode character with given code (1-4 hex digits) &#39;\Unnnnnnnn&#39;  Unicode character with given code (1-8 hex digits)  [:alnum:] Alphanumeric characters: [:alpha:] and [:digit:]. [:alpha:] Alphabetic characters: [:lower:] and [:upper:]. [:blank:] Blank characters: space and tab, and possibly other locale-dependent characters such as non-breaking space. [:cntrl:] Control characters. In ASCII, these characters have octal codes 000 through 037, and 177 (DEL). In another character set, these are the equivalent characters, if any. [:digit:] Digits: 0 1 2 3 4 5 6 7 8 9. [:graph:] Graphical characters: [:alnum:] and [:punct:]. [:lower:] Lower-case letters in the current locale. [:print:] Printable characters: [:alnum:], [:punct:] and space. [:punct:] Punctuation characters: ! &quot; # $ % &amp; &#39; ( ) * + , - . &#x2F; : ; &lt; &#x3D; &gt; ? @ [ \ ] ^ _ &#96; &#123; | &#125; ~. [:space:] Space characters: tab, newline, vertical tab, form feed, carriage return, space and possibly other locale-dependent characters. [:upper:] Upper-case letters in the current locale. [:xdigit:] Hexadecimal digits: 0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>è¯¦è§<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="R ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼">[2]</span></a></sup></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html">Regular Expressions as used in R</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://likan.info/cn/post/regular-expressions-used-in-r/">R ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS è½½å…¥åœ¨çº¿åº•å›¾</title>
    <link href="/2018/07/09/ArcGIS-%E8%BD%BD%E5%85%A5%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/"/>
    <url>/2018/07/09/ArcGIS-%E8%BD%BD%E5%85%A5%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<p>ArcGISä¸“é¢˜å›¾ç»˜åˆ¶éœ€è½½å…¥åœ¨çº¿åº•å›¾ï¼Œé™¤è‡ªå¸¦ArcGIS Onlineçš„åº•å›¾å¤–ï¼Œæœ¬æ–‡ä»‹ç»å¦å¤–ä¸¤ç§åº•å›¾è½½å…¥æ–¹å¼ã€‚</p><h2 id="ArcBruTile"><a href="#ArcBruTile" class="headerlink" title="ArcBruTile"></a>ArcBruTile</h2><p>ArcBruTileæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº•å›¾æ’ä»¶ï¼Œæ”¯æŒä¸»æµåœ¨çº¿åœ°å›¾æ’å…¥ï¼Œ0.8ä»¥åç‰ˆæœ¬æ”¶è´¹ï¼Œå¹¶æ”¯æŒArcGIS Proï¼Œå¯æŒ‰éœ€<a href="https://bertt.itch.io/arcbrutile">ä½¿ç”¨</a></p><h2 id="Mapbox"><a href="#Mapbox" class="headerlink" title="Mapbox"></a>Mapbox</h2><p>ArcGISå¯ä»¥è¿æ¥ WMTS æœåŠ¡ï¼Œå› æ­¤å¯ä»¥é€šè¿‡Mapbox Studioè‡ªå®šä¹‰åœ°å›¾ï¼Œå¹¶å‘å¸ƒåœ¨çº¿æœåŠ¡ï¼Œæä¾›ç»™ArcGISä½¿ç”¨ã€‚ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><a href="https://studio.mapbox.com/">Studio</a> ä¸­åŸºäºé»˜è®¤åœ°å›¾æ–°å»ºå¹¶ä¿®æ”¹æ ·å¼</li><li>å‘å¸ƒä¿®æ”¹åçš„åœ°å›¾ä¸º WMTS æœåŠ¡<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/MapboxShare.jpg/pic"></li><li>åœ¨ArcGISä¸­ï¼Œé€‰æ‹©æ·»åŠ WMTSæœåŠ¡<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/ArcGISWMTS.jpg/pic"><br>å°†å‘å¸ƒçš„urlæœåŠ¡åœ°å€å¡«å…¥ï¼Œç”¨æˆ·åå¯†ç ç•™ç©º<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/WMTS.jpg/pic"></li><li>åœ¨ArcGISä¸­æ’å…¥åº•å›¾<br>å°†æœåŠ¡ä¸­çš„å›¾å±‚æ‹–å…¥Layer Frameå³å¯<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/MapboxWMTS.jpg/pic"></li></ol><p>æ¨èä½¿ç”¨Mapboxåº•å›¾</p><ul><li>Mapboxåœ°å›¾åæ ‡ç³»ç»Ÿä¸ºWGS84ï¼Œæ–¹ä¾¿è½¬æ¢ä¸åŒ¹é…</li><li>æ ·å¼å¯ä»¥éšæ„æ›´æ”¹ï¼Œåº•å›¾è‡ªåŠ¨åŒæ­¥</li></ul>]]></content>
    
    
    <categories>
      
      <category>ArcGIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>BaseMap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è·¯ç½‘æ•°æ®è·å–</title>
    <link href="/2018/05/06/Traffic-%E8%B7%AF%E7%BD%91%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E4%B8%8E%E5%A4%84%E7%90%86/"/>
    <url>/2018/05/06/Traffic-%E8%B7%AF%E7%BD%91%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E4%B8%8E%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>åœ¨é“è·¯ç§»åŠ¨æºç ”ç©¶ä¸­ï¼Œè·¯ç½‘æ•°æ®è·å–ä¸å¤„ç†æ˜¯é‡è¦çš„åŸºç¡€å·¥ä½œï¼Œè·¯ç½‘çš„å‡†ç¡®ä¸è¯¦ç»†ç¨‹åº¦å†³å®šäº†æœ€ç»ˆç ”ç©¶æˆæœçš„ç©ºé—´åˆ†è¾¨ç‡ï¼Œç»è¿‡è¿™ä¹ˆå‡ å¹´è¸©å‘åï¼Œæ€»ç»“ä¸€ä¸‹è·¯ç½‘æ•°æ®è·å–ç›¸å…³ç»éªŒã€‚</p><p>ç ”ç©¶ä¸­ä½¿ç”¨çš„è·¯ç½‘æ•°æ®å¯ä»¥ç®€å•åˆ†ä¸ºåœ¨çº¿å’Œç¦»çº¿ä¸¤ç±»ï¼Œå‰è€…å¤šç”¨äºå±•ç¤ºèƒŒæ™¯å›¾ï¼Œåè€…ç”¨äºæ•°æ®åˆ†æã€‚</p><blockquote><p>æ³¨æ„ï¼šä¸€åˆ‡åœ°ç†æ•°æ®é¦–è¦è€ƒè™‘çš„æ˜¯åˆè§„æ€§ï¼ŒåŒ…æ‹¬ä¸”ä¸é™äºè·å–æ–¹å¼ï¼Œå…¬å¼€æ–¹å¼ï¼Œå†…å®¹æ ‡æ³¨ç­‰ã€‚</p></blockquote><h2 id="åœ¨çº¿"><a href="#åœ¨çº¿" class="headerlink" title="åœ¨çº¿"></a>åœ¨çº¿</h2><p>åœ¨çº¿åœ°å›¾å›½å†…å¤–éƒ½æœ‰å¾ˆå¤šæä¾›å•†ï¼Œä¸»è¦åŒºåˆ«åœ¨äºåæ ‡ä½“ç³»ä»¥åŠåœ°åŒºæ ‡æ³¨è§„èŒƒã€‚</p><h3 id="å›½å†…"><a href="#å›½å†…" class="headerlink" title="å›½å†…"></a>å›½å†…</h3><p>å›½å†…å›¾å•†åŒ…æ‹¬äº’è”ç½‘å…¬å¸å¦‚<a href="http://lbsyun.baidu.com/">ç™¾åº¦</a>ã€<a href="https://lbs.amap.com/">é«˜å¾·</a>ã€<a href="https://nglp.autoai.com/docs/websdk/summary.html">å››ç»´å›¾æ–°</a>ä»¥åŠå›½å®¶æ ‡å‡†åœ°å›¾æœåŠ¡<a href="https://www.tianditu.gov.cn/">å¤©åœ°å›¾</a>ã€‚</p><p>å—å›½å†…æµ‹ç»˜ä¿å¯†è¦æ±‚ä»¥åŠå„å®¶å…¬å¸äº§å“æ’ä»–æ€§ç­‰å› ç´ å½±å“ï¼Œè¿™äº›åœ°å›¾éƒ½æœ‰å„è‡ªæŠ•å½±åæ ‡ä½“ç³»ï¼Œå¯¹äºWGS84ä½“ç³»ä¸‹é‡‡é›†çš„æ•°æ®éœ€è¦é€šè¿‡å„è‡ªå¹³å°æä¾›çš„å¼€å‘æ¥å£è¿›è¡Œåæ ‡è½¬æ¢ï¼Œè½¬æ¢åæ‰èƒ½é¿å…åæ ‡åç§»çš„é—®é¢˜ã€‚å„ç±»åæ ‡è½¬æ¢å¯ä»¥å‚è€ƒ<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="å›½å†…åœ°å›¾åæ ‡è½¬æ¢">[1]</span></a></sup>ï¼Œå¹¶æŒ‰ç…§å„å®¶æœ€æ–°APIæ–‡æ¡£è¿›è¡Œæ“ä½œã€‚</p><h3 id="å›½å¤–"><a href="#å›½å¤–" class="headerlink" title="å›½å¤–"></a>å›½å¤–</h3><p>å›½å¤–åœ¨çº¿åœ°å›¾æ¨èä½¿ç”¨<a href="https://studio.mapbox.com/">Mapbox</a>ï¼ŒMapboxæä¾›äº†å¤šç§é¢„è®¾<a href="https://www.mapbox.com/gallery/">Style</a>ï¼Œåœ¨Studioä¸­å®šä¹‰æ˜¾ç¤ºæ ·å¼ï¼Œå‘å¸ƒåœ°å›¾åå¯ä»¥åœ¨å„ç«¯ä½¿ç”¨ã€‚Mapboxåœ°å›¾è¦ç´ ä¸»è¦æ¥æºäºOSMï¼Œåæ ‡ä½“ç³»ä¸ºWGS84ï¼Œæ›´æ–¹ä¾¿ä½¿ç”¨ã€‚</p><p>ä½†é»˜è®¤<code>Mapbox</code>åœ°å›¾å­˜åœ¨åœ°åŒºæ ‡è®°é”™è¯¯ï¼Œæ¯”å¦‚å°æ¹¾çœç­‰ï¼Œå¯¹æ­¤é—®é¢˜æ¨èä½¿ç”¨ä»¥ä¸‹é€šè¿‡ä¸­å›½æ”¿åºœå®¡æ ¸çš„åœ°å›¾stylesã€‚</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">Streetsmapbox:&#x2F;&#x2F;styles&#x2F;mapbox&#x2F;streets-zh-v1Darkmapbox:&#x2F;&#x2F;styles&#x2F;mapbox&#x2F;dark-zh-v1Lightmapbox:&#x2F;&#x2F;styles&#x2F;mapbox&#x2F;light-zh-v1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>åœ¨çº¿åœ°å›¾å¤šæ•°æƒ…å†µä¸‹æ— æ³•ä¾›åœ°ç†è¦ç´ æå–ï¼Œå› æ­¤éš¾ä»¥ç‹¬ç«‹æ“ä½œè·¯ç½‘æ•°æ®ï¼Œå¤šæ•°æƒ…å†µè¿˜æ˜¯ä½œä¸ºå¯è§†åŒ–æ—¶çš„åº•å›¾ä½¿ç”¨ã€‚</p><h2 id="ç¦»çº¿"><a href="#ç¦»çº¿" class="headerlink" title="ç¦»çº¿"></a>ç¦»çº¿</h2><p>ç¦»çº¿åœ°å›¾ä¸»è¦ä»¥shpã€GeoJsonã€CADç­‰å½¢å¼å­˜å‚¨æä¾›ï¼Œåœ¨ç ”ç©¶åˆ†æä¸­ä»¥è¿™ç±»æ•°æ®ä¸ºä¸»ã€‚</p><h3 id="æµ‹ç»˜åœ°å›¾"><a href="#æµ‹ç»˜åœ°å›¾" class="headerlink" title="æµ‹ç»˜åœ°å›¾"></a>æµ‹ç»˜åœ°å›¾</h3><p>æµ‹ç»˜ç±»åœ°å›¾æ›´å¤šæ˜¯åœ¨å„ç±»é¡¹ç›®å®æ–½ä¸­ä½¿ç”¨ï¼Œè¿™ç±»è·¯ç½‘åœ°å›¾ç‰¹ç‚¹æ˜¯è¦ç´ é½å…¨ï¼Œç»˜å›¾æ ‡å‡†ï¼Œå„ç±»æ‹“æ‰‘å†²çªå°‘ï¼Œæ ¼å¼ä»¥CADã€shpä¸ºä¸»ã€‚ä½†æ­¤ç±»åœ°å›¾æ›´æ–°å¾€å¾€è¾ƒæ…¢ï¼Œå¹¶ä¸”æœ‰è¾ƒé«˜ä¿å¯†è¦æ±‚ï¼Œå› æ­¤å¤šæ•°åœ¨é¡¹ç›®å®æ–½ä¸»ä½“å†…éƒ¨æµåŠ¨ã€‚</p><h3 id="OSMè·å–"><a href="#OSMè·å–" class="headerlink" title="OSMè·å–"></a>OSMè·å–</h3><h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><p>OpenStreetMapä½œä¸ºç›®å‰ä¸ºæ­¢æœ€ä¸ºæˆåŠŸçš„å¼€æ”¾åœ°å›¾è®¡åˆ’ï¼Œæ˜¯ç›®å‰ä¸»æµåœ°å›¾è¦ç´ çš„è·å–æºã€‚å¯ä»¥é€šè¿‡OSMè·å–ç ”ç©¶åŒºåŸŸæ‰€éœ€è·¯ç½‘è¦ç´ ï¼ŒOSMç½‘é¡µæä¾›åœ¨çº¿åŒºåŸŸé€‰å®šåŠå¯¼å‡ºæœåŠ¡ï¼Œä½†é€‰å®šèŒƒå›´æœ‰é™(nodes limit is 50000)ï¼Œè¦å®ç°å¤§èŒƒå›´ä¸‹è½½è¾ƒä¸ºå¤æ‚ï¼Œå› æ­¤æ¨èé€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å®ç°ã€‚</p><ol><li><p>Geofabrik<a href="http://download.geofabrik.de/asia/china.html">ä¸‹è½½</a>ä¸‹è½½shpã€‚ç”±äºå†…å®¹è¿‡å¤§ï¼Œç”µè„‘é…ç½®ä¸å¤Ÿè°¨æ…ä½¿ç”¨ã€‚</p></li><li><p>pbfå…¨å›¾æå–</p><ul><li>Geofabrik<a href="http://download.geofabrik.de/asia/china.html">ä¸‹è½½</a>ä¸­å›½åŒº<code>pbf</code>å†…å®¹</li><li><a href="https://www.openstreetmap.org/export#map=9/36.3914/120.3223">åœ¨æ­¤</a>é€šè¿‡<code>æ‰‹åŠ¨é€‰æ‹©ä¸åŒçš„åŒºåŸŸ</code>æ‰¾åˆ°æå–åŒºåŸŸåæ ‡èŒƒå›´</li><li>é€šè¿‡Osmosisæå–ç‰¹å®šèŒƒå›´å†…è¦ç´ ï¼Œç”Ÿæˆosmæ–‡ä»¶<div class="code-wrapper"><pre class="line-numbers language-bat" data-language="bat"><code class="language-bat">C:\Program Files (x86)\osmosis-latest\bin&gt;osmosis --read-xml file&#x3D; china-latest.osm --bounding-box left&#x3D;&quot;119.3692&quot; right&#x3D;&quot;120.9265&quot; top&#x3D;&quot;37.1362&quot; bottom&#x3D;&quot;35.5903&quot; --write-xml file&#x3D;qd.osm  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li>ArcGISä¸­é€šè¿‡å¯¹åº”ç‰ˆæœ¬<a href="https://www.esri.com/en-us/arcgis/products/arcgis-editor-for-openstreetmap"><code>Arcgis Editor For OSM</code></a>å·¥å…·ç®±æ‰“å¼€å¹¶è½¬æ¢ä¸ºshp</li></ul></li><li><p>bbbike<a href="https://extract.bbbike.org/">ä¸‹è½½</a>é€‰å®šåŒºåŸŸä¸‹è½½shpæ–‡ä»¶ã€‚</p></li><li><p>Overpass API</p><ul><li><a href="http://www.overpass-api.de/query_form.html">åœ¨æ­¤</a>çš„<code>Overpass API Query Form</code>å¡«å…¥æŸ¥è¯¢ä»£ç ï¼Œç‚¹å‡»Queryä¿å­˜Interpreteræ–‡ä»¶<div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>osm-script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>query</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>relation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>has-kv</span> <span class="token attr-name">k</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boundary<span class="token punctuation">"</span></span> <span class="token attr-name">v</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>administrative<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>has-kv</span> <span class="token attr-name">k</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name:zh<span class="token punctuation">"</span></span> <span class="token attr-name">v</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>å¤©æ´¥å¸‚<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>query</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>print</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>osm-script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>æ‰“å¼€Interpreteræ–‡ä»¶ï¼Œå°†å…¶ä¸­<code>&lt;area-query ref=&quot;&quot;/&gt;</code>çš„refå€¼åŠ ä¸Š360000000ï¼Œå°†ä»¥ä¸‹å†…å®¹å¡«å…¥<code>Overpass API Query Form</code>ï¼Œå†æ¬¡Queryï¼Œä¿å­˜æ–‡ä»¶å°±æ˜¯è·¯ç½‘osmæ–‡ä»¶<div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>osm-script</span> <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1800<span class="token punctuation">"</span></span> <span class="token attr-name">element-limit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100000000<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>union</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>area-query</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>åŸå§‹å€¼åŠ 360000000<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recurse</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>node-relation<span class="token punctuation">"</span></span> <span class="token attr-name">into</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rels<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recurse</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>node-way<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recurse</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>way-relation<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>union</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>union</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recurse</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>way-node<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>union</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>print</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>osm-script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>ArcGISä¸­é€šè¿‡å¯¹åº”ç‰ˆæœ¬<a href="https://www.esri.com/en-us/arcgis/products/arcgis-editor-for-openstreetmap"><code>Arcgis Editor For OSM</code></a>å·¥å…·ç®±æ‰“å¼€å¹¶è½¬æ¢ä¸ºshp<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ä»Openstreetmapè·å–è·¯ç½‘æ•°æ®å¹¶åˆ¶ä½œshapefileå›¾å±‚">[2]</span></a></sup></li></ul></li></ol><p>é€šè¿‡é€‰å®šåŒºåŸŸä¸‹è½½è·¯ç½‘æ•°æ®çš„æ–¹æ³•ï¼Œè·å–åˆ°çš„è·¯ç½‘å®¹æ˜“å­˜åœ¨é£çº¿ï¼ˆæŸäº›é“è·¯ä¼šå˜æˆä¸€æ ¹é•¿åº¦å¼‚å¸¸çš„ç›´çº¿ï¼‰ï¼Œå¯¹äºè¿™äº›å¼‚å¸¸çº¿æ®µï¼Œé€šè¿‡ç‰¹å¾é•¿åº¦è¿›è¡Œç­›é€‰å¹¶åˆ é™¤å³å¯ã€‚</p><h4 id="é“è·¯ç±»å‹"><a href="#é“è·¯ç±»å‹" class="headerlink" title="é“è·¯ç±»å‹"></a>é“è·¯ç±»å‹</h4><p>OSMè·¯ç½‘ä¸‹è½½åï¼Œå±æ€§è¡¨å­—æ®µfclasså¯ä»¥ç”¨äºåŒºåˆ†é“è·¯ç±»å‹<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="ArcGISè·¯ç½‘åˆ†æä¹‹OSMè·¯ç½‘æ•°æ®è·å–">[3]</span></a></sup>ã€‚<br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/OSMType.webp"></p><h4 id="è½¦é€Ÿå¯¹åº”"><a href="#è½¦é€Ÿå¯¹åº”" class="headerlink" title="è½¦é€Ÿå¯¹åº”"></a>è½¦é€Ÿå¯¹åº”</h4><p>é“è·¯ç±»å‹ä¸è½¦é€Ÿå¯¹åº”å…³ç³»<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="openstreetmapé“è·¯ç½‘æ•°æ®å¯¹åº”ä¸­å›½é“è·¯é€Ÿåº¦â€”â€”æ­¦æ±‰">[4]</span></a></sup>ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&quot;highway&quot; å­—æ®µï¼Œä¸­è‹±å¯¹ç…§åŠé€Ÿåº¦ï¼ˆkm&#x2F;hï¼‰   &#39;bridleway&#39; é©¬é“  10   &#39;construction&#39; å»ºè®¾ä¸­ 0   &#39;cycleway&#39; è‡ªè¡Œè½¦é“ 15   &#39;footway&#39; æ­¥è¡Œ 5   &#39;living_street&#39; è¡—åŒº 5   &#39;motorway&#39; é«˜é€Ÿå…¬è·¯  50   &#39;motorway_link&#39; é«˜é€Ÿå…¬è·¯è¿æ¥å¤„  50    &#39;path&#39; è·¯ 5   &#39;pedestrian&#39; äººè¡Œé“ 5   &#39;platform&#39; æœˆå° 5   &#39;primary&#39; ä¸»å¹²é“ 40   &#39;primary_link&#39;  ä¸»å¹²é“è¿æ¥å¤„ 40    &#39;raceway&#39; èµ›é“ 30   &#39;residential&#39;  å±…ä½åŒºé“è·¯ 5   &#39;road&#39; æ‰€æœ‰ä¸çŸ¥åçš„é“è·¯ 10   &#39;secondary&#39;  æ¬¡å¹²é“ 30   &#39;secondary_link&#39;  æ¬¡å¹²é“è¿æ¥å¤„ 30   &#39;service&#39; é€šå¾€è®¾æ–½çš„é“è·¯ 10   &#39;steps&#39;  é˜¶æ¢¯ 5    &#39;tertiary&#39; ä¸‰çº§é“è·¯ 10   &#39;tertiary_link&#39; ä¸‰çº§é“è·¯è¿æ¥å¤„ 10   &#39;track&#39; è½¨é“ 5   &#39;trunk&#39; æ”¯è·¯ 50   &#39;trunk_link&#39; æ”¯è·¯é“¾æ¥å¤„ 50   &#39;unclassified&#39; æœªåˆ†ç±»é“è·¯ 20&quot;railway&quot; å­—æ®µï¼Œä¸­è‹±å¯¹ç…§åŠé€Ÿåº¦ï¼ˆkm&#x2F;hï¼‰   &#39;subway&#39; åœ°é“ 50   &#39;rail&#39;  ç«è½¦  40<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><p>OSMè¿˜é€šè¿‡å­é¡¹ç›®å½¢å¼å®Œå–„ç‰¹æ®Šé“è·¯ç±»å‹æ•°æ®</p><ul><li><a href="https://wiki.openstreetmap.org/wiki/China_Railways">ä¸­å›½é“è·¯é¡¹ç›®</a></li><li><a href="https://wiki.openstreetmap.org/wiki/China_National_Highway">ä¸­å›½å›½é“é¡¹ç›®</a></li><li><a href="https://wiki.openstreetmap.org/wiki/Expressways_of_China">ä¸­å›½é«˜é€Ÿé¡¹ç›®</a></li></ul><h3 id="GRIPè·å–"><a href="#GRIPè·å–" class="headerlink" title="GRIPè·å–"></a>GRIPè·å–</h3><p>é™¤äº†ç»†ç²’åº¦è·¯ç½‘ï¼Œè¿˜å¯ä»¥<a href="https://www.globio.info/download-grip-dataset">GRIP</a>é¡¹ç›®è·å–è·¯ç½‘æ•°æ®ã€‚</p><blockquote><p>The Global Roads Inventory Project (GRIP) dataset was developed to provide a more recent and consistent global roads dataset for use in global environmental and biodiversity assessment models like GLOBIO.</p></blockquote><p>ä»¥ç½‘æ ¼çš„å½¢å¼æä¾›é“è·¯æ¸…å•ï¼Œå¯ä¸‹è½½çŸ¢é‡shpæ ¼å¼æˆ–rasteræ ¼å¼ï¼Œå¯¹äºå¤§å°ºåº¦ç ”ç©¶ï¼Œè¿™ä¸ªé¡¹ç›®æä¾›äº†è¾ƒå¥½çš„æ•°æ®æ”¯æ’‘ã€‚</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://mattzou.com/2019/03/25/Python-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/">å›½å†…åœ°å›¾åæ ‡è½¬æ¢</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/141740446">ä»Openstreetmapè·å–è·¯ç½‘æ•°æ®å¹¶åˆ¶ä½œshapefileå›¾å±‚</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.bilibili.com/read/cv9256335/">ArcGISè·¯ç½‘åˆ†æä¹‹OSMè·¯ç½‘æ•°æ®è·å–</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.csdn.net/u011994016/article/details/56831190">openstreetmapé“è·¯ç½‘æ•°æ®å¯¹åº”ä¸­å›½é“è·¯é€Ÿåº¦â€”â€”æ­¦æ±‰</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>äº¤é€š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>è·¯ç½‘</tag>
      
      <tag>OSM</tag>
      
      <tag>Mapbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é«˜å¾·åœ°å›¾è·å–å¤©æ´¥é“è·¯äº¤é€šæ€åŠ¿</title>
    <link href="/2016/12/23/Traffic-%E4%BA%A4%E9%80%9A%E6%80%81%E5%8A%BF/"/>
    <url>/2016/12/23/Traffic-%E4%BA%A4%E9%80%9A%E6%80%81%E5%8A%BF/</url>
    
    <content type="html"><![CDATA[<blockquote><p>é“è·¯çŠ¶æ€</p></blockquote><span id="more"></span><h2 id="è·å–çŸ©å½¢åŒºåŸŸå†…é“è·¯äº¤é€šçŠ¶æ€"><a href="#è·å–çŸ©å½¢åŒºåŸŸå†…é“è·¯äº¤é€šçŠ¶æ€" class="headerlink" title="è·å–çŸ©å½¢åŒºåŸŸå†…é“è·¯äº¤é€šçŠ¶æ€"></a>è·å–çŸ©å½¢åŒºåŸŸå†…é“è·¯äº¤é€šçŠ¶æ€</h2><p>è¯¦ç»†è¯´æ˜è¯·é˜…è¯»å®˜æ–¹è¯´æ˜æ–‡æ¡£<a href="https://lbs.amap.com/api/webservice/guide/api/trafficstatus">äº¤é€šæ€åŠ¿</a></p><h3 id="èŒƒå›´ç»çº¬åº¦"><a href="#èŒƒå›´ç»çº¬åº¦" class="headerlink" title="èŒƒå›´ç»çº¬åº¦"></a>èŒƒå›´ç»çº¬åº¦</h3><p>çŸ©å½¢èŒƒå›´éœ€è¦ç”¨é«˜å¾·åæ ‡æè¿°ï¼Œé€šè¿‡<code>JS API</code>çš„<a href="https://developer.amap.com/demo/javascript-api/example/map/click-to-get-lnglat">è·å–é¼ æ ‡ç‚¹å‡»ç»çº¬åº¦</a>åŠŸèƒ½å¾—åˆ°å·¦ä¸‹åŠå³ä¸Šåæ ‡ã€‚<br><strong>æ³¨æ„ï¼šçŸ©å½¢å¯¹è§’çº¿ä¸èƒ½è¶…è¿‡10å…¬é‡Œ</strong></p><h3 id="è¯·æ±‚è¯´æ˜"><a href="#è¯·æ±‚è¯´æ˜" class="headerlink" title="è¯·æ±‚è¯´æ˜"></a>è¯·æ±‚è¯´æ˜</h3><p>è¯·æ±‚å¦‚ä¸‹ï¼š<br><a href="https://restapi.amap.com/v3/traffic/status/rectangle?rectangle=117.670834,38.919082;117.733319,38.988499&amp;extensions=all&amp;levels=1&amp;key=xxxxxxx">https://restapi.amap.com/v3/traffic/status/rectangle?rectangle=117.670834,38.919082;117.733319,38.988499&amp;extensions=all&amp;levels=1&amp;key=xxxxxxx</a></p><ul><li>å…¶ä¸­<code>rectangle</code>ä¸ºçŸ©å½¢åŒºåŸŸèŒƒå›´ï¼Œå¯¹è§’åæ ‡ç”¨<code>;</code>éš”å¼€</li><li><code>levels</code>æŒ‡å®šé“è·¯ç­‰çº§ï¼Œä¸‹é¢å„å€¼ä»£è¡¨çš„å«ä¹‰ï¼š<div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">1ï¼šé«˜é€Ÿï¼ˆäº¬è—é«˜é€Ÿï¼‰2ï¼šåŸå¸‚å¿«é€Ÿè·¯ã€å›½é“(è¥¿ä¸‰ç¯ã€103å›½é“)3ï¼šé«˜é€Ÿè¾…è·¯ï¼ˆG6è¾…è·¯ï¼‰4ï¼šä¸»è¦é“è·¯ï¼ˆé•¿å®‰è¡—ã€ä¸‰ç¯è¾…è·¯è·¯ï¼‰5ï¼šä¸€èˆ¬é“è·¯ï¼ˆå½©å’ŒåŠè·¯ï¼‰6ï¼šæ— åé“è·¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><code>key</code>éœ€è¦è‡ªå·±æ³¨å†Œç”³è¯·<br>  <strong>è¯´æ˜ï¼šäº¤é€šæ€åŠ¿æ¥å£è®¡åˆ’å°†äº2020å¹´12æœˆ31æ—¥ä¸‹çº¿ï¼Œç›®å‰ä¸å†å¯¹æ–°ç”¨æˆ·å¼€æ”¾ã€‚å¦‚éœ€åˆä½œè¯·é€šè¿‡</strong><a href="https://console.amap.com/dev/ticket/type/others"><strong>å·¥å•</strong></a><strong>è¿›è¡Œå•†åŠ¡å’¨è¯¢ã€‚</strong></li><li>è¿”å›ç»“æœä¸º<code>json</code>æ ¼å¼</li></ul><h3 id="ç»“æœå­˜å‚¨"><a href="#ç»“æœå­˜å‚¨" class="headerlink" title="ç»“æœå­˜å‚¨"></a>ç»“æœå­˜å‚¨</h3><p>ç¯å¢ƒï¼š<code>R</code>ï¼Œ<code>Rstudio</code><br>Libraryï¼š<code>curl</code></p><ol><li><p>å—çŸ©å½¢èŒƒå›´é™å®šï¼Œéœ€è¦å°†ç›®æ ‡åŒºåŸŸåˆ†å‰²æˆå¤šå—çŸ©å½¢ï¼Œåˆ†åˆ«è¿›è¡Œè·å–ã€‚åˆ›å»º<code>tjarea.csv</code>æ–‡ä»¶ä¿å­˜æ¯å—åŒºåŸŸçš„è¯·æ±‚åœ°å€ã€‚æ¯ä¸ªåœ°å€ä¸€è¡Œï¼Œæ— éœ€è¡¨å¤´ã€‚</p></li><li><p>å»ºç«‹<code>tj_traffic.r</code>è„šæœ¬ï¼Œæ¯10åˆ†é’Ÿä¸€æ¬¡è¯·æ±‚ï¼Œä¿å­˜jsonæ–‡ä»¶åˆ°æœ¬åœ°</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>curl<span class="token punctuation">)</span>  setwd<span class="token punctuation">(</span><span class="token string">"E:/"</span><span class="token punctuation">)</span>  Url <span class="token operator">=</span> read.csv<span class="token punctuation">(</span><span class="token string">"E:/TRAFFIC/tjarea.csv"</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>  mytime <span class="token operator">=</span> Sys.time<span class="token punctuation">(</span><span class="token punctuation">)</span>  mydate <span class="token operator">=</span> format<span class="token punctuation">(</span>mytime<span class="token punctuation">,</span><span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>  dir.create<span class="token punctuation">(</span>mydate<span class="token punctuation">)</span>  nowhour <span class="token operator">=</span> substr<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>Sys.time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span>  nowmin <span class="token operator">=</span> substr<span class="token punctuation">(</span>as.character<span class="token punctuation">(</span>Sys.time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>  min <span class="token operator">=</span>     switch <span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>nowmin<span class="token punctuation">)</span><span class="token percent-operator operator">%/%</span><span class="token number">10</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>    <span class="token string">"00"</span><span class="token punctuation">,</span>           <span class="token string">"10"</span><span class="token punctuation">,</span>    <span class="token string">"20"</span><span class="token punctuation">,</span>    <span class="token string">"30"</span><span class="token punctuation">,</span>    <span class="token string">"40"</span><span class="token punctuation">,</span>    <span class="token string">"50"</span>  <span class="token punctuation">)</span>    dir.create<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>mydate<span class="token punctuation">,</span><span class="token string">"/"</span><span class="token punctuation">,</span>nowhour<span class="token punctuation">,</span>min<span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    tempdir <span class="token operator">=</span> paste<span class="token punctuation">(</span>mydate<span class="token punctuation">,</span><span class="token string">"/"</span><span class="token punctuation">,</span>nowhour<span class="token punctuation">,</span>min<span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">315</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    url <span class="token operator">=</span> as.character<span class="token punctuation">(</span>Url<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dir <span class="token operator">=</span> paste<span class="token punctuation">(</span><span class="token string">"E:/TRAFFIC/TJTRAFFIC/"</span><span class="token punctuation">,</span>tempdir<span class="token punctuation">,</span><span class="token string">"/tj_"</span><span class="token punctuation">,</span> as.character<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">".json"</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    curl_download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> dir<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p>å»ºç«‹<code>bat</code>æ–‡ä»¶ï¼Œç”¨äºè®¾ç½®Windowså®šæ—¶ä»»åŠ¡ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-batch" data-language="batch"><code class="language-batch"><span class="token command"><span class="token keyword">Rscript</span> <span class="token parameter attr-name">-e</span> <span class="token string">"source(\"E:/TJTRAFFIC/tj_traffic.R/"</span>,encoding = 'UTF<span class="token number">-8</span>'</span><span class="token punctuation">)</span>"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ol><h3 id="Jsonè§£æ"><a href="#Jsonè§£æ" class="headerlink" title="Jsonè§£æ"></a>Jsonè§£æ</h3><p>Libraryï¼š<code>rjson</code>,<code>xlsx</code><br>è§£æjsonæ–‡ä»¶ä¸­çš„roadinfoï¼Œå…¶ä¸­åŒ…å«å¤šæ¡é“è·¯æ•°æ®ï¼Œç”¨rbindæ‹¼æ¥å¹¶æ·»åŠ timestampï¼Œæ·»åŠ è·¯åä¸æè¿°ç»„æˆçš„å”¯ä¸€å­—æ®µï¼Œæ¯å°æ—¶è¾“å‡ºä¸€ä¸ªæ–‡ä»¶xlsx</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">Sys.setenv<span class="token punctuation">(</span>JAVA_HOME<span class="token operator">=</span><span class="token string">"C:/Program Files/Java/jre1.8.0\_111"</span><span class="token punctuation">)</span>   library<span class="token punctuation">(</span>rjson<span class="token punctuation">)</span>  library<span class="token punctuation">(</span>dplyr<span class="token punctuation">)</span>  library<span class="token punctuation">(</span>xlsx<span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®å·¥ä½œç›®å½•  </span>setwd<span class="token punctuation">(</span><span class="token string">"E:/TJTRAFFIC/"</span><span class="token punctuation">)</span> <span class="token comment"># è¯»å–æ¨¡æ¿</span>roadtraffic <span class="token operator">=</span> readRDS<span class="token punctuation">(</span><span class="token string">"roadtraffic.rds"</span><span class="token punctuation">)</span>  <span class="token comment">#æ—¥æœŸå¾ªç¯</span><span class="token keyword">for</span> <span class="token punctuation">(</span>date <span class="token keyword">in</span> <span class="token number">20161122</span><span class="token operator">:</span><span class="token number">20161123</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>hour <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">195</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tryCatch<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>              result <span class="token operator">=</span> fromJSON<span class="token punctuation">(</span>file <span class="token operator">=</span> paste<span class="token punctuation">(</span>                date<span class="token punctuation">,</span><span class="token string">"/"</span><span class="token punctuation">,</span>formatC<span class="token punctuation">(</span>hour<span class="token punctuation">,</span>width <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>flag <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token string">"0/tj\_"</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">".json"</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span>              <span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token operator">$</span>status <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                roads <span class="token operator">=</span> result<span class="token operator">$</span>trafficinfo<span class="token operator">$</span>roads                temp <span class="token operator">=</span> do.call<span class="token punctuation">(</span>rbind<span class="token punctuation">,</span>roads<span class="token punctuation">)</span>                temp <span class="token operator">=</span> as.data.frame<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>                strtime <span class="token operator">=</span> paste<span class="token punctuation">(</span>                  date<span class="token punctuation">,</span>formatC<span class="token punctuation">(</span>hour<span class="token punctuation">,</span>width <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>flag <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token string">"000"</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span>                <span class="token punctuation">)</span>                temp <span class="token operator">=</span> mutate<span class="token punctuation">(</span>temp<span class="token punctuation">,</span>timestamp <span class="token operator">=</span> strtime<span class="token punctuation">)</span>                roadtraffic <span class="token operator">=</span> rbind.data.frame<span class="token punctuation">(</span>roadtraffic<span class="token punctuation">,</span>temp<span class="token punctuation">)</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>              <span class="token punctuation">,</span>error<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token keyword">NULL</span>             <span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      roadtraffic <span class="token operator">=</span> mutate<span class="token punctuation">(</span>roadtraffic<span class="token punctuation">,</span> fullname <span class="token operator">=</span> paste<span class="token punctuation">(</span>name<span class="token punctuation">,</span>direction<span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      write.xlsx2<span class="token punctuation">(</span>roadtraffic<span class="token punctuation">,</span>paste<span class="token punctuation">(</span><span class="token string">"excel/"</span><span class="token punctuation">,</span>date<span class="token punctuation">,</span>formatC<span class="token punctuation">(</span>hour<span class="token punctuation">,</span>width <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>flag <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">".xlsx"</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> collapse <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> row.name <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>      roadtraffic <span class="token operator">=</span> readRDS<span class="token punctuation">(</span><span class="token string">"roadtraffic.rds"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>äº¤é€š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é«˜å¾·API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>R è¿æ¥Oracleæ•°æ®åº“</title>
    <link href="/2016/12/06/R-Oracle/"/>
    <url>/2016/12/06/R-Oracle/</url>
    
    <content type="html"><![CDATA[<p>åœ¨åˆ†æä»»åŠ¡ä¸­ï¼Œéœ€è¦å°†Oracleä¸­éƒ¨åˆ†æ•°æ®æå–å‡ºæ¥ï¼Œåœ¨Rä¸­è¿›è¡Œè¿›ä¸€æ­¥åˆ†æå¤„ç†ã€‚<br>Rä¸»è¦æœ‰ä¸‰ç§æ–¹å¼è¿æ¥æ“ä½œOracleï¼š</p><ul><li>RODBC</li><li>ROracle</li><li>RJDBC<br>å…¶ä¸­RJDBCåœ¨æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§ä¸Šéƒ½å…·æœ‰æ˜æ˜¾çš„å±€é™æ€§ï¼ŒåŸºæœ¬ä¸å†æ¨èä½¿ç”¨ã€‚</li></ul><h2 id="RODBC"><a href="#RODBC" class="headerlink" title="RODBC"></a>RODBC</h2><p>RODBCæ˜¯ä¸€ä¸ªå®ç°ODBCæ•°æ®åº“è¿æ¥çš„RåŒ…ï¼Œé€šè¿‡ODBCæ–¹å¼åŠå‡½æ•°è®¿é—®æ•°æ®åº“ï¼Œå¹¶å°†æ•°æ®åº“è¡¨å†…å®¹è½¬åŒ–ä¸ºRå¯¹è±¡ï¼Œæ”¯æŒsqlæ“ä½œï¼Œç”ŸæˆRå¯¹è±¡ä¸ºdataframeç±»å‹ã€‚</p><p>è¦ä¿è¯RODBCä½¿ç”¨ï¼Œéœ€è¦åœ¨ç³»ç»Ÿä¸­é…ç½®å¥½ODBCè¿æ¥ï¼Œåœ¨Windowsç³»ç»Ÿä¸‹é…ç½®æ–¹æ³•</p><ol><li><a href="https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html">ä¸‹è½½</a>é©±åŠ¨åŒ…ï¼ŒåŒ…æ‹¬baseåŒ…å’ŒODBCåŒ…ï¼Œåˆ†åˆ«<code>instantclient-basic-</code>å’Œ<code>instantclient-odbc-</code>å¼€å¤´ï¼Œå¹¶ä¿è¯ç‰ˆæœ¬ä¸€è‡´ã€‚</li><li>è§£å‹ä¸Šé¢ä¸¤ä¸ªåŒ…ï¼ŒæŠŠè§£å‹åçš„æ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ï¼Œè¿è¡Œ<strong>odbc_install.exe</strong>å®‰è£…</li><li>åœ¨<code>ODBCæ•°æ®æºç®¡ç†å™¨</code>ä¸­è¿›è¡Œ<code>Oracle ODBC Driver Configuration</code><br>æ›´å¤šå†…å®¹å‚è§<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Windows Oracle ODBCå®‰è£…é…ç½®">[1]</span></a></sup></li></ol><p>RODBCä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼Œå¯¹äºæ•°æ®å¯¼å‡ºä»»åŠ¡ï¼ŒRODBCæ˜¯å¾ˆä¾¿æ·çš„å®ç°æ–¹å¼ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>RODBC<span class="token punctuation">)</span>   <span class="token comment"># åˆ›å»ºè¿æ¥</span>con <span class="token operator">&lt;-</span> odbcConnect<span class="token punctuation">(</span><span class="token string">"ora"</span><span class="token punctuation">,</span> uid<span class="token operator">=</span><span class="token string">"orcl"</span><span class="token punctuation">,</span> pwd<span class="token operator">=</span><span class="token string">"pw"</span><span class="token punctuation">,</span> rows_at_time <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">)</span>   <span class="token comment"># å†™å…¥è¡¨æ•°æ®</span>sqlSave<span class="token punctuation">(</span>con<span class="token punctuation">,</span> test_table<span class="token punctuation">,</span> <span class="token string">"TEST_TABLE"</span><span class="token punctuation">)</span>   <span class="token comment"># æ‰§è¡ŒæŸ¥è¯¢</span>sqlQuery<span class="token punctuation">(</span>con<span class="token punctuation">,</span> <span class="token string">"select count(*) from TEST_TABLE"</span><span class="token punctuation">)</span>   <span class="token comment"># è¾“å‡ºè¡¨æ•°æ®</span>date <span class="token operator">&lt;-</span> sqlQuery<span class="token punctuation">(</span>con<span class="token punctuation">,</span> <span class="token string">"select * from TEST_TABLE"</span><span class="token punctuation">)</span>   <span class="token comment"># å…³é—­è¿æ¥</span>   close<span class="token punctuation">(</span>con<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="ROracle"><a href="#ROracle" class="headerlink" title="ROracle"></a>ROracle</h2><p>ROracleåŸºäºé«˜æ€§èƒ½OCIåº“ï¼Œå®ç°Rä¸Oracleé«˜æ€§èƒ½è¿æ¥ï¼Œå¹¶æ”¯æŒäº‹åŠ¡çº§åˆ«çš„æ§åˆ¶å’Œç”¨æˆ·æä¾›çš„SQLè¯­å¥çš„æ‰§è¡Œ<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ROracle is an Open Source R Package available on CRAN">[2]</span></a></sup>ã€‚<br>ROracleä¾èµ–<code>data.table</code>åŒ…ï¼Œéœ€æå‰å®‰è£…ã€‚</p><p>ROracleé…ç½®æ–¹å¼</p><ol><li>æ ¹æ®æ•°æ®åº“ç‰ˆæœ¬ï¼Œå¯¹åº”å®‰è£…<a href="www.oracle.com/technetwork/database/enterprise-edition/downloads/112010-win64soft-094461.html">Oracle Instant Client</a></li><li>ç³»ç»Ÿç¯å¢ƒå˜é‡æ·»åŠ ä¸¤ä¸ªï¼šOCI_INCä»¥åŠOCI_LIB64ï¼Œåˆ†åˆ«å¯¹åº”Clientç›®å½•ä¸‹<code>\oci\include</code>å’Œ<code>\BIN</code></li><li>å®‰è£…ROracleåŒ…</li></ol><p>ROracle è¿æ¥ä½¿ç”¨å¦‚ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-r" data-language="r"><code class="language-r">library<span class="token punctuation">(</span>ROracle<span class="token punctuation">)</span>library<span class="token punctuation">(</span>DBI<span class="token punctuation">)</span>drv <span class="token operator">&lt;-</span>dbDriver<span class="token punctuation">(</span><span class="token string">"Oracle"</span><span class="token punctuation">)</span>con.string <span class="token operator">&lt;-</span> '<span class="token punctuation">(</span>DESCRIPTION <span class="token operator">=</span><span class="token punctuation">(</span>ADDRESS <span class="token operator">=</span> <span class="token punctuation">(</span>PROTOCOL <span class="token operator">=</span> TCP<span class="token punctuation">)</span><span class="token punctuation">(</span>HOST <span class="token operator">=</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>PORT <span class="token operator">=</span> <span class="token number">1521</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>CONNECT_DATA <span class="token operator">=</span><span class="token punctuation">(</span>SERVER <span class="token operator">=</span> server<span class="token punctuation">)</span><span class="token punctuation">(</span>SERVICE_NAME <span class="token operator">=</span> orcl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>'        con <span class="token operator">&lt;-</span> dbConnect<span class="token punctuation">(</span>drv<span class="token punctuation">,</span> username <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span> password <span class="token operator">=</span> <span class="token string">"pw"</span><span class="token punctuation">,</span> dbname <span class="token operator">=</span> con.string<span class="token punctuation">)</span>rs <span class="token operator">&lt;-</span> dbSendQuery<span class="token punctuation">(</span>con<span class="token punctuation">,</span><span class="token string">"select * from TEST_TABLE"</span><span class="token punctuation">)</span>data <span class="token operator">&lt;-</span> fetch<span class="token punctuation">(</span>rs<span class="token punctuation">)</span>dbDisconnect<span class="token punctuation">(</span>con<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h2><p>æ ¹æ®ROracleå®˜æ–¹æ–‡æ¡£æè¿°ï¼Œå…¶æ€§èƒ½æ˜¯æœ€å¥½çš„<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="ROracle Package">[3]</span></a></sup>ã€‚æ›´ä¸ºè¯¦ç»†çš„è¯„æµ‹å¯è§æ­¤blog<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="R to Oracle Database Connectivity: Use ROracle for both Performance and Scalability">[4]</span></a></sup><br><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/index_img/Roracle.jpg/pic"></p><p>æ€»ä¹‹ï¼ŒROracleä¼˜åŠ¿åœ¨äºå…¶å¯¹åº”Rçš„å¯¹è±¡ä¸ºdata.tableï¼Œå¹¶ä¸”æ”¯æŒæ•°æ®ç±»å‹åŒæ­¥ï¼Œé¿å…äº†å¾ˆå¤šè·¨å¹³å°è½¬åŒ–çš„é—®é¢˜ï¼Œåœ¨å¤§æ•°æ®é‡çš„æƒ…å†µä¸‹æ¨èä½¿ç”¨ã€‚RODBCåœ¨å„ç§å¹³å°ä¸Šé…ç½®å¯èƒ½ä¼šæœ‰è®¸å¤šå›°éš¾ï¼Œå› æ­¤åœ¨æœ‰é…ç½®å¥½ODBCç¯å¢ƒä¸‹ï¼Œå°æ•°æ®é‡æ•°æ®ä¼ è¾“æ“ä½œå¯ä»¥ä½¿ç”¨RODBCã€‚æˆ‘è®¸å¤šè®¡ç®—éƒ½æ˜¯åœ¨æ•°æ®åº“å®Œæˆï¼ŒRå’ŒOracleäº¤äº’ä¸»è¦æ˜¯å®ç°å¯è§†åŒ–ï¼Œæ•°æ®é‡ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ä½¿ç”¨RODBCã€‚</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/shelvenn/p/3799849.html">Windows Oracle ODBCå®‰è£…é…ç½®</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.oracle.com/database/technologies/appdev/roracle.html">ROracle is an Open Source R Package available on CRAN</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.oracle.com/technetwork/database/database-technologies/r/roracle/201403-roracle-2167267.pdf">ROracle Package</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blogs.oracle.com/r/r-to-oracle-database-connectivity%3a-use-roracle-for-both-performance-and-scalability">R to Oracle Database Connectivity: Use ROracle for both Performance and Scalability</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle</tag>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS è·¯ç½‘ç½‘æ ¼åˆ’åˆ†</title>
    <link href="/2016/10/17/ArcGIS-%E8%B7%AF%E7%BD%91%E5%88%87%E5%88%86/"/>
    <url>/2016/10/17/ArcGIS-%E8%B7%AF%E7%BD%91%E5%88%87%E5%88%86/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å·²æœ‰ç½‘æ ¼çš„æƒ…å†µä¸‹ï¼Œç”¨ç½‘æ ¼å°†é“è·¯åˆ‡æ–­ï¼Œä»¥ä¾¿å»ºç«‹é“è·¯å’Œç½‘æ ¼çš„å¯¹åº”å…³ç³»ã€‚</p><span id="more"></span><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>ç°æœ‰åŒ—äº¬<a href="https://mattzou.com/2016/02/28/ArcGIS-Fishnet/#">ç½‘æ ¼å›¾å±‚ï¼ˆçº¿è¦ç´ ï¼‰</a>ä»¥åŠåŒ—äº¬<strong>è·¯ç½‘å›¾å±‚</strong>ï¼Œè¦ç”¨ç½‘æ ¼çº¿åˆ‡åˆ†é“è·¯ã€‚</p><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>å°†ç½‘æ ¼å›¾å±‚ä¸­çš„å…¨éƒ¨è¦ç´ å¤åˆ¶åˆ°è·¯ç½‘å›¾å±‚ï¼Œé€‰ç”¨<code> Planarize Lines</code>å·¥å…·ï¼Œå°†ç›¸äº¤çº¿æ‰“æ–­ï¼Œå®Œæˆåˆ‡åˆ†åé€šè¿‡è¦ç´ ç­›é€‰ï¼Œå°†å‚ä¸åˆ‡åˆ†çš„ç½‘æ ¼çº¿åˆ é™¤ï¼Œå‰©ä¸‹çš„è·¯ç½‘å°±æ˜¯åˆ‡åˆ†å¥½çš„äº†ï¼Œæ¥ç€é€šè¿‡<a href="https://mattzou.com/2016/03/03/ArcGIS-%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84/#">è¦ç´ æ˜ å°„</a>å»ºç«‹é“è·¯ä¸ç½‘æ ¼çš„æ˜ å°„å…³ç³»ï¼Œé“è·¯ç½‘æ ¼åˆ’åˆ†å°±å®Œæˆäº†ã€‚ </p><h3 id="å·¥å…·ä½ç½®"><a href="#å·¥å…·ä½ç½®" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p>å›¾å±‚è¿›å…¥ç¼–è¾‘çŠ¶æ€åï¼Œ<strong>Advanced Editing</strong> å·¥å…·æ ä¸Šï¼Œç‚¹å‡»å³è¿è¡Œã€‚</p><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/%E8%B7%AF%E7%BD%91%E5%88%87%E5%88%861.jpg/pic" alt="è·¯ç½‘åˆ‡åˆ† 1"> </p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p>1.åœ¨<strong>è·¯ç½‘å›¾å±‚</strong>ä¸Š<a href="http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#/na/01m60000005p000000/">å¯åŠ¨ç¼–è¾‘</a>;</p><p>2.<a href="resources.arcgis.com/zh-cn/help/main/10.2/index.html#/na/00s50000000w000000/">å…¨é€‰</a><strong>ç½‘æ ¼å›¾å±‚</strong>è¦ç´ ï¼Œ<code> Ctrl + C</code> ï¼Œç„¶å<code>Ctrl + V</code> åˆ°<strong>è·¯ç½‘å›¾å±‚</strong>;</p><p>3.åœ¨åˆå¹¶ç”Ÿæˆçš„æ–°è·¯ç½‘å›¾å±‚ä¸­å…¨é€‰è¦ç´ ï¼Œåœ¨<strong>Advanced Editing</strong> å·¥å…·æ ä¸Šç‚¹å‡»<a href="http://resources.arcgis.com/en/help/main/10.2/index.html#//01m800000012000000/">Planarize Lines</a>å·¥å…·ï¼›</p><p>4.æ‰“å¼€åˆ‡åˆ†å®Œæˆåçš„å›¾å±‚å±æ€§è¡¨ï¼Œé€šè¿‡ç½‘æ ¼å›¾å±‚ç‰¹æœ‰å±æ€§ï¼Œç”¨<a href="http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#/na/00s500000021000000/">æŒ‰å±æ€§é€‰æ‹©</a>æ–¹æ³•ï¼Œå°†ç½‘æ ¼çº¿è¦ç´ é€‰å‡ºï¼Œå¹¶åˆ é™¤ï¼Œå‰©ä¸‹çš„å°±æ˜¯åˆ‡åˆ†å¥½çš„è·¯ç½‘ï¼›</p><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><blockquote><p>é“è·¯å‡åœ¨ç½‘æ ¼çº¿å¤„è¢«æˆªæ–­ï¼š</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/%E8%B7%AF%E7%BD%91%E5%88%87%E5%88%862.jpg/pic" alt="è·¯ç½‘åˆ‡åˆ† 2"></p><hr>]]></content>
    
    
    <categories>
      
      <category>ArcGIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>è·¯ç½‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>â€œå…¬ç›Šäº‘å›¾â€æ•°æ®å¯è§†åŒ–åˆ›æ–°å¤§èµ›æŠ€æœ¯æ±‡æ€»</title>
    <link href="/2016/09/26/%E2%80%9C%E5%85%AC%E7%9B%8A%E4%BA%91%E5%9B%BE%E2%80%9D%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/"/>
    <url>/2016/09/26/%E2%80%9C%E5%85%AC%E7%9B%8A%E4%BA%91%E5%9B%BE%E2%80%9D%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡ç”¨ä»¥æ€»ç»“å‚èµ›ä»¥æ¥å„ç§æŠ€æœ¯å®ç°åŠæ€è·¯ã€‚</p><blockquote><p>åˆ«ç®¡å¯¹æ‰‹æ˜¯å¦å¼ºå¤§ï¼ŒåŠ¨æ‰‹å»åšï¼Œè¯´ä¸å®šæœ‰å¥‡è¿¹å‘¢ï¼</p></blockquote><span id="more"></span><hr><h1 id="ä½œå“ç®€ä»‹"><a href="#ä½œå“ç®€ä»‹" class="headerlink" title="ä½œå“ç®€ä»‹"></a>ä½œå“ç®€ä»‹</h1><br><div class="row">    <embed src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/Environment/MagicGraph.pdf" width="100%" height="550" type="application/pdf"></div><br><h1 id="Try-it-offline"><a href="#Try-it-offline" class="headerlink" title="Try it! (offline)"></a>Try it! (offline)</h1><p>åŒ…å«æ•°æ®ï¼ŒåŠ è½½æœ‰ç‚¹æ…¢<br><a href="http://mattzou.com/MG/">MagicGraph</a></p><h1 id="å‚èµ›æ€è€ƒ"><a href="#å‚èµ›æ€è€ƒ" class="headerlink" title="å‚èµ›æ€è€ƒ"></a>å‚èµ›æ€è€ƒ</h1><h2 id="é˜Ÿä¼"><a href="#é˜Ÿä¼" class="headerlink" title="é˜Ÿä¼"></a>é˜Ÿä¼</h2><p>é˜Ÿä¼åç§°çº ç»“äº†æˆ‘åŠå¤©ï¼Œæƒ³æƒ³ç”¨<code>R</code>è¿™ä¹ˆå­¦æœ¯çš„è½¯ä»¶åšå¯è§†åŒ–äº¤äº’ï¼Œå¿…æ˜¯è¦æŠ˜è…¾ä¸€ç•ªï¼Œæœ¬ç€å†…å¿ƒå°å°çš„<code>Geeker</code>ç²¾ç¥ï¼Œå¤–åŠ è‹±æ–‡ä»£å·<code>Matt</code>ï¼Œå°±è¿™ä¹ˆå‡‘äº†ä¸ª<em>MGeek</em>.</p><h2 id="èµ›é¢˜"><a href="#èµ›é¢˜" class="headerlink" title="èµ›é¢˜"></a>èµ›é¢˜</h2><p>é€‰äº†ä¸ªè·Ÿè‡ªå·±ä¸“ä¸šå¯¹å£çš„ï¼Œå“ˆï¼</p><blockquote><p><strong>ç©ºæ°”è´¨é‡ä¸å¤§æ°”ç¯å¢ƒ</strong></p></blockquote><h3 id="æ¶‰åŠæ•°æ®"><a href="#æ¶‰åŠæ•°æ®" class="headerlink" title="æ¶‰åŠæ•°æ®"></a>æ¶‰åŠæ•°æ®</h3><ul><li>åŒºåŸŸå†…ç©ºæ°”è´¨é‡çš„å®æ—¶ç›‘æµ‹æ•°æ®ï¼Œä»¥åŠç›‘æµ‹ç‚¹çš„åœ°ç†åæ ‡;</li><li>å½“åœ°æ°”è±¡å±€æä¾›çš„æ°”å‹ã€æ¸©åº¦ã€æ¹¿åº¦ã€é™æ°´ä¸é£åŠ›é£å‘ç­‰æ•°æ®ï¼Œä»¥åŠä¿¡æ¯é‡‡é›†ç‚¹çš„åœ°ç†åæ ‡;</li></ul><h3 id="å‘ˆç°å†…å®¹"><a href="#å‘ˆç°å†…å®¹" class="headerlink" title="å‘ˆç°å†…å®¹"></a>å‘ˆç°å†…å®¹</h3><p><strong>ç©ºæ°”è´¨é‡ä¸å¤§æ°”ç¯å¢ƒçš„å…³ç³»</strong><br>    ä»¥æ—¶é—´æµé€çš„æ–¹å¼ï¼ŒåŠ¨æ€å±•ç°åŒºåŸŸå†…ç©ºæ°”è´¨é‡å˜åŒ–ã€‚æ¯”å¦‚åœ¨åœ°å›¾å›¾å±‚ä¸Šï¼Œä»¥é¢œè‰²è¡¨ç¤ºç©ºæ°”è´¨é‡ã€ä»¥ç®­å¤´æ–¹å‘å’Œç²—ç»†è¡¨ç¤ºé£åŠ›é£å‘ã€ä»¥è§‚æµ‹ç‚¹ä½ç½®çš„åŠ¨æ€å›¾æ ‡è¡¨ç¤ºæ¸©åº¦å’Œæ¹¿åº¦ç­‰;</p><p><strong>ç©ºæ°”æ±¡æŸ“æ¢¯åº¦å’ŒåŒºåŸŸæ±¡æŸ“ä¼°è®¡</strong><br>    é€šè¿‡æ›²çº¿æ‹Ÿåˆï¼Œåœ¨åœ°å›¾ä¸Šï¼Œç»˜åˆ¶ç±»ä¼¼ç­‰é«˜çº¿å‹çš„ç©ºæ°”æ±¡æŸ“æ¢¯åº¦å›¾ï¼Œå¯¹æ²¡æœ‰ç©ºæ°”è´¨é‡ç›‘æµ‹çš„åŸå¸‚å’Œåœ°åŒºè¿›è¡Œç©ºæ°”è´¨é‡ä¼°è®¡;</p><p><strong>é£å’Œé™æ°´å¯¹ç©ºæ°”æ±¡æŸ“çš„å¸®åŠ©</strong><br>    é€šå¸¸ç”±äºé£å’Œé™æ°´çš„ä½œç”¨ï¼Œå¯ä»¥æ˜¾è‘—æ”¹å–„ç©ºæ°”è´¨é‡ã€‚é€šè¿‡å…³è”åˆ†æï¼Œå®šé‡çš„äº†è§£ç»™å®šé£åŠ›æˆ–é™æ°´æ¡ä»¶ä¸‹ï¼Œç©ºæ°”è´¨é‡ä¼šå¾—åˆ°å¤šå¤§ç¨‹åº¦æ”¹å–„ï¼Œç©ºæ°”è´¨é‡æ”¹å–„çš„é€Ÿåº¦æ˜¯ä»€ä¹ˆæ ·çš„;</p><p><strong>æ¨æ–­ç©ºæ°”æ±¡æŸ“ç‰©æ¥æºï¼ˆé«˜çº§å†…å®¹ï¼‰</strong><br>    é€šè¿‡æ±¡æŸ“ç‰©æ‰©æ•£è¶‹åŠ¿å’Œæ¢¯åº¦ï¼Œæ¨æ–­æ±¡æŸ“æºå‘ç”Ÿçš„åœ°ç†ä½ç½®ï¼Œå¹¶åœ¨åœ°å›¾ä¸Šæ ‡è¯†;</p><p><strong>æ‹Ÿåˆç©ºæ°”æ±¡æŸ“ä¸å¤§æ°”ç¯å¢ƒæ–¹ç¨‹ï¼ˆé«˜çº§å†…å®¹ï¼‰</strong><br>    æ‹Ÿåˆç©ºæ°”æ±¡æŸ“ç‰©æ‰©æ•£çš„æ–¹ç¨‹ï¼Œåˆ¶ä½œäº¤äº’å¼çš„æ±¡æŸ“ç‰©æ‰©æ•£é¢„æµ‹ï¼Œé€šè¿‡ç”¨æˆ·è¾“å…¥å¯æ”¹å˜æŸåœ°çš„æ°”è±¡çŠ¶å†µï¼Œç„¶ååŠ¨æ€æ¨¡æ‹Ÿåœ¨è®¾å®šçš„ç©ºæ°”çŠ¶å†µä¸‹ï¼Œæ±¡æŸ“ç‰©æ‰©æ•£çš„è¶‹åŠ¿ã€èŒƒå›´å’Œé€Ÿåº¦ã€‚</p><h2 id="ä½œå“"><a href="#ä½œå“" class="headerlink" title="ä½œå“"></a>ä½œå“</h2><h3 id="ä½¿ç”¨æ•°æ®"><a href="#ä½¿ç”¨æ•°æ®" class="headerlink" title="ä½¿ç”¨æ•°æ®"></a>ä½¿ç”¨æ•°æ®</h3><ul><li>å…¨å›½å¿çº§åŸå¸‚å®æ—¶å¤©æ°”æ•°æ®</li><li>å…¨å›½é£åœºæ ¼ç‚¹å®å†µæ•°æ®</li><li>å›½æ§ç«™ç‚¹ç›‘æµ‹å®æ—¶ç©ºæ°”æ±¡æŸ“æ•°æ®</li><li>å›½æ§ç©ºæ°”æ£€æµ‹ç«™ç‚¹åˆ†å¸ƒæ•°æ®</li><li>å—äº¬å¸‚é“è·¯å¡å£è½¦è¾†ç›‘æµ‹æ•°æ®</li><li>è¿‘æœŸGlobal Forecast System (GFS)æ•°æ® United Statesâ€™ National Weather Service (NWS)è·å–</li></ul><h3 id="ä½œå“è®¾è®¡æ€è·¯"><a href="#ä½œå“è®¾è®¡æ€è·¯" class="headerlink" title="ä½œå“è®¾è®¡æ€è·¯"></a>ä½œå“è®¾è®¡æ€è·¯</h3><ul><li>æ±¡æŸ“æºæ’æ”¾æ±¡æŸ“ç‰©åéšå¤§æ°”æ´»åŠ¨åœ¨ç¯å¢ƒä¸­æ‰©æ•£ï¼Œè·Ÿè¸ªå¤§æ°”è¿åŠ¨è½¨è¿¹ï¼Œæä¾›äº†ä¸€ä¸ªæº¯æµè€Œä¸Šçš„æ–¹å¼ã€‚</li><li>å› æ­¤ç°æœ‰ç©ºæ°”è´¨é‡ç›‘æµ‹ä¸å¤§æ°”ç¯å¢ƒè§‚æµ‹ä½“ç³»æ‰€æä¾›çš„æ•°æ®ä¸ä»…å¯ä»¥åˆ†ææ±¡æŸ“æœ‰å¤šé‡ï¼Œè¿˜å¯ä»¥é€šè¿‡å…³è”åˆ†ææ¨æ–­æ±¡æŸ“æºçš„ä½ç½®ã€‚</li><li>ç»“åˆç¯å¢ƒæ•°æ®ã€åœ°å›¾ä½ç½®ä¿¡æ¯ï¼Œåˆ†ææ±¡æŸ“æ¥æºã€‚</li></ul><h3 id="å®ç°æ–¹æ³•"><a href="#å®ç°æ–¹æ³•" class="headerlink" title="å®ç°æ–¹æ³•"></a>å®ç°æ–¹æ³•</h3><h4 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><ul><li>æ•°æ®å¤„ç†<br>  <em>Rã€MATLABã€Excelã€ArcGIS</em></li><li>å›¾åƒå¤„ç†<br>  <em>Adobe Photoshop</em></li><li>æœåŠ¡ç»„ä»¶<br>  <em>Dockerã€Shiny serverã€Node.js</em></li><li>éƒ¨ç½²<br>  <em>é˜¿é‡Œäº‘ECS</em></li></ul><h4 id="åˆ›ä½œæ–¹æ³•"><a href="#åˆ›ä½œæ–¹æ³•" class="headerlink" title="åˆ›ä½œæ–¹æ³•"></a>åˆ›ä½œæ–¹æ³•</h4><ol><li>å±•ç¤ºæ•°æ®è·å–åŠå¤„ç†</li><li>R æ•°æ®å¤„ç†</li><li>Rmarkdownç¼–å†™å±•ç¤ºæ–‡æ¡£ï¼ŒåŸºäºä»¥ä¸‹ç»„ä»¶ï¼š<br><a href="http://rmarkdown.rstudio.com/">R Markdown</a>ã€<a href="http://rmarkdown.rstudio.com/flexdashboard/">flexdashboard</a>ã€<a href="http://ggplot2.org/">ggplot2</a>ã€<a href="https://plot.ly/r/">Plotly For R</a>ã€<a href="http://jkunst.com/highcharter/">Highcharter</a>ã€<a href="http://rstudio.github.io/leaflet/">Leaflet For R</a></li><li>åŠ¨æ€é£åœºå›¾åŸºäº<a href="https://github.com/dannycochran/windable">windable</a>é¡¹ç›®</li><li><a href="https://www.rstudio.com/products/shiny/shiny-server/">Shiny server</a>ä½œä¸ºWeb serverï¼ŒåŠ¨æ€ç¼–è¯‘R markdownæ–‡ä»¶ç”Ÿæˆäº¤äº’é¡µé¢</li><li><a href="https://hub.docker.com/r/quantumobject/docker-shiny/">Docker</a>æ‰“åŒ…ä»¥ä¸Šç»„ä»¶ï¼Œéƒ¨ç½²åˆ°é˜¿é‡Œäº‘ECS</li></ol><h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><blockquote><ol><li> <a href="http://mattzou.github.io/2016/02/28/ArcGIS_Fishnet_2016-02-28/#">[Rå¯è§†åŒ–å·¥å…·]</a> <strong>å¯è§†åŒ–</strong> å·¥å…·æ±‡æ€»</li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Plotly]</a> <strong>å¯è§†åŒ–</strong> <code>Plotly For R</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[R markdown]</a> <strong>å¯è§†åŒ–</strong> <code>R markdown</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Flexdashboard]</a> <strong>å¯è§†åŒ–</strong> <code>Flexdashboard</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Plotly]</a> <strong>å¯è§†åŒ–</strong> <code>Plotly For R</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Shiny server]</a> <strong>å¯è§†åŒ–</strong> <code>Shiny server</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Leaflet]</a> <strong>å¯è§†åŒ–</strong> <code>Plotly For R</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Highcharter]</a> <strong>å¯è§†åŒ–</strong> <code>Plotly For R</code> </li><li> <a href="http://mattzou.github.io/2016/03/03/ArcGIS_%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84_2016-03-03/#">[Docker]</a> <strong>å¯è§†åŒ–</strong> <code>Plotly For R</code> </li></ol></blockquote>]]></content>
    
    
    <categories>
      
      <category>ç›®å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤©æ± </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oracle impdpä¸expdpè¿›è¡Œæ•°æ®èµ„äº§å¿«é€Ÿè¿ç§»</title>
    <link href="/2016/08/14/Oracle-impdp%E4%B8%8Eexpdp/"/>
    <url>/2016/08/14/Oracle-impdp%E4%B8%8Eexpdp/</url>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å¯¹äºOracleæ•°æ®è¿ç§»ä»»åŠ¡ï¼Œå®˜æ–¹æä¾›äº†ä¸€ç³»åˆ—å·¥å…·<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Oralce Utilities">[1]</span></a></sup>ï¼Œåº”ç”¨è¾ƒå¤šçš„æ˜¯<strong>Data Pump</strong>å·¥å…·å’Œ<a href="https://mattzou.com/2016/03/18/Oracle_SQLLDR/"><strong>SQL*Loaderå·¥å…·</strong></a>ã€‚</p><p><strong>Data Pump</strong>å·¥å…·ä¸»è¦é€‚ç”¨äºOracleæ•°æ®åº“ä¹‹é—´æ•°æ®è¿ç§»ï¼Œ<strong>SQL*Loaderå·¥å…·</strong>åå‘äºå¤–éƒ¨æ•°æ®æ–‡ä»¶å¯¼å…¥ã€‚</p><blockquote><ul><li>Oracle Data Pump technology enables very high-speed movement of data and metadata from one database to another.</li><li>SQL*Loader loads data from external files into Oracle Database tables.<br>Â© Oracle è¯´çš„ğŸ˜</li></ul></blockquote><p><strong>Data Pump</strong>å·¥å…·ç”±ä»¥ä¸‹ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼š</p><blockquote><ol><li>Command-line clients, <code>expdp</code> and <code>impdp</code></li><li>DBMS_DATAPUMP PL/SQL package (also known as the Data Pump API)</li><li>DBMS_METADATA PL/SQL package (also known as the Metadata API)</li></ol></blockquote><p>æœ¬æ–‡ä¸»è¦ä»‹ç»<code>expdp</code> å’Œ <code>impdp</code> çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>ç¯å¢ƒï¼š Windows 10 or latestï¼Œ Oracle 11g or latest version</p><h3 id="ç›®å½•åˆ›å»ºä¸æˆæƒ"><a href="#ç›®å½•åˆ›å»ºä¸æˆæƒ" class="headerlink" title="ç›®å½•åˆ›å»ºä¸æˆæƒ"></a>ç›®å½•åˆ›å»ºä¸æˆæƒ</h3><p><strong>Data Pump</strong>å·¥å…·å¯¼å…¥å¯¼å‡ºçš„æ–‡ä»¶éœ€è¦å‚¨å­˜åœ¨å®ä½“ç›®å½•ä¸‹ï¼Œå¹¶åœ¨Oracleä¸­åˆ›å»ºè™šæ‹Ÿç›®å½•åç§°ä¸ä¹‹æ˜ å°„ã€‚</p><h4 id="ç›®å½•æŸ¥è¯¢"><a href="#ç›®å½•æŸ¥è¯¢" class="headerlink" title="ç›®å½•æŸ¥è¯¢"></a>ç›®å½•æŸ¥è¯¢</h4><p>ä»¥ç®¡ç†å‘˜è´¦å·ç™»é™†<strong>sqlplus</strong></p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SQL</span><span class="token operator">></span>conn system<span class="token operator">/</span>manger<span class="token variable">@orcl</span> <span class="token keyword">as</span> sysdba<span class="token keyword">SQL</span><span class="token operator">></span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_directories<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>å¯ä»¥æŸ¥çœ‹å½“å‰å­˜åœ¨çš„ç›®å½•ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">OWNER                          DIRECTORY_NAME<span class="token comment">------------------------------ -----------------------------</span>DIRECTORY_PATH<span class="token comment">------------------------------------------------------------</span>SYS                            XMLDIRc:\ade\aime_dadvfh0169\oracle<span class="token operator">/</span>rdbms<span class="token operator">/</span>xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>DIRECTORY_PATH</code>æ˜¯å®ä½“ç›®å½•ä½ç½®ï¼Œè¯·ç¡®ä¿å·²ç»åˆ›å»ºæ­¤ç›®å½•<br><code>DIRECTORY_NAME</code>æ˜¯è™šæ‹Ÿç›®å½•åç§°</p><h4 id="ç›®å½•åˆ›å»º"><a href="#ç›®å½•åˆ›å»º" class="headerlink" title="ç›®å½•åˆ›å»º"></a>ç›®å½•åˆ›å»º</h4><p>å¯ä»¥ä½¿ç”¨å·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œæˆ–è€…åˆ›å»ºæ–°çš„ç›®å½•(æ¨è)</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SQL</span><span class="token operator">></span><span class="token keyword">create</span> directory dump_dir <span class="token keyword">as</span> <span class="token string">'d:\test\dump'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><code>dump_dir</code>è‡ªå®šä¹‰åç§°ï¼Œå¯¹åº”<code>DIRECTORY_NAME</code><br>åˆ›å»ºåå¯ä»¥å†æ¬¡<a href="#%E7%9B%AE%E5%BD%95%E6%9F%A5%E8%AF%A2">æŸ¥è¯¢</a>æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚</p><h4 id="ç›®å½•æˆæƒ"><a href="#ç›®å½•æˆæƒ" class="headerlink" title="ç›®å½•æˆæƒ"></a>ç›®å½•æˆæƒ</h4><p>ç»™æ•°æ®æ¢å¤æˆ–å¯¼å‡ºç”¨æˆ·æˆæƒ<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Required Roles for Oracle Data Pump Export and Import Operations">[2]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SQL</span><span class="token operator">></span><span class="token keyword">grant</span> <span class="token keyword">read</span><span class="token punctuation">,</span><span class="token keyword">write</span> <span class="token keyword">on</span> directory dump_dir <span class="token keyword">to</span> scott<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="å¯¼å…¥ä¸å¯¼å‡º"><a href="#å¯¼å…¥ä¸å¯¼å‡º" class="headerlink" title="å¯¼å…¥ä¸å¯¼å‡º"></a>å¯¼å…¥ä¸å¯¼å‡º</h3><h4 id="expdpå¯¼å‡º"><a href="#expdpå¯¼å‡º" class="headerlink" title="expdpå¯¼å‡º"></a>expdpå¯¼å‡º</h4><p>å¯¼å‡ºç”Ÿæˆçš„dmpä¼šä¿å­˜åœ¨ä¸Šé¢åˆ›å»ºçš„å®ä½“ç›®å½•ä¸­ã€‚</p><ol><li><p>å¯¼å‡ºç”¨æˆ·</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">expdp scott<span class="token operator">/</span>tiger<span class="token variable">@orcl</span> schemas<span class="token operator">=</span>scott <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp directory<span class="token operator">=</span>dump_dir<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯¼å‡ºè¡¨</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">expdp scott<span class="token operator">/</span>tiger<span class="token variable">@orcl</span> <span class="token keyword">tables</span><span class="token operator">=</span>emp<span class="token punctuation">,</span>dept <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp directory<span class="token operator">=</span>dump_dir<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>æŒ‰æŸ¥è¯¢æ¡ä»¶å¯¼</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">expdp scott<span class="token operator">/</span>tiger<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp <span class="token keyword">tables</span><span class="token operator">=</span>emp query<span class="token operator">=</span><span class="token string">'where deptno=20'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>æŒ‰è¡¨ç©ºé—´å¯¼</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">expdp system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span><span class="token keyword">tablespace</span><span class="token punctuation">.</span>dmp tablespaces<span class="token operator">=</span><span class="token keyword">temp</span><span class="token punctuation">,</span>example<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯¼æ•´ä¸ªæ•°æ®åº“</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">expdp system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span><span class="token keyword">full</span><span class="token punctuation">.</span>dmp <span class="token keyword">full</span><span class="token operator">=</span>y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ol><h4 id="impdpå¯¼å…¥"><a href="#impdpå¯¼å…¥" class="headerlink" title="impdpå¯¼å…¥"></a>impdpå¯¼å…¥</h4><p>å¯¼å…¥ä¹‹å‰ï¼Œéœ€è¦ç¡®ä¿<a href="#%E7%9B%AE%E5%BD%95%E5%88%9B%E5%BB%BA%E4%B8%8E%E6%8E%88%E6%9D%83">ç›®å½•åˆ›å»ºä¸æˆæƒ</a>å®Œæˆï¼Œå¹¶ä¸”dmpæ–‡ä»¶å·²ç»æ‹·è´è‡³å¯¹åº”ç›®å½•ä¸‹ã€‚</p><ol><li><p>å¯¼å…¥ç”¨æˆ·ï¼ˆä»ç”¨æˆ·scottå¯¼å…¥åˆ°ç”¨æˆ·scottï¼‰</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">impdp scott<span class="token operator">/</span>tiger<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp schemas<span class="token operator">=</span>scott<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯¼å…¥è¡¨ï¼ˆä»scottç”¨æˆ·ä¸­æŠŠè¡¨deptå’Œempå¯¼å…¥åˆ°systemç”¨æˆ·ä¸­ï¼‰</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">impdp system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp <span class="token keyword">tables</span><span class="token operator">=</span>scott<span class="token punctuation">.</span>dept<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>emp remap_schema<span class="token operator">=</span>scott:system<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯¼å…¥è¡¨ç©ºé—´</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">impdp system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span><span class="token keyword">tablespace</span><span class="token punctuation">.</span>dmp tablespaces<span class="token operator">=</span>example<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>å¯¼å…¥æ•°æ®åº“</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">impdb system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span><span class="token keyword">full</span><span class="token punctuation">.</span>dmp <span class="token keyword">full</span><span class="token operator">=</span>y<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p>è¿½åŠ æ•°æ®</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">impdp system<span class="token operator">/</span>manager<span class="token variable">@orcl</span> directory<span class="token operator">=</span>dump_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp schemas<span class="token operator">=</span>system table_exists_action<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ol><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ol><li>expdpå’Œimpdpæ˜¯æœåŠ¡ç«¯å·¥å…·ç¨‹åºï¼Œåªèƒ½åœ¨oracleæœåŠ¡ç«¯ä½¿ç”¨ï¼Œä¸èƒ½åœ¨å®¢æˆ·ç«¯ä½¿ç”¨<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="ORACLEä½¿ç”¨EXPDPå’ŒIMPDPæ•°æ®æ³µè¿›è¡Œå¯¼å‡ºå¯¼å…¥çš„æ–¹æ³•">[3]</span></a></sup>ã€‚</li><li>imp/expå‘½ä»¤ä¸impdp/expdpå·¥å…·äº§ç”Ÿçš„æ–‡ä»¶ä¸é€šç”¨ï¼Œè¯·å‹¿æ··æ·†<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="Oracle Data Pump (expdp, impdp) in Oracle Database 10g, 11g, 12c, 18c, 19c">[4]</span></a></sup>ã€‚</li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/sutil/">Oralce Utilities</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/sutil/oracle-data-pump-overview.html#GUID-8B6975D3-3BEC-4584-B416-280125EEC57E">Required Roles for Oracle Data Pump Export and Import Operations</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="http://blog.sina.com.cn/s/blog_67d41beb0100ixnb.html">ORACLEä½¿ç”¨EXPDPå’ŒIMPDPæ•°æ®æ³µè¿›è¡Œå¯¼å‡ºå¯¼å…¥çš„æ–¹æ³•</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://oracle-base.com/articles/10g/oracle-data-pump-10g">Oracle Data Pump (expdp, impdp) in Oracle Database 10g, 11g, 12c, 18c, 19c</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle</tag>
      
      <tag>Oracle Utilities</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ORA-xxxxx</title>
    <link href="/2016/08/14/ORA-xxxxx/"/>
    <url>/2016/08/14/ORA-xxxxx/</url>
    
    <content type="html"><![CDATA[<h2 id="ORA-01659-æ— æ³•åˆ†é…è¶…å‡º-7-çš„-MINEXTENTS"><a href="#ORA-01659-æ— æ³•åˆ†é…è¶…å‡º-7-çš„-MINEXTENTS" class="headerlink" title="ORA-01659: æ— æ³•åˆ†é…è¶…å‡º 7 çš„ MINEXTENTS"></a>ORA-01659: æ— æ³•åˆ†é…è¶…å‡º 7 çš„ MINEXTENTS</h2><p>ä¸»è¦åŸå› æ˜¯è¡¨ç©ºé—´ä¸å¤Ÿ,å°†å…¶è®¾ç½®ä¸ºè‡ªåŠ¨æ‰©å±•å³å¯ã€‚</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">database</span> datafile <span class="token string">'D:/app/Administrator/oradata/user_data.dbf'</span> autoextend <span class="token keyword">on</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>æˆ–è€…å¯ä»¥åœ¨åˆ›å»ºperfstatè¡¨ç©ºé—´çš„æ—¶å€™è¿›è¡Œè®¾ç½®ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">tablespace</span> perfstatdatafile <span class="token string">'D:/app/Administrator/oradata/user_data.dbf'</span> size <span class="token number">100</span>m autoextend <span class="token keyword">on</span>extend management <span class="token keyword">local</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>æ›´å¤šå†…å®¹å¯è§<a href="http://localhost:4758/2016/03/15/Oracle_%E8%A1%A8%E7%A9%BA%E9%97%B4/">Oracle è¡¨ç©ºé—´ç®¡ç†</a></p></blockquote><h2 id="ORA-32773-ä¸æ”¯æŒå¯¹å°æ–‡ä»¶è¡¨ç©ºé—´-TEST-çš„æ“ä½œ"><a href="#ORA-32773-ä¸æ”¯æŒå¯¹å°æ–‡ä»¶è¡¨ç©ºé—´-TEST-çš„æ“ä½œ" class="headerlink" title="ORA-32773: ä¸æ”¯æŒå¯¹å°æ–‡ä»¶è¡¨ç©ºé—´ TEST çš„æ“ä½œ"></a>ORA-32773: ä¸æ”¯æŒå¯¹å°æ–‡ä»¶è¡¨ç©ºé—´ TEST çš„æ“ä½œ</h2><p>éœ€è¦æ‰©å±•è¡¨ç©ºé—´</p><ol><li>å¢åŠ æ•°æ®æ–‡ä»¶</li><li>å¢åŠ æ•°æ®æ–‡ä»¶çš„å¤§å°</li><li>è®¾å®šæ•°æ®æ–‡ä»¶è‡ªåŠ¨å¢é•¿</li></ol><blockquote><p>æ›´å¤šå†…å®¹å¯è§<a href="http://localhost:4758/2016/03/15/Oracle_%E8%A1%A8%E7%A9%BA%E9%97%B4/">Oracle è¡¨ç©ºé—´ç®¡ç†</a></p></blockquote><h2 id="ORA-01830-æ—¥æœŸæ ¼å¼å›¾ç‰‡åœ¨è½¬æ¢æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²ä¹‹å‰ç»“æŸ"><a href="#ORA-01830-æ—¥æœŸæ ¼å¼å›¾ç‰‡åœ¨è½¬æ¢æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²ä¹‹å‰ç»“æŸ" class="headerlink" title="ORA-01830: æ—¥æœŸæ ¼å¼å›¾ç‰‡åœ¨è½¬æ¢æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²ä¹‹å‰ç»“æŸ"></a>ORA-01830: æ—¥æœŸæ ¼å¼å›¾ç‰‡åœ¨è½¬æ¢æ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²ä¹‹å‰ç»“æŸ</h2><p><code>to_date</code>æ¯”è¾ƒçš„æ—¶å€™æŠ¥è¿™ä¸ªé”™è¯¯<br>é—®é¢˜ï¼š<strong>varchar2</strong>ç±»å‹è½¬æ¢æˆ<strong>date</strong>ç±»å‹</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> to_date<span class="token punctuation">(</span>INVOICE_DATE<span class="token punctuation">,</span><span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tab<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æœ€åæŸ¥çš„åŸå› ï¼šINVOICE_DATE=â€˜2005-11-10 00:00:00â€™çš„é•¿åº¦å¤§äºæ ¼å¼åŒ–â€™yyyy-mm-ddâ€™çš„é•¿åº¦<br>è§£å†³ï¼šä½¿ç”¨substr()</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">to_date<span class="token punctuation">(</span>substr<span class="token punctuation">(</span>INVOICE_DATE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="ORA-01810ï¼šæ ¼å¼ä»£ç å‡ºç°ä¸¤æ¬¡"><a href="#ORA-01810ï¼šæ ¼å¼ä»£ç å‡ºç°ä¸¤æ¬¡" class="headerlink" title="ORA-01810ï¼šæ ¼å¼ä»£ç å‡ºç°ä¸¤æ¬¡"></a>ORA-01810ï¼šæ ¼å¼ä»£ç å‡ºç°ä¸¤æ¬¡</h2><ol><li>Oracleä¸­ä½¿ç”¨to_date()æ—¶æ ¼å¼åŒ–æ—¥æœŸéœ€è¦æ³¨æ„æ ¼å¼ç ï¼Œå¦‚ï¼š<div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> to_date<span class="token punctuation">(</span><span class="token string">'2005-01-01 13:14:20'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH24:mm:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div>åŸå› æ˜¯SQLä¸­ä¸åŒºåˆ†å¤§å°å†™ï¼ŒMMå’Œmmè¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„æ ¼å¼ä»£ç ï¼Œæ‰€ä»¥Oracleçš„SQLé‡‡ç”¨äº†miä»£æ›¿åˆ†é’Ÿã€‚<div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> to_date<span class="token punctuation">(</span><span class="token string">'2005-01-01 13:14:20'</span><span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li>å¦è¦ä»¥24å°æ—¶çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥è¦ç”¨HH24<div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> to_char<span class="token punctuation">(</span>sysdate<span class="token punctuation">,</span><span class="token string">'yyyy-MM-dd HH24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token comment">//miæ˜¯åˆ†é’Ÿ</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ol><h2 id="ORA-00059-è¶…å‡º-DB-FILES-çš„æœ€å¤§å€¼"><a href="#ORA-00059-è¶…å‡º-DB-FILES-çš„æœ€å¤§å€¼" class="headerlink" title="ORA-00059: è¶…å‡º DB_FILES çš„æœ€å¤§å€¼"></a>ORA-00059: è¶…å‡º DB_FILES çš„æœ€å¤§å€¼</h2><p><code>init parameters</code>é‡Œçš„db_filesç©ºé—´ä¸è¶³</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> parameter db_files<span class="token punctuation">;</span><span class="token keyword">alter</span> system <span class="token keyword">set</span> db_files<span class="token operator">=</span>xxMB scope<span class="token operator">=</span>spfile<span class="token punctuation">;</span><span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span>startup<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oracle SQL*Loader åº”ç”¨</title>
    <link href="/2016/03/18/Oracle-SQLLDR/"/>
    <url>/2016/03/18/Oracle-SQLLDR/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ¥äº†ä¸€å¤§æ‰¹å•ä¸ªå¤§å°åŠ¨è¾„7Gçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯¼å…¥æ•°æ®è¡¨ä¸­ï¼Œæ€ä¹ˆåŠ!!!!å°è¯•ç”¨<code>PL/SQL Developer</code>ä¸­çš„æ–‡æœ¬å¯¼å…¥å™¨ï¼Œç»“æœ====<strong>å¡æ­»</strong>=====å¾ˆä¹…ä¹‹å====<strong>å¡æ­»</strong></p></blockquote><span id="more"></span><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>Oracleå¸¸ç”¨çš„è¡¨æ•°æ®è¿ç§»æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li><p>Aè¡¨å¯¼å‡ºåŒ…å« <code>insert</code> çš„sqlï¼Œé€æ¡æ’å…¥Bè¡¨ä¸­</p></li><li><p>å»ºç«‹æ•°æ®åº“é—´çš„ dblinkï¼Œç„¶åç”¨ <code>create table B as select * from A@dblink where </code>ï¼Œæˆ– <code>insert into B select * from A@dblink where </code></p></li><li><p><code>expdp</code> A è¡¨ï¼Œå† <code>impdp</code> åˆ° B è¡¨</p></li><li><p>æ–‡æœ¬æ•°æ®é‡‡ç”¨<strong>SQL*Loader</strong> (sqlldr) </p><p> ç¬¬1ã€2ç§æ–¹å¼å¯ç”¨ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–å¯¼å…¥æ•ˆç‡ï¼š</p> <div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> B nologging<span class="token punctuation">;</span>  <span class="token keyword">insert</span> <span class="token comment">/* +APPEND */</span> <span class="token keyword">into</span> B<span class="token punctuation">(</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>val1<span class="token punctuation">,</span>val2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">insert</span> <span class="token comment">/* +APPEND */</span> <span class="token keyword">into</span> B <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> A<span class="token variable">@dblink</span> <span class="token keyword">where</span>  <span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2></li><li><p><strong>SQL*Loader</strong> ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦åˆ›å»ºä¸€ä¸ªæ§åˆ¶æ–‡ä»¶<code>.ctl</code>ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p></li></ol>  <div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">OPTIONS <span class="token punctuation">(</span><span class="token keyword">rows</span><span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">)</span>  <span class="token comment">/*å®šä¹‰sqlldréƒ¨åˆ†å‚æ•°*/</span><span class="token keyword">load</span> <span class="token keyword">data</span><span class="token keyword">infile</span><span class="token string">'F:\2014-10-31.txt'</span><span class="token comment">/*æŒ‡å®šæ•°æ®æ–‡ä»¶*/</span><span class="token keyword">insert</span><span class="token comment">/*åœ¨æ“ä½œç±»å‹ insert ä½ç½®å¯é€‰ä¸€ä¸‹å€¼ï¼š1) insert   --ä¸ºç¼ºçœæ–¹å¼ï¼Œåœ¨æ•°æ®è£…è½½å¼€å§‹æ—¶è¦æ±‚è¡¨ä¸ºç©º2) append   --åœ¨è¡¨ä¸­è¿½åŠ æ–°è®°å½•3) replace  --åˆ é™¤æ—§è®°å½•(ç”¨ delete from table è¯­å¥)ï¼Œæ›¿æ¢æˆæ–°è£…è½½çš„è®°å½•4) truncate --åˆ é™¤æ—§è®°å½•(ç”¨ truncate table è¯­å¥)ï¼Œæ›¿æ¢æˆæ–°è£…è½½çš„è®°å½•*/</span><span class="token keyword">into</span> <span class="token keyword">table</span> user_table<span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span><span class="token comment">/*æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦*/</span><span class="token keyword">Optionally</span> <span class="token keyword">enclosed</span> <span class="token keyword">by</span> <span class="token string">'"'</span> <span class="token comment">/*å¯é€‰ã€‚ æ•°æ®ä¸­æ¯ä¸ªå­—æ®µç”¨ '"' æ¡†èµ·ï¼Œå¦‚æœå­—æ®µä¸­æœ‰ "," åˆ†éš”ç¬¦ï¼Œå¯é¿å…å°†å­—æ®µæˆªæ–­*/</span><span class="token punctuation">(</span>PLATE<span class="token punctuation">,</span>ACROSS_TIME <span class="token keyword">DATE</span><span class="token string">"YYYY-MM-DD HH24:MI:SS"</span><span class="token punctuation">,</span>  <span class="token comment">/*æŒ‡å®šæ¥å—æ—¥æœŸçš„æ ¼å¼ï¼Œç›¸å½“ç”¨ to_date() å‡½æ•°è½¬æ¢*/</span>VEH_SPD NUMBER<span class="token comment">/*å­—æ®µæŒ‡å®šç±»å‹ï¼Œé»˜è®¤æ˜¯ CHARACTER ç±»å‹*/</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ol start="2"><li>ç„¶åå†æ‰§è¡Œ<code>sqlldr</code>å‘½ä»¤ï¼Œ</li></ol><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">sqlldr userid<span class="token variable">@service</span> control<span class="token operator">=</span><span class="token keyword">user</span><span class="token punctuation">.</span>ctl<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p> å‘½ä»¤åŒ…å«ä»¥ä¸‹<strong>å…³é”®å­—</strong>ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">    userid <span class="token comment">-- ORACLE ç”¨æˆ·å/å£ä»¤</span>   control <span class="token comment">-- æ§åˆ¶æ–‡ä»¶å</span>       log <span class="token comment">-- æ—¥å¿—æ–‡ä»¶å</span>       bad <span class="token comment">-- é”™è¯¯æ–‡ä»¶å</span>      <span class="token keyword">data</span> <span class="token comment">-- æ•°æ®æ–‡ä»¶å</span>   <span class="token keyword">discard</span> <span class="token comment">-- åºŸå¼ƒæ–‡ä»¶å</span>discardmax <span class="token comment">-- å…è®¸åºŸå¼ƒçš„æ–‡ä»¶çš„æ•°ç›®         (å…¨éƒ¨é»˜è®¤)</span>      skip <span class="token comment">-- è¦è·³è¿‡çš„é€»è¾‘è®°å½•çš„æ•°ç›®  (é»˜è®¤ 0)</span>      <span class="token keyword">load</span> <span class="token comment">-- è¦åŠ è½½çš„é€»è¾‘è®°å½•çš„æ•°ç›®  (å…¨éƒ¨é»˜è®¤)</span>    <span class="token keyword">errors</span> <span class="token comment">-- å…è®¸çš„é”™è¯¯çš„æ•°ç›®         (é»˜è®¤ 50)</span>      <span class="token keyword">rows</span> <span class="token comment">-- å¸¸è§„è·¯å¾„ç»‘å®šæ•°ç»„ä¸­æˆ–ç›´æ¥è·¯å¾„ä¿å­˜æ•°æ®é—´çš„è¡Œæ•°(é»˜è®¤: å¸¸è§„è·¯å¾„ 64, æ‰€æœ‰ç›´æ¥è·¯å¾„)</span>  bindsize <span class="token comment">-- å¸¸è§„è·¯å¾„ç»‘å®šæ•°ç»„çš„å¤§å° (ä»¥å­—èŠ‚è®¡)  (é»˜è®¤ 256000)</span>    silent <span class="token comment">-- è¿è¡Œè¿‡ç¨‹ä¸­éšè—æ¶ˆæ¯ (æ ‡é¢˜,åé¦ˆ,é”™è¯¯,åºŸå¼ƒ,åˆ†åŒº)</span>    direct <span class="token comment">-- ä½¿ç”¨ç›´æ¥è·¯å¾„                     (é»˜è®¤ FALSE)</span>   parfile <span class="token comment">-- å‚æ•°æ–‡ä»¶: åŒ…å«å‚æ•°è¯´æ˜çš„æ–‡ä»¶çš„åç§°</span>  parallel <span class="token comment">-- æ‰§è¡Œå¹¶è¡ŒåŠ è½½                    (é»˜è®¤ FALSE)</span>      <span class="token keyword">file</span> <span class="token comment">-- è¦ä»ä»¥ä¸‹å¯¹è±¡ä¸­åˆ†é…åŒºçš„æ–‡ä»¶</span>skip_unusable_indexes <span class="token comment">-- ä¸å…è®¸/å…è®¸ä½¿ç”¨æ— ç”¨çš„ç´¢å¼•æˆ–ç´¢å¼•åˆ†åŒº  (é»˜è®¤ FALSE)</span>skip_index_maintenance <span class="token comment">-- æ²¡æœ‰ç»´æŠ¤ç´¢å¼•, å°†å—åˆ°å½±å“çš„ç´¢å¼•æ ‡è®°ä¸ºæ— ç”¨  (é»˜è®¤ FALSE)</span>commit_discontinued <span class="token comment">-- æäº¤åŠ è½½ä¸­æ–­æ—¶å·²åŠ è½½çš„è¡Œ  (é»˜è®¤ FALSE)</span>  readsize <span class="token comment">-- è¯»å–ç¼“å†²åŒºçš„å¤§å°               (é»˜è®¤ 1048576)</span>external_table <span class="token comment">-- ä½¿ç”¨å¤–éƒ¨è¡¨è¿›è¡ŒåŠ è½½; NOT_USED, GENERATE_ONLY, EXECUTE  (é»˜è®¤NOT_USED)</span>columnarrayrows <span class="token comment">-- ç›´æ¥è·¯å¾„åˆ—æ•°ç»„çš„è¡Œæ•°  (é»˜è®¤ 5000)</span>streamsize <span class="token comment">-- ç›´æ¥è·¯å¾„æµç¼“å†²åŒºçš„å¤§å° (ä»¥å­—èŠ‚è®¡)  (é»˜è®¤ 256000)</span>multithreading <span class="token comment">-- åœ¨ç›´æ¥è·¯å¾„ä¸­ä½¿ç”¨å¤šçº¿ç¨‹</span> resumable <span class="token comment">-- å¯ç”¨æˆ–ç¦ç”¨å½“å‰çš„å¯æ¢å¤ä¼šè¯  (é»˜è®¤ FALSE)</span>resumable_name <span class="token comment">-- æœ‰åŠ©äºæ ‡è¯†å¯æ¢å¤è¯­å¥çš„æ–‡æœ¬å­—ç¬¦ä¸²</span>resumable_timeout <span class="token comment">-- RESUMABLE çš„ç­‰å¾…æ—¶é—´ (ä»¥ç§’è®¡)  (é»˜è®¤ 7200)</span>date_cache <span class="token comment">-- æ—¥æœŸè½¬æ¢é«˜é€Ÿç¼“å­˜çš„å¤§å° (ä»¥æ¡ç›®è®¡)  (é»˜è®¤ 1000)</span>no_index_errors <span class="token comment">-- å‡ºç°ä»»ä½•ç´¢å¼•é”™è¯¯æ—¶ä¸­æ­¢åŠ è½½  (é»˜è®¤ FALSE)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä»¥ä¸Šéƒ¨åˆ†å‚æ•°å¯ä»¥åœ¨æ§åˆ¶æ–‡ä»¶ä¸­ä»¥<code>OPTIONS()</code>æ¥å®šä¹‰</p></blockquote><h2 id="æ€§èƒ½æå‡"><a href="#æ€§èƒ½æå‡" class="headerlink" title="æ€§èƒ½æå‡"></a>æ€§èƒ½æå‡</h2><ol><li><strong>Direct</strong>å¯¼å…¥å¯ä»¥è·³è¿‡æ•°æ®åº“çš„ç›¸å…³é€»è¾‘<code>(DIRECT=TRUE)</code>ï¼Œè€Œç›´æ¥å°†æ•°æ®å¯¼å…¥åˆ°æ•°æ®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥æé«˜å¯¼å…¥æ•°æ®çš„æ€§èƒ½ã€‚å½“ç„¶ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸èƒ½ä½¿ç”¨æ­¤å‚æ•°(å¦‚æœä¸»é”®é‡å¤çš„è¯ä¼šä½¿ç´¢å¼•çš„çŠ¶æ€å˜æˆ<strong>UNUSABLE</strong>)</li><li>ä½¿ç”¨ <code>ROWS=n</code> é™å®š<code>commit</code>é¢‘ç‡</li><li>ä½¿ç”¨å¹¶è¡Œè½½å…¥ï¼Œåªåœ¨** Direct path loads<strong>æ¨¡å¼ä¸‹å¯ç”¨ï¼Œè¿™ä¸ªé€‰é¡¹å¯è®©</strong>SQL*Loader**åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚<div class="code-wrapper"><pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql">sqlldr control<span class="token operator">=</span><span class="token keyword">first</span><span class="token punctuation">.</span>ctl  parallel<span class="token operator">=</span><span class="token boolean">true</span> direct<span class="token operator">=</span><span class="token boolean">true</span>sqlldr control<span class="token operator">=</span><span class="token keyword">second</span><span class="token punctuation">.</span>ctl parallel<span class="token operator">=</span><span class="token boolean">true</span> direct<span class="token operator">=</span><span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li> ä½¿ç”¨<code>unrecoverable</code>ï¼Œæ­¤é€‰é¡¹ç¦æ­¢<code>redo</code>æ—¥å¿—çš„äº§ç”Ÿï¼Œåªåœ¨** Direct path loads**æ¨¡å¼å¯ç”¨ã€‚  </li></ol><ul><li>æ•ˆæœ<br>  <img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/sql/sqlldr.JPG" alt="æ•ˆæœ"></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a href="http://www.cnblogs.com/benio/archive/2011/10/14/2211171.html">SQL*Loaderè¯¦è§£</a></li><li><a href="http://www.remote-dba.net/teas_rem_util18.htm">Maximizing SQL*Loader Performance</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle</tag>
      
      <tag>Oracle Utilities</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Oracle è¡¨ç©ºé—´ç®¡ç†</title>
    <link href="/2016/03/15/Oracle-%E8%A1%A8%E7%A9%BA%E9%97%B4/"/>
    <url>/2016/03/15/Oracle-%E8%A1%A8%E7%A9%BA%E9%97%B4/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>è¡¨ç©ºé—´ç”¨äºç»„ç»‡ç®¡ç†å®ä½“æ•°æ®æ–‡ä»¶</p><blockquote><p>Oracle stores data logically in tablespaces and physically in datafiles associated with the corresponding tablespace.<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Tablespaces, Datafiles, and Control Files">[1]</span></a></sup></p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/sql/Datafiles%20and%20Tablespaces.gif/bg"></p><p>è‡ªOracle 10gåï¼ŒOracleæä¾›ä¸¤ç±»è¡¨ç©ºé—´<code>BigFile Tablespaceï¼ŒBFT</code>å’Œ<code>SmallFile Tablespaceï¼ŒSFT</code>ï¼Œåˆ†åˆ«æ”¯æŒä¸åŒç±»å‹çš„<strong>datafiles</strong>ï¼Œå…³äºè¿™ä¸¤ç±»è¡¨ç©ºé—´è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥å‚è€ƒæ­¤æ–‡<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="BigFileå’ŒSmallFileè¡¨ç©ºé—´æŠ€æœ¯">[2]</span></a></sup>ã€‚æœ¬æ–‡ä¸»è¦ä»¥<code>SmallFile Tablespace</code>ç±»å‹è¡¨ç©ºé—´å®ç°ä¸ºä¸»ï¼Œè¿™ä¹Ÿç›®å‰Oracleé»˜è®¤çš„è¡¨ç©ºé—´è®¾ç½®ã€‚</p><h2 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h2><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/sql/Enlarging%20a%20Database%20by%20Adding%20a%20New%20Tablespace.gif"><br>ä»¥è¡¨ç©ºé—´æ‰€å±ç”¨æˆ·èº«ä»½ç™»å½•</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- è¡¨ç©ºé—´å tb_name</span><span class="token keyword">create</span> <span class="token keyword">tablespace</span> tb_name  <span class="token comment">-- å¼€å¯log</span>logging  <span class="token comment">-- æŒ‡å®šæ•°æ®æ–‡ä»¶å­˜æ”¾è·¯å¾„åŠæ–‡ä»¶å</span>datafile <span class="token string">'D:/app/Administrator/oradata/user_data.dbf'</span><span class="token comment">-- åˆå§‹å¤§å°</span>size <span class="token number">50</span>m  <span class="token comment">-- è‡ªåŠ¨æ‹“å±• å¼€</span>autoextend <span class="token keyword">on</span>  <span class="token comment">-- æ¯æ¬¡è‡ªåŠ¨æ‹“å±•å¤§å°</span><span class="token keyword">next</span> <span class="token number">50</span>m maxsize unlimitedextent management <span class="token keyword">local</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>æŸ¥è¯¢å·²æœ‰è¡¨ç©ºé—´</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>tablespace_name                        <span class="token string">"è¡¨ç©ºé—´å"</span><span class="token punctuation">,</span>       total                                    <span class="token string">"è¡¨ç©ºé—´å¤§å°"</span><span class="token punctuation">,</span>       free                                     <span class="token string">"è¡¨ç©ºé—´å‰©ä½™å¤§å°"</span><span class="token punctuation">,</span>       <span class="token punctuation">(</span> total <span class="token operator">-</span> free <span class="token punctuation">)</span>                         <span class="token string">"è¡¨ç©ºé—´ä½¿ç”¨å¤§å°"</span><span class="token punctuation">,</span>       <span class="token function">Round</span><span class="token punctuation">(</span><span class="token punctuation">(</span> total <span class="token operator">-</span> free <span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token string">"ä½¿ç”¨ç‡   %"</span><span class="token keyword">FROM</span>   <span class="token punctuation">(</span><span class="token keyword">SELECT</span> tablespace_name<span class="token punctuation">,</span>               <span class="token function">Sum</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> free        <span class="token keyword">FROM</span>   DBA_FREE_SPACE        <span class="token keyword">GROUP</span>  <span class="token keyword">BY</span> tablespace_name<span class="token punctuation">)</span> a<span class="token punctuation">,</span>       <span class="token punctuation">(</span><span class="token keyword">SELECT</span> tablespace_name<span class="token punctuation">,</span>               <span class="token function">Sum</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> total        <span class="token keyword">FROM</span>   DBA_DATA_FILES        <span class="token keyword">GROUP</span>  <span class="token keyword">BY</span> tablespace_name<span class="token punctuation">)</span> b<span class="token keyword">WHERE</span>  a<span class="token punctuation">.</span>tablespace_name <span class="token operator">=</span> b<span class="token punctuation">.</span>tablespace_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼Œæ‰©å±•è¡¨ç©ºé—´æœ‰ä¸¤ç§æ–¹å¼</p><blockquote><ul><li>Add a datafile to a tablespace</li><li>Increase the size of a datafile</li></ul></blockquote><p>ç¬¬ä¸€ç§ç”¨äºæ‰©å±•ç³»ç»Ÿè¡¨ç©ºé—´æˆ–å…¶ä»–å·²ç»å­˜åœ¨çš„è¡¨ç©ºé—´<br>ç¬¬äºŒç§ç”¨äºç›´æ¥æ‹“å±•<strong>datafile</strong>å¤§å°ï¼Œå¦‚æœåˆ›å»ºæ—¶è®¾ç½®äº†è‡ªåŠ¨æ‹“å±•å°±æ— éœ€è®¾ç½®äº†</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/sql/Enlarging%20a%20Database%20by%20Adding%20a%20Datafile%20to%20a%20Tablespace.gif"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/sql/Enlarging%20a%20Database%20by%20Dynamically%20Sizing%20Datafiles.gif"></div></div></div><p>ç¬¬ä¸€ç§å®ç°å¦‚ä¸‹</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> tb_name <span class="token comment">-- ä¸è¦è·Ÿå·²æœ‰æ–‡ä»¶å†²çª</span><span class="token keyword">ADD</span> DATAFILE <span class="token string">'D:/app/Administrator/oradata/user_data_1.dbf'</span><span class="token comment">-- åˆå§‹å¤§å°</span>size <span class="token number">50</span>m <span class="token comment">-- è‡ªåŠ¨æ‹“å±• å¼€</span>autoextend <span class="token keyword">on</span> <span class="token comment">-- æ¯æ¬¡è‡ªåŠ¨æ‹“å±•å¤§å° å¯ä»¥è®¾ç½®å¤§ä¸€äº›</span><span class="token keyword">next</span> <span class="token number">1024</span>m maxsize unlimited<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ”¶ç¼©"><a href="#æ”¶ç¼©" class="headerlink" title="æ”¶ç¼©"></a>æ”¶ç¼©</h2><p>åˆ é™¤è¡¨æˆ–è€…åˆ é™¤è¾ƒå¤šå†…å®¹åï¼Œ<strong>datafile</strong>æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨ç¼©å‡ï¼Œå¯ä»¥é€šè¿‡<code>resize</code>æ–¹å¼é‡ç½®è¡¨ç©ºé—´å¤§å°ã€‚ç”¨ä¸‹é¢ä»£ç å¯ä»¥ç”Ÿæˆä¸åŒ<strong>datafile</strong>çš„<code>resize</code>æ–¹æ¡ˆï¼Œå†åˆ†åˆ«æ‰§è¡Œã€‚</p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token comment">/*+ ordered use_hash(a,c) */</span>       <span class="token string">'alter database datafile '''</span>    <span class="token operator">||</span> a<span class="token punctuation">.</span>file_name    <span class="token operator">||</span> <span class="token string">''' resize '</span>    <span class="token operator">||</span> <span class="token function">round</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>filesize <span class="token operator">-</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>filesize <span class="token operator">-</span> c<span class="token punctuation">.</span>hwmsize <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span>    <span class="token operator">||</span> <span class="token string">'M;'</span><span class="token punctuation">,</span>    a<span class="token punctuation">.</span>filesize<span class="token punctuation">,</span>    c<span class="token punctuation">.</span>hwmsize<span class="token keyword">FROM</span>    <span class="token punctuation">(</span>        <span class="token keyword">SELECT</span>            file_id<span class="token punctuation">,</span>            file_name<span class="token punctuation">,</span>            <span class="token function">round</span><span class="token punctuation">(</span>bytes <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> filesize        <span class="token keyword">FROM</span>            dba_data_files    <span class="token punctuation">)</span>  a<span class="token punctuation">,</span>    <span class="token punctuation">(</span>        <span class="token keyword">SELECT</span>            file_id<span class="token punctuation">,</span>            <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span>block_id<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> hwmsize        <span class="token keyword">FROM</span>            dba_extents        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>            file_id    <span class="token punctuation">)</span>  c<span class="token keyword">WHERE</span>        a<span class="token punctuation">.</span>file_id <span class="token operator">=</span> c<span class="token punctuation">.</span>file_id    <span class="token operator">AND</span> a<span class="token punctuation">.</span>filesize <span class="token operator">-</span> c<span class="token punctuation">.</span>hwmsize <span class="token operator">></span> <span class="token number">100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¯¹äº<strong>TEMP</strong>è¡¨ç©ºé—´ï¼Œå¯ä»¥é‡‡ç”¨<code>shrink</code>æ–¹å¼<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="ALTER TABLE â€¦ SHRINK SPACE Command : Online Segment Shrink for Tables, LOBs and IOTs">[3]</span></a></sup>ï¼Œä¸ä¹‹ç›¸å…³è¿˜æœ‰<code>move</code>æ“ä½œï¼Œå¯é˜…è¯»ç›¸å…³æ–‡ç« <sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="Oracle moveå’Œshrinké‡Šæ”¾é«˜æ°´ä½ç©ºé—´">[4]</span></a></sup></p><div class="code-wrapper"><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- æŸ¥è¯¢tempè¡¨ç©ºé—´æƒ…å†µ</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_temp_free_space<span class="token punctuation">;</span><span class="token comment">-- æ”¶ç¼©</span>  <span class="token keyword">alter</span> <span class="token keyword">tablespace</span> <span class="token keyword">temp</span> shrink space<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14220/physical.htm">Tablespaces, Datafiles, and Control Files</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.modb.pro/db/7369">BigFileå’ŒSmallFileè¡¨ç©ºé—´æŠ€æœ¯</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://oracle-base.com/articles/misc/alter-table-shrink-space-online">ALTER TABLE â€¦ SHRINK SPACE Command : Online Segment Shrink for Tables, LOBs and IOTs</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.51cto.com/fengfeng688/1955137">Oracle moveå’Œshrinké‡Šæ”¾é«˜æ°´ä½ç©ºé—´</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è½¯ä»¶ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Oracle</tag>
      
      <tag>Tablespace</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS è¦ç´ æ˜ å°„å…³ç³»å»ºç«‹</title>
    <link href="/2016/03/03/ArcGIS-%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84/"/>
    <url>/2016/03/03/ArcGIS-%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<p>è¦ç´ æ˜ å°„å…³ç³»æ˜¯å·¥ä½œä¸­å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä¸€ä¸ªé¢è¦ç´ å›¾å±‚å’Œä¸€ä¸ªç‚¹è¦ç´ å›¾å±‚ï¼Œè¦æƒ³çŸ¥é“æ¯ä¸ªç‚¹æ˜¯è½åœ¨å“ªä¸ªé¢ä¹‹ä¸­ï¼Œå°±éœ€è¦å»ºç«‹ä¸€ä¸ªç‚¹å’Œé¢çš„æ˜ å°„å…³ç³»ã€‚</p><span id="more"></span><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>ç°æœ‰åŒ—äº¬<a href="https://mattzou.com/2016/02/28/ArcGIS-Fishnet/#">ç½‘æ ¼å›¾å±‚</a>ä»¥åŠåŒ—äº¬<strong>ç¯çº¿å›¾å±‚</strong>ï¼Œè¦ç¡®å®šç½‘æ ¼ä¸­æ¯ä¸ªæ ¼ç‚¹å¤„äºå‡ ç¯ã€‚</p><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>é€‰ç”¨<code> Join Data</code>å·¥å…·ï¼Œ** Join data from another layer on spatial location **æ–¹æ³•å°†ä¸¤ä¸ªå›¾å±‚çš„è¦ç´ è¿›è¡Œæ˜ å°„ã€‚ </p><h3 id="å·¥å…·ä½ç½®"><a href="#å·¥å…·ä½ç½®" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p>å³é”®å•å‡»å›¾å±‚ï¼Œé€‰æ‹©<code>Join and Relates</code>ï¼Œèœå•ä¸­é€‰<code>Join</code>ã€‚</p><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB.1.jpg/pic" alt="æ˜ å°„å…³ç³» 1"> </p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><blockquote><p>åœ¨ç›®æ ‡å›¾å±‚ä¹Ÿå°±æ˜¯<strong>ç½‘æ ¼å›¾å±‚</strong>ä¸Šå•å‡»å³é”®ï¼Œæ‰¾åˆ°<code> Join</code>å·¥å…·ï¼›</p></blockquote><ol><li>é€‰æ‹©** Join **ç±»å‹ï¼Œç¬¬ä¸€ç§æ˜¯åªè¿æ¥ä¸¤ä¸ªå›¾å±‚å±æ€§è¡¨ï¼Œç¬¬äºŒç§æ˜¯æ ¹æ®ç©ºé—´ä½ç½®å°†å›¾å±‚è¦ç´ è¿›è¡Œè¿æ¥ï¼ŒåŒæ—¶è¿æ¥å±æ€§è¡¨ï¼›</li><li>é€‰æ‹©è¿æ¥å¯¹è±¡ï¼Œè¿™é‡Œé€‰æ‹©ç¯çº¿å›¾å±‚ï¼›</li><li>é€‰æ‹©è¿æ¥<code> Options</code>ï¼Œç¬¬äºŒç§æ–¹å¼å¯ä»¥å®ç°æˆ‘ä»¬æ‰€éœ€è¦çš„æ˜ å°„å…³ç³»ï¼Œå³è½å…¥ç›¸åº”ç¯çº¿è¦ç´ çš„ç½‘æ ¼éƒ½å°†è¢«èµ‹äºˆ<strong>ç¯çº¿å›¾å±‚</strong>çš„å±æ€§ï¼Œå¦‚æœç»™<strong>ç¯çº¿å›¾å±‚</strong>çš„æ¯ä¸ªè¦ç´ éƒ½è¿›è¡Œæ ‡è®°ï¼Œæ¯”å¦‚ä¸€ç¯ä¸º<code> ID</code>å­—æ®µä¸º* 1 <em>ï¼Œé‚£ä¹ˆåœ¨è¿æ¥åï¼Œè½åœ¨ä¸€ç¯å†…çš„ç½‘æ ¼å°†ä¼šå¢åŠ ä¸€ä¸ªå­—æ®µ<code> ID</code> ï¼Œå€¼ä¸º</em> 1 *ï¼›</li><li>å¯¼å‡ºæ–‡ä»¶ã€‚</li></ol><blockquote><p>å‚æ•°é€‰æ‹©å¦‚ä¸‹ï¼š</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB.2.jpg/pic" alt="æ˜ å°„å…³ç³» 2"></p><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><blockquote><p>ç”Ÿæˆçš„æ–°å›¾å±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB.3.JPG/pic" alt="æ˜ å°„å…³ç³» 3"></p><p>æ‰“å¼€å›¾å±‚å±æ€§è¡¨ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„å­—æ®µï¼Œæ ‡è¯†ç½‘æ ¼æ‰€å¤„çš„ç¯çº¿ï¼Œé€šè¿‡<code>selec by attributes</code>é«˜äº®æ‰€æœ‰æœ‰æ˜ å°„å…³ç³»çš„ç½‘æ ¼ï¼Œå’Œç¯çº¿å›¾å±‚åŒ¹é…æ­£ç¡®ï¼Œç›®çš„è¾¾åˆ°ã€‚</p><hr>]]></content>
    
    
    <categories>
      
      <category>ArcGIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>æ˜ å°„å…³ç³»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS åˆ›å»ºç½‘æ ¼</title>
    <link href="/2016/02/28/ArcGIS-Fishnet/"/>
    <url>/2016/02/28/ArcGIS-Fishnet/</url>
    
    <content type="html"><![CDATA[<p>åœ¨æ’æ”¾å±•ç¤ºå’Œç»Ÿè®¡è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æŒ‰ç…§ç½‘æ ¼çš„æ–¹å¼è¿›è¡Œåˆ’åˆ†ï¼Œéœ€è¦å»ºç«‹ç½‘æ ¼ã€‚</p><span id="more"></span><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><ul><li> åˆ›å»ºç½‘æ ¼ï¼Œè¦†ç›–ç°æœ‰å›¾å±‚è¦ç´ </li><li> å¯è°ƒæ•´ç½‘æ ¼å¤§å°</li><li> è·å–ç½‘æ ¼ä¸­å¿ƒåæ ‡</li></ul><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>åœ¨ArcGISä¸­ï¼Œåº”ç”¨<strong>ç³»ç»Ÿå·¥å…·ç®±</strong>ä¸­çš„<code>Create Fishnet</code>å·¥å…·æ¥åˆ›å»ºç½‘æ ¼ã€‚</p><h3 id="å·¥å…·ä½ç½®"><a href="#å·¥å…·ä½ç½®" class="headerlink" title="å·¥å…·ä½ç½®"></a>å·¥å…·ä½ç½®</h3><p>åœ¨<strong>Catalog</strong>ä¸­é€‰æ‹©<code>Toolboxes</code>ï¼Œæ‰¾åˆ°<code>System Toolboxes</code>ï¼Œå…¶ä¸­<code>Data Management Tools</code>å·¥å…·ç®±ä¸­ç‚¹å¼€<code>Feature Class</code>ä¸€é¡¹å°±å¯ä»¥çœ‹è§<code>Create Fishnet</code>å·¥å…·ã€‚</p><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/create%20fishnet.1.jpg/pic" alt="create fishnet 1"></p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><ol><li>é€‰æ‹©å¯¼å‡ºæ–‡ä»¶ä½ç½®ï¼›</li><li><strong>å¯é€‰é¡¹</strong>é€‰æ‹©ç°æœ‰å›¾å±‚ä¸ºæ¨¡æ¿ï¼Œè‡ªåŠ¨ç”Ÿæˆç½‘æ ¼è¾¹ç•ŒèŒƒå›´</li><li>ä¿®æ”¹è‡ªåŠ¨ç”ŸæˆèŒƒå›´æ•°å€¼ï¼›</li><li>æ‰‹åŠ¨è¾“å…¥ç½‘æ ¼è¾¹ç•ŒèŒƒå›´ï¼Œå¦‚æœ<em>2</em>æ­¥éª¤é€‰æ‹©äº†æ¨¡æ¿å›¾å±‚ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¾¹ç•Œæ•°å€¼ï¼›</li><li>è®¾ç½®ç½‘æ ¼å®½åº¦åŠé«˜åº¦<strong>æ•°å€¼å•ä½ä¸å›¾å±‚åæ ‡ç³»ç»ŸåŒ¹é…</strong>ï¼›</li><li>è®¾ç½®ç½‘æ ¼è¡Œæ•°å’Œåˆ—æ•°<strong>å¦‚æœé€‰æ‹©äº†æ¨¡æ¿å›¾å±‚ï¼Œæœ€å¥½éƒ½è®¾ç½®ä¸º0ï¼Œä¼šè‡ªåŠ¨æ ¹æ®ä»¥ä¸Šè¾“å…¥çš„ç½‘æ ¼å°ºå¯¸åŠå›¾å±‚èŒƒå›´è®¡ç®—è¡Œåˆ—æ•°ï¼Œä¸ç”¨è‡ªå·±è®¡ç®—</strong>ï¼›</li><li><strong>å¯é€‰é¡¹</strong>ç”Ÿæˆæ¯ä¸ªç½‘æ ¼ä¸­å¿ƒç‚¹å›¾å±‚ï¼Œè¿™ä¸ªé€‰é¡¹åœ¨ä¹‹åå®šä½ç½‘æ ¼ä½ç½®æ—¶æœ‰ç”¨å¤„ï¼›</li><li>é€‰æ‹©ç½‘æ ¼ç±»å‹ï¼Œ<code>POLYLINE</code>åŠ<code>POLYGON</code>åˆ†åˆ«æ˜¯ç”Ÿæˆçº¿è¦ç´ ç½‘æ ¼æˆ–ç”Ÿæˆé¢è¦ç´ ç½‘æ ¼ï¼›</li></ol><blockquote><p>ä»¥å¤©æ´¥å¸‚ä¸ºæ¨¡æ¿å›¾å±‚ï¼Œç”Ÿæˆä¸€ä¸ªè¦†ç›–å¤©æ´¥å¸‚çš„1Km*1Kmçš„ç½‘æ ¼ï¼Œå‚æ•°é€‰æ‹©å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/create%20fishnet.2.jpg/pic" alt="create fishnet 2"></p><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><blockquote><p>è®¾ç½®å¥½å‚æ•°åç”Ÿæˆçš„ç½‘æ ¼å›¾å±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><p><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/ArcGIS/create%20fishnet.3.JPG/pic" alt="create fishnet 3"></p><p>ä»¥ä¸Šå°±å®Œæˆäº†ç½‘æ ¼å›¾å±‚çš„ç”Ÿæˆï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç”¨ç”Ÿæˆçš„ç½‘æ ¼å¯¹å…¶ä»–å›¾å±‚è¿›è¡Œåˆ‡åˆ†ç­‰æ“ä½œäº†ã€‚</p><hr>]]></content>
    
    
    <categories>
      
      <category>ArcGIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
      <tag>Fishnet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ArcGIS å¸¸ç”¨åŠŸèƒ½åº”ç”¨æ±‡æ€»</title>
    <link href="/2016/02/27/ArcGIS%E5%AF%BC%E8%88%AA/"/>
    <url>/2016/02/27/ArcGIS%E5%AF%BC%E8%88%AA/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡ç”¨ä»¥è®°å½•å¹³æ—¶ä½¿ç”¨ArcGISæ—¶æŒæ¡çš„æ–¹æ³•ï¼Œè¿™é‡Œæ±‡æ€»è®°å½•ã€‚</p><blockquote><p>å½“ä½ ç¬¬ä¸€æ¬¡èƒŒèµ·èƒŒåŒ…è¸ä¸Šè¿œæ–¹çš„è·¯,å°±æ°¸è¿œéƒ½ä¸ä¼šåœä¸‹æ¥!</p></blockquote><span id="more"></span><hr><h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><blockquote><ol><li> <a href="http://mattzou.com/2016/02/28/ArcGIS-Fishnet/#">åˆ›å»ºç½‘æ ¼</a> <strong>ArcGIS</strong> <code>Create Fishnet</code> åº”ç”¨</li><li> <a href="http://mattzou.com/2016/03/03/ArcGIS-%E8%A6%81%E7%B4%A0%E6%98%A0%E5%B0%84/#">è¦ç´ æ˜ å°„</a> <strong>ArcGIS</strong> <code>Join</code> åº”ç”¨</li><li> <a href="http://mattzou.com/2016/10/17/ArcGIS-%E8%B7%AF%E7%BD%91%E5%88%87%E5%88%86/#">è·¯ç½‘åˆ‡åˆ†</a> <strong>ArcGIS</strong> <code>Planarize Lines</code> åº”ç”¨</li><li> <a href="https://mattzou.com/2019/07/07/ArcGIS-%E4%B8%8A%E4%B8%8B%E8%A7%92%E6%A0%87/#">è§’æ ‡</a> <strong>ArcGIS</strong> ä¸“é¢˜å›¾<code>Legend</code>è®¾ç½®</li><li> <a href="https://mattzou.com/2018/07/09/ArcGIS-%E8%BD%BD%E5%85%A5%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/#">åœ¨çº¿åº•å›¾</a> <strong>ArcGIS</strong> æ·»åŠ åœ¨çº¿åº•å›¾</li></ol></blockquote>]]></content>
    
    
    <categories>
      
      <category>ç›®å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ArcGIS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cat</title>
    <link href="/1970/01/01/My-cat/"/>
    <url>/1970/01/01/My-cat/</url>
    
    <content type="html"><![CDATA[<p>äººç”Ÿä¸­çš„ä¸‰åªçŒ«ï¼ˆæˆªè‡³2021ï¼‰</p><h2 id="ç¬‘ç¬‘"><a href="#ç¬‘ç¬‘" class="headerlink" title="ç¬‘ç¬‘"></a>ç¬‘ç¬‘</h2><p>å–µæ˜ŸğŸŒ</p><p>å¸ˆå§åšå®éªŒæ—¶åœ¨éš§é“é‡Œå¸¦å›ï¼Œåˆšå›æ¥è¶…å°ä¸€åªï¼Œåœ¨å‡ ä¸ªæ²¡æœ‰ç»éªŒçš„é“²å±å®˜ä»¥åŠäº‘å…»é‡‘ä¸»çš„ç…§é¡¾ä¸‹ï¼Œé€æ¸é•¿æˆçªˆçª•æ·‘å¥³ã€‚æœ€å–œæ¬¢å‡ºæ²¡åœ¨åèƒŒä¸æ¤…å­çš„ç¼éš™é‡Œå……å½“æŠ¤è…°ã€‚</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xx1.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xx4.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xx2.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xx5.jpg"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xx3.jpg"></div></div></div><h2 id="å°é»‘"><a href="#å°é»‘" class="headerlink" title="å°é»‘"></a>å°é»‘</h2><p>é«˜å†·è‚¥å®…</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xh1.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xh4.jpg"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xh2.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/xh3.jpg"></div></div></div><h2 id="ç¦å®‰"><a href="#ç¦å®‰" class="headerlink" title="ç¦å®‰"></a>ç¦å®‰</h2><p>æ€ä¹ˆè¯´å‘¢ğŸ±â€ğŸ</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/fa4.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/fa2.jpg"></div><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/fa5.jpg"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://mattblog.oss-cn-beijing.aliyuncs.com/img/cat/fa3.jpg"></div></div></div>]]></content>
    
    
    
    <tags>
      
      <tag>çŒ«</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
